function touchHandler(l){var u=l.changedTouches,a=u[0],c="";switch(l.type){case "touchstart":c="mousedown";break;case "touchmove":c="mousemove";break;case "touchend":c="mouseup";break;default:return}var e=document.createEvent("MouseEvent");e.initMouseEvent(c,true,true,window,1,a.screenX,a.screenY,a.clientX,a.clientY,false,false,false,false,0,null);if(u.length<2){a.target.dispatchEvent(e);l.preventDefault()}};(function(l){function u(a){if(typeof a.data==="string"){var c=a.handler,e=a.data.toLowerCase().split(" ");a.handler=function(q){if(!(this!==q.target&&(/textarea|select/i.test(q.target.nodeName)||q.target.type==="text"))){var b=q.type!=="keypress"&&l.hotkeys.specialKeys[q.which],h=String.fromCharCode(q.which).toLowerCase(),f="",n={};if(q.altKey&&b!=="alt")f+="alt+";if(q.ctrlKey&&b!=="ctrl")f+="ctrl+";if(q.metaKey&&!q.ctrlKey&&b!=="meta")f+="meta+";if(q.shiftKey&&b!=="shift")f+="shift+";if(b)n[f+b]=
true;else{n[f+h]=true;n[f+l.hotkeys.shiftNums[h]]=true;if(f==="shift+")n[l.hotkeys.shiftNums[h]]=true}b=0;for(h=e.length;b<h;b++)if(n[e[b]])return c.apply(this,arguments)}}}}l.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};l.each(["keydown","keyup","keypress"],function(){l.event.special[this]={add:u}})})(jQuery);(function(l,u){function a(da){return typeof da==="string"}function c(da){var V=f.call(arguments,1);return function(){return da.apply(this,V.concat(f.call(arguments)))}}function e(da,V,X,na,qa){var la;if(na!==h){V=X.match(da?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);X=V[3]||"";if(qa===2&&a(na))na=na.replace(da?W:aa,"");else{la=p(V[2]);na=a(na)?p[da?ha:O](na):na;na=qa===2?na:qa===1?l.extend({},na,la):l.extend({},la,na);na=s(na);if(da)na=na.replace(ra,n)}da=V[1]+(da?"#":na||!V[1]?"?":"")+na+X}else da=
V(X!==h?X:u[pa][fa]);return da}function q(da,V,X){if(V===h||typeof V==="boolean"){X=V;V=s[da?ha:O]()}else V=a(V)?V.replace(da?W:aa,""):V;return p(V,X)}function b(da,V,X,na){if(!a(X)&&typeof X!=="object"){na=X;X=V;V=h}return this.each(function(){var qa=l(this),la=V||P()[(this.nodeName||"").toLowerCase()]||"",ma=la&&qa.attr(la)||"";qa.attr(la,s[da](ma,X,na))})}var h,f=Array.prototype.slice,n=decodeURIComponent,s=l.param,A,p,L,Q=l.bbq=l.bbq||{},N,J,P,U=l.event.special,O="querystring",ha="fragment",pa=
"location",fa="href",aa=/^.*\?|#.*$/g,W=/^.*\#/,ra,ja={};s[O]=c(e,0,function(da){return da.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")});s[ha]=A=c(e,1,function(da){return da.replace(/^[^#]*#?(.*)$/,"$1")});A.noEscape=function(da){da=da||"";da=l.map(da.split(""),encodeURIComponent);ra=RegExp(da.join("|"),"g")};A.noEscape(",/");l.deparam=p=function(da,V){var X={},na={"true":true,"false":false,"null":null};l.each(da.replace(/\+/g," ").split("&"),function(qa,la){var ma=la.split("="),Ca=n(ma[0]),Ga=X,Ia=
0,xa=Ca.split("]["),Ja=xa.length-1;if(/\[/.test(xa[0])&&/\]$/.test(xa[Ja])){xa[Ja]=xa[Ja].replace(/\]$/,"");xa=xa.shift().split("[").concat(xa);Ja=xa.length-1}else Ja=0;if(ma.length===2){ma=n(ma[1]);if(V)ma=ma&&!isNaN(ma)?+ma:ma==="undefined"?h:na[ma]!==h?na[ma]:ma;if(Ja)for(;Ia<=Ja;Ia++){Ca=xa[Ia]===""?Ga.length:xa[Ia];Ga=Ga[Ca]=Ia<Ja?Ga[Ca]||(xa[Ia+1]&&isNaN(xa[Ia+1])?{}:[]):ma}else if(l.isArray(X[Ca]))X[Ca].push(ma);else X[Ca]=X[Ca]!==h?[X[Ca],ma]:ma}else if(Ca)X[Ca]=V?h:""});return X};p[O]=c(q,
0);p[ha]=L=c(q,1);l.elemUrlAttr||(l.elemUrlAttr=function(da){return l.extend(ja,da)})({a:fa,base:fa,iframe:"src",img:"src",input:"src",form:"action",link:fa,script:"src"});P=l.elemUrlAttr;l.fn[O]=c(b,O);l.fn[ha]=c(b,ha);Q.pushState=N=function(da,V){if(a(da)&&/^#/.test(da)&&V===h)V=2;var X=da!==h;X=A(u[pa][fa],X?da:{},X?V:2);u[pa][fa]=X+(/#/.test(X)?"":"#")};Q.getState=J=function(da,V){return da===h||typeof da==="boolean"?L(da):L(V)[da]};Q.removeState=function(da){var V={};if(da!==h){V=J();l.each(l.isArray(da)?
da:arguments,function(X,na){delete V[na]})}N(V,2)};U.hashchange=l.extend(U.hashchange,{add:function(da){function V(na){var qa=na[ha]=A();na.getState=function(la,ma){return la===h||typeof la==="boolean"?p(qa,la):p(qa,ma)[la]};X.apply(this,arguments)}var X;if(l.isFunction(da)){X=da;return V}else{X=da.handler;da.handler=V}}})})(jQuery,this);
(function(l,u,a){function c(A){A=A||u[b][h];return A.replace(/^[^#]*#?(.*)$/,"$1")}var e,q=l.event.special,b="location",h="href",f=document.documentMode,n=l.browser.msie&&(f===a||f<8),s="onhashchange"in u&&!n;l.hashchangeDelay=100;q.hashchange=l.extend(q.hashchange,{setup:function(){if(s)return false;l(e.start)},teardown:function(){if(s)return false;l(e.stop)}});e=function(){function A(){N=J=function(P){return P};if(n){Q=l('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;
J=function(){return c(Q.document[b][h])};N=function(P,U){if(P!==U){var O=Q.document;O.open().close();O[b].hash="#"+P}};N(c())}}var p={},L,Q,N,J;p.start=function(){if(!L){var P=c();N||A();(function U(){var O=c(),ha=J(P);if(O!==P){N(P=O,ha);l(u).trigger("hashchange")}else if(ha!==P)u[b][h]=u[b][h].replace(/#.*/,"")+"#"+ha;L=setTimeout(U,l.hashchangeDelay)})()}};p.stop=function(){if(!Q){L&&clearTimeout(L);L=0}};return p}()})(jQuery,this);(function(l){var u={},a;l.svgIcons=function(c,e){function q(da,V){if(da!=="ajax"){if(P)return;var X=(Q=fa[0].contentDocument)&&Q.getElementById("svg_eof");if(!X&&!(V&&X)){U++;if(U<50)setTimeout(q,20);else{h();P=true}return}P=true}L=l(Q.firstChild).children();if(e.no_img)setTimeout(function(){J||b()},500);else{X=pa+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";N=l(new Image).attr({src:X,width:0,height:0}).appendTo("body").load(function(){b(true)}).error(function(){b()})}}
function b(da,V){if(!J){if(e.no_img)da=false;if(da){var X=l(document.createElement("div"));X.hide().appendTo("body")}if(V){var na=e.fallback_path?e.fallback_path:"";l.each(V,function(Ja,Na){l("#"+Ja);var ta=l(new Image).attr({"class":"svg_icon",src:na+Na,width:A,height:p,alt:"icon"});ja(ta,Ja)})}else for(var qa=L.length,la=0;la<qa;la++){var ma=L[la],Ca=ma.id;if(Ca==="svg_eof")break;l("#"+Ca);ma=ma.getElementsByTagNameNS(n,"svg")[0];var Ga=document.createElementNS(n,"svg");Ga.setAttributeNS(n,"viewBox",
[0,0,A,p].join(" "));var Ia=ma.getAttribute("width"),xa=ma.getAttribute("height");ma.removeAttribute("width");ma.removeAttribute("height");ma.getAttribute("viewBox")||ma.setAttribute("viewBox",[0,0,Ia,xa].join(" "));Ga.setAttribute("xmlns",n);Ga.setAttribute("width",A);Ga.setAttribute("height",p);Ga.setAttribute("xmlns:xlink",s);Ga.setAttribute("class","svg_icon");ha||(ma=ma.cloneNode(true));Ga.appendChild(ma);if(da){ha||Ga.cloneNode(true);X.empty().append(Ga);ma=pa+f(X.html());ma=l(new Image).attr({"class":"svg_icon",
src:ma})}else ma=a(l(Ga),la);ja(ma,Ca)}e.placement&&l.each(e.placement,function(Ja,Na){u[Na]&&l(Ja).each(function(ta){var wa=u[Na].clone();if(ta>0&&!da)wa=a(wa,ta,true);ra(l(this),wa,Na)})});if(!V){da&&X.remove();fa&&fa.remove();N&&N.remove()}e.resize&&l.resizeSvgIcons(e.resize);J=true;e.callback&&e.callback(u)}}function h(){if(c.indexOf(".svgz")!=-1){var da=c.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");l.svgIcons(da,e)}else e.fallback&&b(false,e.fallback)}
function f(da){if(window.btoa)return window.btoa(da);var V=Array(Math.floor((da.length+2)/3)*4),X,na,qa,la,ma,Ca,Ga=0,Ia=0;do{X=da.charCodeAt(Ga++);na=da.charCodeAt(Ga++);qa=da.charCodeAt(Ga++);la=X>>2;X=(X&3)<<4|na>>4;ma=(na&15)<<2|qa>>6;Ca=qa&63;if(isNaN(na))ma=Ca=64;else if(isNaN(qa))Ca=64;V[Ia++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(la);V[Ia++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(X);V[Ia++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ma);
V[Ia++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(Ca)}while(Ga<da.length);return V.join("")}var n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink",A=e.w?e.w:24,p=e.h?e.h:24,L,Q,N,J=false,P=false,U=0,O=navigator.userAgent,ha=!!window.opera;O.indexOf("Safari/")>-1&&O.indexOf("Chrome/");var pa="data:image/svg+xml;charset=utf-8;base64,";if(e.svgz){var fa=l('<object data="'+c+'" type=image/svg+xml>').appendTo("body").hide();try{Q=fa[0].contentDocument;fa.load(q);
q(0,true)}catch(aa){h()}}else{var W=new DOMParser;l.ajax({url:c,dataType:"string",success:function(da){if(da){Q=W.parseFromString(da,"text/xml");l(function(){q("ajax")})}else l(h)},error:function(da){if(window.opera)l(function(){h()});else if(da.responseText){Q=W.parseFromString(da.responseText,"text/xml");Q.childNodes.length||l(h);l(function(){q("ajax")})}else l(h)}})}var ra=function(da,V,X,na){ha&&V.css("visibility","hidden");if(e.replace){na&&V.attr("id",X);(X=da.attr("class"))&&V.attr("class",
"svg_icon "+X);da.replaceWith(V)}else da.append(V);ha&&setTimeout(function(){V.removeAttr("style")},1)},ja=function(da,V){if(e.id_match===undefined||e.id_match!==false)ra(holder,da,V,true);u[V]=da};a=function(da,V){var X=da.find("defs");if(!X.length)return da;X=ha?X.find("*").filter(function(){return!!this.id}):X.find("[id]");var na=da[0].getElementsByTagName("*"),qa=na.length;X.each(function(la){var ma=this.id;l(Q).find("#"+ma);this.id=la="x"+ma+V+la;ma="url(#"+ma+")";var Ca="url(#"+la+")";for(la=
0;la<qa;la++){var Ga=na[la];Ga.getAttribute("fill")===ma&&Ga.setAttribute("fill",Ca);Ga.getAttribute("stroke")===ma&&Ga.setAttribute("stroke",Ca);Ga.getAttribute("filter")===ma&&Ga.setAttribute("filter",Ca)}});return da}};l.getSvgIcon=function(c,e){var q=u[c];if(e&&q)q=a(q,0,true).clone(true);return q};l.resizeSvgIcons=function(c){var e=!l(".svg_icon:first").length;l.each(c,function(q,b){var h=l.isArray(b),f=h?b[0]:b,n=h?b[1]:b;if(e)q=q.replace(/\.svg_icon/g,"svg");l(q).each(function(){this.setAttribute("width",
f);this.setAttribute("height",n);if(window.opera&&window.widget){this.parentNode.style.width=f+"px";this.parentNode.style.height=n+"px"}})})}})(jQuery);(function(){function l(c,e,q){c=document.createElementNS(u.svg,c);if(a)for(var b in e)c.setAttribute(b,e[b]);else for(b in e){var h=e[b],f=c[b];if(f&&f.constructor==="SVGLength")f.baseVal.value=h;else c.setAttribute(b,h)}q&&q.appendChild(c);return c}var u={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(c){c=c||{};this.alpha=isNaN(c.alpha)?100:c.alpha;if(c.copy){this.type=
c.copy.type;this.alpha=c.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=c.copy.solidColor;break;case "linearGradient":this.linearGradient=c.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=c.copy.radialGradient.cloneNode(true)}}else if(c.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=c.linearGradient.cloneNode(true)}else if(c.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=c.radialGradient.cloneNode(true)}else if(c.solidColor){this.type="solidColor";this.solidColor=c.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var a=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(c){var e=
arguments;return this.each(function(){function q(ia,ca,ka,M,R){var ea=R||l("stop",{"stop-color":ca,"stop-opacity":ka,offset:ia},W);if(R){ca=R.getAttribute("stop-color");ka=R.getAttribute("stop-opacity");ia=R.getAttribute("offset")}else W.appendChild(ea);if(ka===null)ka=1;R=l("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+ia*ha)+", 26)"},Va);var Fa=
l("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:ca,"fill-opacity":ka,transform:"translate("+(10+ia*ha)+", 26)",stroke:"#000","stroke-width":1.5},Va);$(Fa).mousedown(function(Oa){b(this);Ya=fb;P.mousemove(n).mouseup(h);ua=ub.offset();Oa.preventDefault();return false}).data("stop",ea).data("bg",R).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Oa=this,Sa=+ea.getAttribute("stop-opacity")||
1,cb=ea.getAttribute("stop-color")||1,pb=(parseFloat(Sa)*255).toString(16);pb.length<2;)pb="0"+pb;ca=cb.substr(1)+pb;$("#"+p+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:A.images.clientPath},color:{active:ca,alphaSupport:true}},function(Ta){cb=Ta.val("hex")?"#"+Ta.val("hex"):"none";Sa=Ta.val("a")!==null?Ta.val("a")/256:1;Oa.setAttribute("fill",cb);Oa.setAttribute("fill-opacity",Sa);ea.setAttribute("stop-color",
cb);ea.setAttribute("stop-opacity",Sa);$("div.jGraduate_LightBox").hide();$("#"+p+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+p+"_jGraduate_stopPicker").hide()})});$(W).find("stop").each(function(){var Oa=$(this);if(+this.getAttribute("offset")>ia){if(!ca){var Sa=this.getAttribute("stop-color"),cb=this.getAttribute("stop-opacity");ea.setAttribute("stop-color",Sa);Fa.setAttribute("fill",Sa);ea.setAttribute("stop-opacity",cb===null?1:cb);Fa.setAttribute("fill-opacity",
cb===null?1:cb)}Oa.before(ea);return false}});M&&b(Fa);return ea}function b(ia){fb&&fb.setAttribute("stroke","#000");ia.setAttribute("stroke","blue");fb=ia;fb.parentNode.appendChild(fb)}function h(){P.unbind("mousemove",n);if(Da.getAttribute("display")!=="none"){Da.setAttribute("display","none");var ia=$(fb),ca=ia.data("stop");ia=ia.data("bg");$([fb,ca,ia]).remove()}Ya=null}function f(){var ia=Ua?"rotate("+Ua+","+Ea+","+hb+") ":"";db===1&&Ka===1?W.removeAttribute("gradientTransform"):W.setAttribute("gradientTransform",
ia+"translate("+-Ea*(db-1)+","+-hb*(Ka-1)+") scale("+db+","+Ka+")")}function n(ia){var ca=ia.pageX-ua.left;ia=ia.pageY-ua.top;ca=ca<10?10:ca>ha+10?ha+10:ca;var ka="translate("+ca+", 26)";if(ia<-60||ia>130){Da.setAttribute("display","block");Da.setAttribute("transform",ka)}else Da.setAttribute("display","none");Ya.setAttribute("transform",ka);$.data(Ya,"bg").setAttribute("transform",ka);$.data(Ya,"stop").setAttribute("offset",(ca-10)/ha);var M=0;$(W).find("stop").each(function(){var R=this.getAttribute("offset"),
ea=$(this);if(R<M){ea.prev().before(ea);va=$(W).find("stop")}M=R})}var s=$(this),A=$.extend(true,{},jQuery.fn.jGraduateDefaults,c),p=s.attr("id"),L="#"+s.attr("id")+" ";if(L){var Q=function(){switch(s.paint.type){case "radialGradient":s.paint.linearGradient=null;break;case "linearGradient":s.paint.radialGradient=null;break;case "solidColor":s.paint.radialGradient=s.paint.linearGradient=null}$.isFunction(s.okCallback)&&s.okCallback(s.paint);s.hide()},N=function(){$.isFunction(s.cancelCallback)&&s.cancelCallback();
s.hide()};$.extend(true,s,{paint:new $.jGraduate.Paint({copy:A.paint}),okCallback:$.isFunction(e[1])&&e[1]||null,cancelCallback:$.isFunction(e[2])&&e[2]||null});s.position();var J=null,P=$(window);if(s.paint.type=="none")s.paint=$.jGraduate.Paint({solidColor:"ffffff"});s.addClass("jGraduate_Picker");s.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
p+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var U=$(L+"> .jGraduate_colPick"),O=$(L+"> .jGraduate_gradPick");O.html('<div id="'+p+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+A.window.pickerTitle+'</h2><div id="'+p+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+p+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
p+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+p+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+p+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
p+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+p+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+p+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
p+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+p+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+p+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
p+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+p+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+p+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+p+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
p+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+p+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+p+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+p+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+A.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+p+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+p+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+p+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+A.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+p+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
p+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+p+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var ha=256,pa=ha-0,fa=ha-0,aa,W,ra,ja={};$(".jGraduate_SliderBar").width(145);var da=$("#"+p+"_jGraduate_GradContainer")[0],V=l("svg",{id:p+"_jgraduate_svg",width:ha,height:ha,xmlns:u.svg},da);aa=aa||s.paint.type;var X=W=s.paint[aa],na=s.paint.alpha,qa=aa==="solidColor";switch(aa){case "solidColor":case "linearGradient":if(!qa){W.id=p+"_lg_jgraduate_grad";
X=W=V.appendChild(W)}l("radialGradient",{id:p+"_rg_jgraduate_grad"},V);if(aa==="linearGradient")break;case "radialGradient":if(!qa){W.id=p+"_rg_jgraduate_grad";X=W=V.appendChild(W)}l("linearGradient",{id:p+"_lg_jgraduate_grad"},V)}if(qa){X=W=$("#"+p+"_lg_jgraduate_grad")[0];J=s.paint[aa];q(0,"#"+J,1);var la=typeof A.newstop;if(la==="string")switch(A.newstop){case "same":q(1,"#"+J,1);break;case "inverse":la="";for(var ma=0;ma<6;ma+=2){J.substr(ma,2);var Ca=(255-parseInt(J.substr(ma,2),16)).toString(16);
if(Ca.length<2)Ca=0+Ca;la+=Ca}q(1,"#"+la,1);break;case "white":q(1,"#ffffff",1);break;case "black":q(1,"#000000",1)}else if(la==="object")q(1,A.newstop.color||"#"+J,"opac"in A.newstop?A.newstop.opac:1)}J=parseFloat(X.getAttribute("x1")||0);la=parseFloat(X.getAttribute("y1")||0);ma=parseFloat(X.getAttribute("x2")||1);Ca=parseFloat(X.getAttribute("y2")||0);var Ga=parseFloat(X.getAttribute("cx")||0.5),Ia=parseFloat(X.getAttribute("cy")||0.5),xa=parseFloat(X.getAttribute("fx")||Ga),Ja=parseFloat(X.getAttribute("fy")||
Ia);ra=l("rect",{id:p+"_jgraduate_rect",x:0,y:0,width:pa,height:fa,fill:"url(#"+p+"_jgraduate_grad)","fill-opacity":na/100},V);var Na=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:la*ha,left:J*ha}).data("coord","start").appendTo(da),ta=Na.clone().text(2).css({top:Ca*ha,left:ma*ha}).attr("title","End stop").data("coord","end").appendTo(da),wa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:Ia*ha,left:Ga*
ha}).data("coord","center").appendTo(da),Ha=wa.clone().text("F").css({top:Ja*ha,left:xa*ha,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(da);Ha[0].id=p+"_jGraduate_focusCoord";$(L+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(ia,ca){var ka=W.getAttribute(ca),M=isNaN(ca[1]);ka||(ka=M?"0.5":ca==="x2"?"1.0":"0.0");ja[ca]=$("#"+p+"_jGraduate_"+ca).val(ka).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>
1)this.value=1;if(!(ca[0]==="f"&&!gb))if(M&&aa==="radialGradient"||!M&&aa==="linearGradient")W.setAttribute(ca,this.value);var R=M?ca[0]==="c"?wa:Ha:ca[1]==="1"?Na:ta,ea=ca.indexOf("x")>=0?"left":"top";R.css(ea,this.value*ha)}).change()});var va,Va,ub=$("#"+p+"_jGraduate_StopSlider"),fb,Wa,Ya,Da=l("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},Wa),ua,db=1,Ka=1,Ua=0,Ea=Ga,hb=Ia;Wa=l("svg",{width:"100%",height:45},ub[0]);da=l("pattern",{width:16,
height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Wa);l("image",{width:16,height:16},da).setAttributeNS(u.xlink,"xlink:href",A.images.clientPath+"map-opacity.png");$(Wa).on("click touchstart",function(ia){ua=ub.offset();if(ia.target.tagName!=="path"){var ca=ia.pageX-ua.left-8;ca=ca<10?10:ca>ha+10?ha+10:ca;q(ca/ha,0,0,true);ia.stopPropagation()}});$(Wa).mouseover(function(){Wa.appendChild(Da)});Va=l("g",{},Wa);l("line",{x1:10,y1:15,x2:ha+10,y2:15,"stroke-width":2,stroke:"#000"},Wa);var qb=
O.find(".jGraduate_spreadMethod").change(function(){W.setAttribute("spreadMethod",$(this).val())}),Za=null,$a=function(ia){var ca=ia.pageX-kb.left,ka=ia.pageY-kb.top;ca=ca<0?0:ca>ha?ha:ca;ka=ka<0?0:ka>ha?ha:ka;Za.css("left",ca).css("top",ka);ca=ca/pa;ka=ka/fa;var M=Za.data("coord"),R=W;switch(M){case "start":ja.x1.val(ca);ja.y1.val(ka);R.setAttribute("x1",ca);R.setAttribute("y1",ka);break;case "end":ja.x2.val(ca);ja.y2.val(ka);R.setAttribute("x2",ca);R.setAttribute("y2",ka);break;case "center":ja.cx.val(ca);
ja.cy.val(ka);R.setAttribute("cx",ca);R.setAttribute("cy",ka);Ea=ca;hb=ka;f();break;case "focus":ja.fx.val(ca);ja.fy.val(ka);R.setAttribute("fx",ca);R.setAttribute("fy",ka);f()}ia.preventDefault()},vb=function(){Za=null;P.unbind("mousemove",$a).unbind("mouseup",vb)};va=W.getElementsByTagNameNS(u.svg,"stop");if(sa<2){for(;sa<2;){W.appendChild(document.createElementNS(u.svg,"stop"));++sa}va=W.getElementsByTagNameNS(u.svg,"stop")}var sa=va.length;for(ma=0;ma<sa;ma++)q(0,0,0,0,va[ma]);qb.val(W.getAttribute("spreadMethod")||
"pad");var kb,gb=false;ra.setAttribute("fill-opacity",na/100);$("#"+p+" div.grad_coord").mousedown(function(ia){ia.preventDefault();Za=$(this);Za.offset();kb=Za.parent().offset();P.mousemove($a).mouseup(vb)});$("#"+p+"_jGraduate_Ok").bind("click touchstart",function(){s.paint.type=aa;s.paint[aa]=W.cloneNode(true);s.paint.solidColor=null;Q()});$("#"+p+"_jGraduate_Cancel").bind("click touchstart",function(){N()});if(aa==="radialGradient")if(gb)Ha.show();else{Ha.hide();ja.fx.val("");ja.fy.val("")}$("#"+
p+"_jGraduate_match_ctr")[0].checked=!gb;var tb,lb;$("#"+p+"_jGraduate_match_ctr").change(function(){gb=!this.checked;Ha.toggle(gb);ja.fx.val("");ja.fy.val("");var ia=W;if(gb){var ca=tb||0.5,ka=lb||0.5;ia.setAttribute("fx",ca);ia.setAttribute("fy",ka);ja.fx.val(ca);ja.fy.val(ka)}else{tb=ia.getAttribute("fx");lb=ia.getAttribute("fy");ia.removeAttribute("fx");ia.removeAttribute("fy")}});va=W.getElementsByTagNameNS(u.svg,"stop");sa=va.length;if(sa<2){for(;sa<2;){W.appendChild(document.createElementNS(u.svg,
"stop"));++sa}va=W.getElementsByTagNameNS(u.svg,"stop")}var eb;na=O=0;if(aa==="radialGradient"){V=W.gradientTransform.baseVal;if(V.numberOfItems===2){sa=V.getItem(0);V=V.getItem(1);if(sa.type===2&&V.type===3){sa=V.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}else if(V.numberOfItems===3){da=V.getItem(0);sa=V.getItem(1);V=V.getItem(2);if(da.type===4&&sa.type===2&&V.type===3){na=Math.round(da.angle);sa=V.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==
1)O=Math.round((1-sa.d)*100)}}}O={radius:{handle:"#"+p+"_jGraduate_RadiusArrows",input:"#"+p+"_jGraduate_RadiusInput",val:(W.getAttribute("r")||0.5)*100},opacity:{handle:"#"+p+"_jGraduate_OpacArrows",input:"#"+p+"_jGraduate_OpacInput",val:s.paint.alpha||100},ellip:{handle:"#"+p+"_jGraduate_EllipArrows",input:"#"+p+"_jGraduate_EllipInput",val:O},angle:{handle:"#"+p+"_jGraduate_AngleArrows",input:"#"+p+"_jGraduate_AngleInput",val:na}};$.each(O,function(ia,ca){var ka=$(ca.handle);ka.mousedown(function(M){var R=
ka.parent();eb={type:ia,elem:ka,input:$(ca.input),parent:R,offset:R.offset()};P.mousemove(nb).mouseup(rb);M.preventDefault()});$(ca.input).val(ca.val).change(function(){var M=+this.value,R=0,ea=aa==="radialGradient";switch(ia){case "radius":ea&&W.setAttribute("r",M/100);R=Math.pow(M/100,0.4)/2*145;break;case "opacity":s.paint.alpha=M;ra.setAttribute("fill-opacity",M/100);R=M*1.45;break;case "ellip":db=Ka=1;if(M===0){R=72.5;break}if(M>99.5)M=99.5;if(M>0)Ka=1-M/100;else db=-(M/100)-1;R=145*((M+100)/
2)/100;ea&&f();break;case "angle":Ua=M;R=Ua/180;R+=0.5;R*=145;ea&&f()}if(R>145)R=145;else if(R<0)R=0;ka.css({"margin-left":R-5})}).change()});var nb=function(ia){var ca=ia.pageX-eb.offset.left-parseInt(eb.parent.css("border-left-width"));if(ca>145)ca=145;if(ca<=0)ca=0;var ka=ca-5;ca/=145;switch(eb.type){case "radius":ca=Math.pow(ca*2,2.5);if(ca>0.98&&ca<1.02)ca=1;if(ca<=0.01)ca=0.01;W.setAttribute("r",ca);break;case "opacity":s.paint.alpha=parseInt(ca*100);ra.setAttribute("fill-opacity",ca);break;
case "ellip":Ka=db=1;if(ca<0.5){ca/=0.5;db=ca<=0?0.01:ca}else if(ca>0.5){ca/=0.5;ca=2-ca;Ka=ca<=0?0.01:ca}f();ca-=1;if(Ka===ca+1)ca=Math.abs(ca);break;case "angle":ca-=0.5;Ua=ca*=180;f();ca/=100}eb.elem.css({"margin-left":ka});ca=Math.round(ca*100);eb.input.val(ca);ia.preventDefault()},rb=function(){P.unbind("mousemove",nb).unbind("mouseup",rb);eb=null};for(O=(s.paint.alpha*255/100).toString(16);O.length<2;)O="0"+O;O=O.split(".")[0];J=s.paint.solidColor=="none"?"":s.paint.solidColor+O;qa||(J=va[0].getAttribute("stop-color"));
$.extend($.fn.jPicker.defaults.window,{alphaSupport:true,effects:{type:"show",speed:0}});U.jPicker({window:{title:A.window.pickerTitle},images:{clientPath:A.images.clientPath},color:{active:J,alphaSupport:true}},function(ia){s.paint.type="solidColor";s.paint.alpha=ia.val("ahex")?Math.round(ia.val("a")/255*100):100;s.paint.solidColor=ia.val("hex")?ia.val("hex"):"none";s.paint.radialGradient=null;Q()},null,function(){N()});var wb=$(L+" .jGraduate_tabs li");wb.on("click touchstart",function(){wb.removeClass("jGraduate_tab_current");
$(this).addClass("jGraduate_tab_current");$(L+" > div").hide();var ia=$(this).attr("data-type");$(L+" .jGraduate_gradPick").show();if(ia==="rg"||ia==="lg"){$(".jGraduate_"+ia+"_field").show();$(".jGraduate_"+(ia==="lg"?"rg":"lg")+"_field").hide();$("#"+p+"_jgraduate_rect")[0].setAttribute("fill","url(#"+p+"_"+ia+"_jgraduate_grad)");aa=ia==="lg"?"linearGradient":"radialGradient";$("#"+p+"_jGraduate_OpacInput").val(s.paint.alpha).change();var ca=$("#"+p+"_"+ia+"_jgraduate_grad")[0];if(W!==ca){var ka=
$(W).find("stop");$(ca).empty().append(ka);W=ca;ca=qb.val();W.setAttribute("spreadMethod",ca)}gb=ia==="rg"&&W.getAttribute("fx")!=null&&!(Ga==xa&&Ia==Ja);$("#"+p+"_jGraduate_focusCoord").toggle(gb);if(gb)$("#"+p+"_jGraduate_match_ctr")[0].checked=false}else{$(L+" .jGraduate_gradPick").hide();$(L+" .jGraduate_colPick").show()}});$(L+" > div").hide();wb.removeClass("jGraduate_tab_current");var xb;switch(s.paint.type){case "linearGradient":xb=$(L+" .jGraduate_tab_lingrad");break;case "radialGradient":xb=
$(L+" .jGraduate_tab_radgrad");break;default:xb=$(L+" .jGraduate_tab_color")}s.show();setTimeout(function(){xb.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var l=$(window),u=$(document);$.extend($.fn,{contextMenu:function(a,c){if(a.menu==undefined)return false;if(a.inSpeed==undefined)a.inSpeed=150;if(a.outSpeed==undefined)a.outSpeed=75;if(a.inSpeed==0)a.inSpeed=-1;if(a.outSpeed==0)a.outSpeed=-1;$(this).each(function(){var e=$(this),q=$(e).offset(),b=$("#"+a.menu);b.addClass("contextMenu");$(this).bind("mousedown",function(f){$(this).on("mouseup",function(n){var s=$(this);s.unbind("mouseup");$(".contextMenu").hide();if(f.button===2||
a.allowLeft||f.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||h(n,f,s)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(f){var n=$(this);n.unbind("mouseup");h(f,f,n)});var h=function(f,n,s){if(typeof n=="undefined")n=f;f.stopPropagation();if(e.hasClass("disabled")||n.altKey)return false;var A=f.pageX,p=f.pageY;if(svgedit.browser.isTouch()){A=f.originalEvent.touches[0].pageX;p=f.originalEvent.touches[0].pageY}f=l.width()-b.width();n=l.height()-b.height();if(A>f-15)A=f-15;
if(p>n-30)p=n-30;if(svgedit.browser.isTouch())p-=b.height()/2;u.unbind("click");b.css({top:p,left:A}).fadeIn(a.inSpeed);b.find("A").mouseover(function(){b.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){b.find("LI.hover").removeClass("hover")});u.keypress(function(L){switch(L.keyCode){case 38:if(b.find("LI.hover").length){b.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");b.find("LI.hover").length||b.find("LI:last").addClass("hover")}else b.find("LI:last").addClass("hover");
break;case 40:if(b.find("LI.hover").length==0)b.find("LI:first").addClass("hover");else{b.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");b.find("LI.hover").length||b.find("LI:first").addClass("hover")}break;case 13:b.find("LI.hover A").trigger("click");break;case 27:u.trigger("click")}});b.find("A").unbind("mouseup");b.find("LI:not(.disabled) A").mouseup(function(){u.unbind("click").unbind("keypress");$(".contextMenu").hide();c&&c($(this).attr("href").substr(1),
$(s),{x:A-q.left,y:p-q.top,docX:A,docY:p});return false});setTimeout(function(){u.click(function(){u.unbind("click").unbind("keypress");b.fadeOut(a.outSpeed);return false})},0)};if($.browser.mozilla)$("#"+a.menu).each(function(){$(this).css({MozUserSelect:"none"})});else $.browser.msie?$("#"+a.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})}):$("#"+a.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})});$(e).add($("UL.contextMenu")).bind("contextmenu",
function(){return false})});return $(this)},disableContextMenuItems:function(a){if(a==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(a!=undefined)for(var c=a.split(","),e=0;e<c.length;e++)$(this).find('A[href="'+c[e]+'"]').parent().addClass("disabled")});return $(this)},enableContextMenuItems:function(a){if(a==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(a!=undefined)for(var c=a.split(","),e=
0;e<c.length;e++)$(this).find('A[href="'+c[e]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var l=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return l};if(svgedit.browser.supportsSvg()){var u=navigator.userAgent,a=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=!!window.opera,e=u.indexOf("AppleWebKit")>=0,q=u.indexOf("Gecko/")>=0,b=u.indexOf("MSIE")>=0,h=u.indexOf("Chrome/")>=0,f=u.indexOf("Windows")>=0,n=u.indexOf("Macintosh")>=
0,s="ontouchstart"in window,A=!!a.querySelector,p=!!document.evaluate,L=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","path");pa.setAttribute("d","M0,0 10,10");var fa=pa.pathSegList;pa=pa.createSVGPathSegLinetoAbs(5,5);try{fa.replaceItem(pa,0);return true}catch(aa){}return false}(),Q=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","path");pa.setAttribute("d","M0,0 10,10");var fa=pa.pathSegList;pa=pa.createSVGPathSegLinetoAbs(5,5);try{fa.insertItemBefore(pa,
0);return true}catch(aa){}return false}(),N=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","svg"),fa=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(pa);fa.setAttribute("x",5);pa.appendChild(fa);var aa=document.createElementNS("http://www.w3.org/2000/svg","text");aa.textContent="a";fa.appendChild(aa);fa=aa.getStartPositionOfChar(0);fa=fa.x;document.documentElement.removeChild(pa);return fa===0}(),J=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg",
"svg");document.documentElement.appendChild(pa);var fa=document.createElementNS("http://www.w3.org/2000/svg","path");fa.setAttribute("d","M0,0 C0,0 10,10 10,0");pa.appendChild(fa);fa=fa.getBBox();document.documentElement.removeChild(pa);return fa.height>4&&fa.height<5}(),P=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(pa);var fa=document.createElementNS("http://www.w3.org/2000/svg","path");fa.setAttribute("d","M0,0 10,0");var aa=
document.createElementNS("http://www.w3.org/2000/svg","path");aa.setAttribute("d","M5,0 15,0");var W=document.createElementNS("http://www.w3.org/2000/svg","g");W.appendChild(fa);W.appendChild(aa);pa.appendChild(W);fa=W.getBBox();document.documentElement.removeChild(pa);return fa.width==15}(),U=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect");pa.setAttribute("x",0.1);(pa=pa.cloneNode(false).getAttribute("x").indexOf(",")==-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n\t\tPlease upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");
return pa}(),O=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect");pa.setAttribute("style","vector-effect:non-scaling-stroke");return pa.style.vectorEffect==="non-scaling-stroke"}(),ha=function(){var pa=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,fa=a.createSVGTransform();pa.appendItem(fa);return pa.getItem(0)==fa}();svgedit.browser.isOpera=function(){return c};svgedit.browser.isWebkit=function(){return e};svgedit.browser.isGecko=function(){return q};
svgedit.browser.isIE=function(){return b};svgedit.browser.isChrome=function(){return h};svgedit.browser.isWindows=function(){return f};svgedit.browser.isMac=function(){return n};svgedit.browser.isTouch=function(){return s};svgedit.browser.supportsSelectors=function(){return A};svgedit.browser.supportsXpath=function(){return p};svgedit.browser.supportsPathReplaceItem=function(){return L};svgedit.browser.supportsPathInsertItemBefore=function(){return Q};svgedit.browser.supportsPathBBox=function(){return J};
svgedit.browser.supportsHVLineContainerBBox=function(){return P};svgedit.browser.supportsGoodTextCharPos=function(){return N};svgedit.browser.supportsEditableText=function(){return c};svgedit.browser.supportsGoodDecimals=function(){return U};svgedit.browser.supportsNonScalingStroke=function(){return O};svgedit.browser.supportsNativeTransformLists=function(){return ha}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var l=document.createElementNS("http://www.w3.org/2000/svg","svg"),u={};svgedit.transformlist.SVGTransformList=function(a){this._elem=a||null;this._xforms=[];this._update=function(){var c="";l.createSVGMatrix();for(var e=0;e<this.numberOfItems;++e){var q=this._list.getItem(e);c=c;q=q;var b=q.matrix,h="";switch(q.type){case 1:h="matrix("+[b.a,b.b,b.c,b.d,b.e,b.f].join(",")+")";break;case 2:h="translate("+b.e+","+b.f+")";break;case 3:h=
b.a==b.d?"scale("+b.a+")":"scale("+b.a+","+b.d+")";break;case 4:var f=0;h=0;if(q.angle!=0){f=1-b.a;h=(f*b.f+b.b*b.e)/(f*f+b.b*b.b);f=(b.e-b.b*h)/f}h="rotate("+q.angle+" "+f+","+h+")"}c=c+(h+" ")}this._elem.setAttribute("transform",c)};this._list=this;this._init=function(){var c=this._elem.getAttribute("transform");if(c)for(var e=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,q=true;q;){q=c.match(e);c=c.replace(e,"");if(q&&q[1]){var b=q[1].split(/\s*\(/),h=b[0];b=b[1].match(/\s*(.*?)\s*\)/);
b[1]=b[1].replace(/(\d)-/g,"$1 -");var f=b[1].split(/[, ]+/),n="abcdef".split(""),s=l.createSVGMatrix();$.each(f,function(L,Q){f[L]=parseFloat(Q);if(h=="matrix")s[n[L]]=f[L]});b=l.createSVGTransform();var A="set"+h.charAt(0).toUpperCase()+h.slice(1),p=h=="matrix"?[s]:f;if(h=="scale"&&p.length==1)p.push(p[0]);else if(h=="translate"&&p.length==1)p.push(0);else if(h=="rotate"&&p.length==1){p.push(0);p.push(0)}b[A].apply(b,p);this._list.appendItem(b)}}};this._removeFromOtherLists=function(c){if(c){var e=
false,q;for(q in u){for(var b=u[q],h=0,f=b._xforms.length;h<f;++h)if(b._xforms[h]==c){e=true;b.removeItem(h);break}if(e)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(c){this.numberOfItems=1;this._removeFromOtherLists(c);this._xforms=[c]};this.getItem=function(c){if(c<this.numberOfItems&&c>=0)return this._xforms[c];throw{code:1};};this.insertItemBefore=function(c,e){var q=null;if(e>=0)if(e<this.numberOfItems){this._removeFromOtherLists(c);
q=Array(this.numberOfItems+1);for(var b=0;b<e;++b)q[b]=this._xforms[b];q[b]=c;for(var h=b+1;b<this.numberOfItems;++h,++b)q[h]=this._xforms[b];this.numberOfItems++;this._xforms=q;q=c;this._list._update()}else q=this._list.appendItem(c);return q};this.replaceItem=function(c,e){var q=null;if(e<this.numberOfItems&&e>=0){this._removeFromOtherLists(c);q=this._xforms[e]=c;this._list._update()}return q};this.removeItem=function(c){if(c<this.numberOfItems&&c>=0){for(var e=this._xforms[c],q=Array(this.numberOfItems-
1),b=0;b<c;++b)q[b]=this._xforms[b];for(c=b;c<this.numberOfItems-1;++c,++b)q[c]=this._xforms[b+1];this.numberOfItems--;this._xforms=q;this._list._update();return e}else throw{code:1};};this.appendItem=function(c){this._removeFromOtherLists(c);this._xforms.push(c);this.numberOfItems++;this._list._update();return c}};svgedit.transformlist.resetListMap=function(){u={}};svgedit.transformlist.removeElementFromListMap=function(a){a.id&&u[a.id]&&delete u[a.id]};svgedit.transformlist.getTransformList=function(a){if(svgedit.browser.supportsNativeTransformLists())if(a.transform)return a.transform.baseVal;
else if(a.gradientTransform)return a.gradientTransform.baseVal;else{if(a.patternTransform)return a.patternTransform.baseVal}else{var c=a.id;c||(c="temp");var e=u[c];if(!e||c=="temp"){u[c]=new svgedit.transformlist.SVGTransformList(a);u[c]._init();e=u[c]}return e}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var l=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(u,a,c){return{x:c.a*u+c.c*a+c.e,y:c.b*u+c.d*a+c.f}};svgedit.math.isIdentity=function(u){return u.a===1&&u.b===0&&u.c===0&&u.d===1&&u.e===0&&u.f===0};svgedit.math.matrixMultiply=function(){for(var u=arguments,a=u.length,c=u[a-1];a-- >1;)c=u[a-1].multiply(c);if(Math.abs(c.a)<1.0E-14)c.a=0;if(Math.abs(c.b)<1.0E-14)c.b=0;if(Math.abs(c.c)<1.0E-14)c.c=0;if(Math.abs(c.d)<
1.0E-14)c.d=0;if(Math.abs(c.e)<1.0E-14)c.e=0;if(Math.abs(c.f)<1.0E-14)c.f=0;return c};svgedit.math.hasMatrixTransform=function(u){if(!u)return false;for(var a=u.numberOfItems;a--;){var c=u.getItem(a);if(c.type==1&&!svgedit.math.isIdentity(c.matrix))return true}return false};svgedit.math.transformBox=function(u,a,c,e,q){var b={x:u,y:a},h={x:u+c,y:a};c={x:u+c,y:a+e};u={x:u,y:a+e};a=svgedit.math.transformPoint;b=a(b.x,b.y,q);var f=e=b.x,n=b.y,s=b.y;h=a(h.x,h.y,q);e=Math.min(e,h.x);f=Math.max(f,h.x);
n=Math.min(n,h.y);s=Math.max(s,h.y);u=a(u.x,u.y,q);e=Math.min(e,u.x);f=Math.max(f,u.x);n=Math.min(n,u.y);s=Math.max(s,u.y);c=a(c.x,c.y,q);e=Math.min(e,c.x);f=Math.max(f,c.x);n=Math.min(n,c.y);s=Math.max(s,c.y);return{tl:b,tr:h,bl:u,br:c,aabox:{x:e,y:n,width:f-e,height:s-n}}};svgedit.math.transformListToTransform=function(u,a,c){if(u==null)return l.createSVGTransformFromMatrix(l.createSVGMatrix());a=a==undefined?0:a;c=c==undefined?u.numberOfItems-1:c;a=parseInt(a);c=parseInt(c);if(a>c){var e=c;c=a;
a=e}e=l.createSVGMatrix();for(a=a;a<=c;++a){var q=a>=0&&a<u.numberOfItems?u.getItem(a).matrix:l.createSVGMatrix();e=svgedit.math.matrixMultiply(e,q)}return l.createSVGTransformFromMatrix(e)};svgedit.math.getMatrix=function(u){u=svgedit.transformlist.getTransformList(u);return svgedit.math.transformListToTransform(u).matrix};svgedit.math.snapToAngle=function(u,a,c,e){var q=Math.PI/4;c=c-u;var b=e-a;e=Math.sqrt(c*c+b*b);q=Math.round(Math.atan2(b,c)/q)*q;return{x:u+e*Math.cos(q),y:a+e*Math.sin(q),a:q}};
svgedit.math.rectsIntersect=function(u,a){if(!u||!a)return false;return a.x<u.x+u.width&&a.x+a.width>u.x&&a.y<u.y+u.height&&a.y+a.height>u.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var l=["x","x1","cx","rx","width"],u=["y","y1","cy","ry","height"],a=$.merge(["r","radius"],l);$.merge(a,u);var c,e={px:1};svgedit.units.init=function(b){c=b;b=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(b);var h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("width","1em");h.setAttribute("height","1ex");h.setAttribute("x","1in");b.appendChild(h);h=h.getBBox();document.body.removeChild(b);
b=h.x;e.em=h.width;e.ex=h.height;e["in"]=b;e.cm=b/2.54;e.mm=b/25.4;e.pt=b/72;e.pc=b/6;e["%"]=0};svgedit.units.getTypeMap=function(){return e};svgedit.units.shortFloat=function(b){var h=c.getRoundDigits();if(isNaN(b)){if($.isArray(b))return svgedit.units.shortFloat(b[0])+","+svgedit.units.shortFloat(b[1])}else return+(+b).toFixed(h);return parseFloat(b).toFixed(h)-0};svgedit.units.convertUnit=function(b,h){h=h||c.getBaseUnit();return svgedit.unit.shortFloat(b/e[h])};svgedit.units.setUnitAttr=function(b,
h,f){isNaN(f)||b.getAttribute(h);b.setAttribute(h,f)};var q={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(b){var h=b.tagName,f=c.getBaseUnit();if(h=q[h])for(var n=h.length,s=0;s<n;s++){var A=h[s],p=b.getAttribute(A);if(p)isNaN(p)||b.setAttribute(A,p/e[f]+f)}};svgedit.units.convertToNum=
function(b,h){if(!isNaN(h))return h-0;if(h.substr(-1)==="%"){var f=h.substr(0,h.length-1)/100,n=c.getWidth(),s=c.getHeight();return l.indexOf(b)>=0?f*n:u.indexOf(b)>=0?f*s:f*Math.sqrt(n*n+s*s)/Math.sqrt(2)}else{n=h.substr(-2);f=h.substr(0,h.length-2);return f*e[n]}};svgedit.units.isValidUnit=function(b,h,f){var n=false;if(a.indexOf(b)>=0)if(isNaN(h)){h=h.toLowerCase();$.each(e,function(p){if(!n)if(RegExp("^-?[\\d\\.]+"+p+"$").test(h))n=true})}else n=true;else if(b=="id"){b=false;try{var s=c.getElement(h);
b=s==null||s===f}catch(A){}return b}else n=true;return n}})();svgedit=svgedit||{};
(function(){function l(b){if(svgedit.browser.supportsHVLineContainerBBox())try{return b.getBBox()}catch(h){}var f=$.data(b,"ref"),n=null;if(f){var s=$(f).children().clone().attr("visibility","hidden");$(q).append(s);n=s.filter("line, path")}else n=$(b).find("line, path");var A=false;if(n.length){n.each(function(){var p=this.getBBox();if(!p.width||!p.height)A=true});if(A){b=f?s:$(b).children();ret=getStrokedBBox(b)}else ret=b.getBBox()}else ret=b.getBBox();f&&s.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var u="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),a=null,c=null,e=null,q=null;svgedit.utilities.init=function(b){a=b;c=b.getDOMDocument();e=b.getDOMContainer();q=b.getSVGRoot()};svgedit.utilities.toXml=function(b){return $("<p/>").text(b).html()};svgedit.utilities.fromXml=function(b){return $("<p/>").html(b).text()};svgedit.utilities.encode64=function(b){b=svgedit.utilities.convertToXMLReferences(b);if(window.btoa)return window.btoa(b);
var h=Array(Math.floor((b.length+2)/3)*4),f,n,s,A,p,L,Q=0,N=0;do{f=b.charCodeAt(Q++);n=b.charCodeAt(Q++);s=b.charCodeAt(Q++);A=f>>2;f=(f&3)<<4|n>>4;p=(n&15)<<2|s>>6;L=s&63;if(isNaN(n))p=L=64;else if(isNaN(s))L=64;h[N++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(A);h[N++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);h[N++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(p);h[N++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(L)}while(Q<
b.length);return h.join("")};svgedit.utilities.decode64=function(b){if(window.atob)return window.atob(b);var h="",f,n,s="",A,p="",L=0;b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(L++));n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(L++));A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(L++));p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(L++));
f=f<<2|n>>4;n=(n&15)<<4|A>>2;s=(A&3)<<6|p;h+=String.fromCharCode(f);if(A!=64)h+=String.fromCharCode(n);if(p!=64)h+=String.fromCharCode(s)}while(L<b.length);return unescape(h)};svgedit.utilities.convertToXMLReferences=function(b){for(var h="",f=0;f<b.length;f++){var n=b.charCodeAt(f);if(n<128)h+=b[f];else if(n>127)h+="&#"+n+";"}return h};svgedit.utilities.text2xml=function(b){if(b.indexOf("<svg:svg")>=0)b=b.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var h;try{var f=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");f.async=false}catch(n){throw Error("XML Parser could not be instantiated");}try{h=f.loadXML?f.loadXML(b)?f:false:f.parseFromString(b,"text/xml")}catch(s){throw Error("Error parsing XML string");}return h};svgedit.utilities.bboxToObj=function(b){return{x:b.x,y:b.y,width:b.width,height:b.height}};svgedit.utilities.walkTree=function(b,h){if(b&&b.nodeType==1){h(b);for(var f=b.childNodes.length;f--;)svgedit.utilities.walkTree(b.childNodes.item(f),h)}};
svgedit.utilities.walkTreePost=function(b,h){if(b&&b.nodeType==1){for(var f=b.childNodes.length;f--;)svgedit.utilities.walkTree(b.childNodes.item(f),h);h(b)}};svgedit.utilities.getUrlFromAttr=function(b){if(b)if(b.indexOf('url("')===0)return b.substring(5,b.indexOf('"',6));else if(b.indexOf("url('")===0)return b.substring(5,b.indexOf("'",6));else if(b.indexOf("url(")===0)return b.substring(4,b.indexOf(")"));return null};svgedit.utilities.getHref=function(b){if(b)return b.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(b,h){b.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h)};svgedit.utilities.findDefs=function(b){b=a.getSVGContent().documentElement;var h=b.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return h=h.length>0?h[0]:b.insertBefore(b.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),b.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(b){var h=b.pathSegList,f=h.numberOfItems;b=[[],[]];var n=h.getItem(0),
s=[n.x,n.y];for(n=0;n<f;n++){var A=h.getItem(n);if(typeof A.x!="undefined"){b[0].push(s[0]);b[1].push(s[1]);if(A.x1){for(var p=[A.x1,A.y1],L=[A.x2,A.y2],Q=[A.x,A.y],N=0;N<2;N++){A=function(ha){return Math.pow(1-ha,3)*s[N]+3*Math.pow(1-ha,2)*ha*p[N]+3*(1-ha)*Math.pow(ha,2)*L[N]+Math.pow(ha,3)*Q[N]};var J=6*s[N]-12*p[N]+6*L[N],P=-3*s[N]+9*p[N]-9*L[N]+3*Q[N],U=3*p[N]-3*s[N];if(P==0){if(J!=0){J=-U/J;0<J&&J<1&&b[N].push(A(J))}}else{U=Math.pow(J,2)-4*U*P;if(!(U<0)){var O=(-J+Math.sqrt(U))/(2*P);0<O&&O<
1&&b[N].push(A(O));J=(-J-Math.sqrt(U))/(2*P);0<J&&J<1&&b[N].push(A(J))}}}s=Q}else{b[0].push(A.x);b[1].push(A.y)}}}h=Math.min.apply(null,b[0]);f=Math.max.apply(null,b[0])-h;n=Math.min.apply(null,b[1]);b=Math.max.apply(null,b[1])-n;return{x:h,y:n,width:f,height:b}};svgedit.utilities.getBBox=function(b){var h=b||a.getSelectedElements()[0];if(b.nodeType!=1)return null;b=null;var f=h.nodeName;switch(f){case "text":if(h.textContent===""){h.textContent="a";b=h.getBBox();h.textContent=""}else try{b=h.getBBox()}catch(n){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{b=h.getBBox()}catch(s){}else b=svgedit.utilities.getPathBBox(h);break;case "g":case "a":b=l(h);break;default:if(f==="use")b=l(h,true);if(f==="use")b||(b=h.getBBox());else if(~u.indexOf(f))try{b=h.getBBox()}catch(A){h=$(h).closest("foreignObject");if(h.length)try{b=h[0].getBBox()}catch(p){b=null}else b=null}}if(b)b=svgedit.utilities.bboxToObj(b);return b};svgedit.utilities.getRotationAngle=function(b,h){var f=b||a.getSelectedElements()[0];f=svgedit.transformlist.getTransformList(f);
if(!f)return 0;for(var n=f.numberOfItems,s=0;s<n;++s){var A=f.getItem(s);if(A.type==4)return h?A.angle*Math.PI/180:A.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(b){return q.querySelector("#"+b)}:svgedit.browser.supportsXpath()?function(b){return c.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+b+'"]',e,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(b){return $(q).find("[id="+b+"]")[0]};svgedit.utilities.assignAttributes=
function(b,h,f,n){f||(f=0);svgedit.browser.isOpera()||q.suspendRedraw(f);for(var s in h)if(f=s.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":s.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)b.setAttributeNS(f,s,h[s]);else n?svgedit.units.setUnitAttr(b,s,h[s]):b.setAttribute(s,h[s]);svgedit.browser.isOpera()||q.unsuspendRedraw(null)};svgedit.utilities.cleanupElement=function(b){var h=q.suspendRedraw(60),f={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none",
"stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},n;for(n in f){var s=f[n];b.getAttribute(n)==s&&b.removeAttribute(n)}q.unsuspendRedraw(h)}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var l={};l["http://www.w3.org/1999/xlink"]="xlink";l["http://www.w3.org/XML/1998/namespace"]="xml";l["http://www.w3.org/2000/xmlns/"]="xmlns";l["http://svg-edit.googlecode.com"]="se";l["http://www.w3.org/1999/xhtml"]="xhtml";l["http://www.w3.org/1998/Math/MathML"]="mathml";var u={};$.each(l,function(e,q){u[q]=e});var a={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},c={};$.each(a,function(e,q){var b={};$.each(q,function(h,f){if(f.indexOf(":")>=0){var n=f.split(":");b[n[1]]=u[n[0]]}else b[f]=f=="xmlns"?"http://www.w3.org/2000/xmlns/":null});c[e]=b});svgedit.sanitize.getNSMap=function(){return l};svgedit.sanitize.sanitizeSvg=function(e){if(e.nodeType==3){e.nodeValue=e.nodeValue.replace(/^\s+|\s+$/g,"");e.nodeValue.length||e.parentNode.removeChild(e)}if(e.nodeType==1){var q=e.parentNode;if(e.ownerDocument&&q){var b=a[e.nodeName],h=c[e.nodeName];if(b!=
undefined){for(var f=[],n=e.attributes.length;n--;){var s=e.attributes.item(n),A=s.nodeName,p=s.localName,L=s.namespaceURI;if(!(h.hasOwnProperty(p)&&L==h[p]&&L!="http://www.w3.org/2000/xmlns/")&&!(L=="http://www.w3.org/2000/xmlns/"&&l[s.nodeValue])){A.indexOf("se:")==0&&f.push([A,s.nodeValue]);e.removeAttributeNS(L,p)}if(svgedit.browser.isGecko())switch(A){case "transform":case "gradientTransform":case "patternTransform":p=s.nodeValue.replace(/(\d)-/g,"$1 -");e.setAttribute(A,p)}if(A=="style"){s=
s.nodeValue.split(";");for(A=s.length;A--;){p=s[A].split(":");b.indexOf(p[0])>=0&&e.setAttribute(p[0],p[1])}e.removeAttribute("style")}}$.each(f,function(Q,N){e.setAttributeNS("http://svg-edit.googlecode.com",N[0],N[1])});if((n=svgedit.utilities.getHref(e))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(e.nodeName)>=0)if(n[0]!="#"){svgedit.utilities.setHref(e,"");e.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(e.nodeName=="use"&&!svgedit.utilities.getHref(e))q.removeChild(e);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(Q,N){var J=e.getAttribute(N);if(J)if((J=svgedit.utilities.getUrlFromAttr(J))&&J[0]!=="#"){e.setAttribute(N,"");e.removeAttribute(N)}});for(n=e.childNodes.length;n--;)svgedit.sanitize.sanitizeSvg(e.childNodes.item(n))}}else{for(b=[];e.hasChildNodes();)b.push(q.insertBefore(e.firstChild,e));q.removeChild(e);for(n=b.length;n--;)svgedit.sanitize.sanitizeSvg(b[n])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(l,u,a,c){this.elem=l;this.text=c?"Move "+l.tagName+" to "+c:"Move "+l.tagName;this.oldNextSibling=u;this.oldParent=a;this.newNextSibling=l.nextSibling;this.newParent=l.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(l,u){this.elem=l;this.text=u||"Create "+l.tagName;this.parent=l.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(l,u,a,c){this.elem=l;this.text=c||"Delete "+l.tagName;this.nextSibling=u;this.parent=a;svgedit.transformlist.removeElementFromListMap(l)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(l,u,a){this.elem=l;this.text=a?"Change "+l.tagName+" "+a:"Change "+l.tagName;this.newValues={};this.oldValues=u;for(var c in u)this.newValues[c]=c=="#text"?l.textContent:c=="#href"?svgedit.utilities.getHref(l):l.getAttribute(c)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var u=false,a;for(a in this.newValues){if(this.newValues[a])if(a=="#text")this.elem.textContent=this.newValues[a];else a=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[a]):this.elem.setAttribute(a,this.newValues[a]);else if(a=="#text")this.elem.textContent="";else{this.elem.setAttribute(a,"");this.elem.removeAttribute(a)}if(a==
"transform")u=true}if(!u)if(u=svgedit.utilities.getRotationAngle(this.elem)){a=elem.getBBox();u=["rotate(",u," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");u!=elem.getAttribute("transform")&&elem.setAttribute("transform",u)}l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var u=false,a;for(a in this.oldValues){if(this.oldValues[a])if(a==
"#text")this.elem.textContent=this.oldValues[a];else a=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[a]):this.elem.setAttribute(a,this.oldValues[a]);else if(a=="#text")this.elem.textContent="";else this.elem.removeAttribute(a);if(a=="transform")u=true}if(!u)if(u=svgedit.utilities.getRotationAngle(this.elem)){a=this.elem.getBBox();u=["rotate(",u," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");u!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",u)}svgedit.transformlist.removeElementFromListMap(this.elem);
l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(l){this.text=l||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var u=this.stack.length,a=0;a<u;++a)this.stack[a].apply(l);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(l){l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var u=this.stack.length-1;u>=0;u--)this.stack[u].unapply(l);l&&l.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var l=[],u=this.stack.length;u--;)for(var a=this.stack[u].elements(),c=a.length;c--;)l.indexOf(a[c])==-1&&l.push(a[c]);return l};svgedit.history.BatchCommand.prototype.addSubCommand=function(l){this.stack.push(l)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(l){this.handler_=l||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(l){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(l);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(l,u){for(var a=++this.undoChangeStackPointer,c=u.length,e=Array(c),q=Array(c);c--;){var b=u[c];if(b!=null){q[c]=b;e[c]=b.getAttribute(l)}}this.undoableChangeStack[a]=
{attrName:l,oldValues:e,elements:q}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var l=this.undoChangeStackPointer--,u=this.undoableChangeStack[l],a=u.elements.length,c=u.attrName,e=new svgedit.history.BatchCommand("Change "+c);a--;){var q=u.elements[a];if(q!=null){var b={};b[c]=u.oldValues[a];b[c]!=q.getAttribute(c)&&e.addSubCommand(new svgedit.history.ChangeElementCommand(q,b,c))}}this.undoableChangeStack[l]=null;return e}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var l,u,a;svgedit.select.Selector=function(c,e){this.id=c;this.selectedElement=e;this.locked=true;this.selectorGroup=l.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(l.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(c){this.locked=true;this.selectedElement=c;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(c){var e=[];c=Math.round(c/45);if(c<0)c+=8;for(var q in a.selectorGrips)e.push(q);for(;c>0;){e.push(e.shift());c--}c=0;for(q in a.selectorGrips){a.selectorGrips[q].setAttribute("style",
"cursor:"+e[c]+"-resize");c++}};svgedit.select.Selector.prototype.showGrips=function(c){a.selectorGripsGroup.setAttribute("display",c?"inline":"none");var e=this.selectedElement;this.hasGrips=c;if(e&&c){this.selectorGroup.appendChild(a.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(e))}};svgedit.select.Selector.prototype.resize=function(){var c=this.selectorRect,e=a,q=e.selectorGrips,b=this.selectedElement,h=b.getAttribute("stroke-width"),f=l.currentZoom(),n=1/f;if(b.getAttribute("stroke")!==
"none"&&!isNaN(h))n+=h/2;var s=b.tagName;if(s==="text")n+=2/f;h=svgedit.transformlist.getTransformList(b);h=svgedit.math.transformListToTransform(h).matrix;h.e*=f;h.f*=f;var A=svgedit.utilities.getBBox(b);if(s==="g"&&!$.data(b,"gsvg"))if(s=l.getStrokedBBox(b.childNodes))A=s;s=A.x;var p=A.y,L=A.width;A=A.height;n*=f;f=svgedit.math.transformBox(s*f,p*f,L*f,A*f,h);h=f.aabox;s=h.x-n;p=h.y-n;L=h.width+n*2;var Q=h.height+n*2;h=s+L/2;A=p+Q/2;if(b=svgedit.utilities.getRotationAngle(b)){s=l.svgRoot().createSVGTransform();
s.setRotate(-b,h,A);s=s.matrix;f.tl=svgedit.math.transformPoint(f.tl.x,f.tl.y,s);f.tr=svgedit.math.transformPoint(f.tr.x,f.tr.y,s);f.bl=svgedit.math.transformPoint(f.bl.x,f.bl.y,s);f.br=svgedit.math.transformPoint(f.br.x,f.br.y,s);s=f.tl;L=s.x;Q=s.y;var N=s.x,J=s.y;s=Math.min;p=Math.max;L=s(L,s(f.tr.x,s(f.bl.x,f.br.x)))-n;Q=s(Q,s(f.tr.y,s(f.bl.y,f.br.y)))-n;N=p(N,p(f.tr.x,p(f.bl.x,f.br.x)))+n;J=p(J,p(f.tr.y,p(f.bl.y,f.br.y)))+n;s=L;p=Q;L=N-L;Q=J-Q}n=l.svgRoot().suspendRedraw(100);c.setAttribute("d",
"M"+s+","+p+" L"+(s+L)+","+p+" "+(s+L)+","+(p+Q)+" "+s+","+(p+Q)+"z");this.selectorGroup.setAttribute("transform",b?"rotate("+[b,h,A].join(",")+")":"");if(svgedit.browser.isTouch()){s-=15.75;p-=15.75}else{s-=4;p-=4}this.gripCoords={nw:[s,p].map(Math.round),ne:[s+L,p].map(Math.round),sw:[s,p+Q].map(Math.round),se:[s+L,p+Q].map(Math.round),n:[s+L/2,p].map(Math.round),w:[s,p+Q/2].map(Math.round),e:[s+L,p+Q/2].map(Math.round),s:[s+L/2,p+Q].map(Math.round)};for(var P in this.gripCoords){c=this.gripCoords[P];
q[P].setAttribute("x",c[0]);q[P].setAttribute("y",c[1])}this.rotateCoords={nw:[s,p],ne:[s+L+8,p],sw:[s,p+Q+8],se:[s+L+8,p+Q+8]};for(P in this.rotateCoords){c=this.rotateCoords[P];e.rotateGrips[P].setAttribute("cx",c[0]);e.rotateGrips[P].setAttribute("cy",c[1])}l.svgRoot().unsuspendRedraw(n)};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};
this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=l.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=l.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);
l.svgRoot().appendChild(this.selectorParentGroup);this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var c in this.rotateGrips){var e=l.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+c,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+u.imgPath+"rotate.png) 12 12, auto;"}});$.data(e,"dir",c);$.data(e,"type","rotate");this.rotateGrips[c]=this.selectorGripsGroup.appendChild(e)}for(c in this.selectorGrips){e=l.createSVGElement({element:"rect",
attr:{id:"selectorGrip_resize_"+c,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+c+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){e.setAttribute("width",30.5);e.setAttribute("height",30.5);e.setAttribute("fill-opacity",0.3)}$.data(e,"dir",c);$.data(e,"type","resize");this.selectorGrips[c]=this.selectorGripsGroup.appendChild(e)}if(!$("#canvasBackground").length){c=u.dimensions;c=l.createSVGElement({element:"svg",attr:{id:"canvasBackground",
width:c[0],height:c[1],x:0,y:0,overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});e=l.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var q=l.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),b=l.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),h=l.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),
f=l.createSVGElement({element:"rect",attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),n=l.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});c.appendChild(e);e.appendChild(q);q.appendChild(b);q.appendChild(h);q.appendChild(f);c.appendChild(n);l.svgRoot().insertBefore(c,l.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(c){if(c==null)return null;var e=this.selectors.length;
if(typeof this.selectorMap[c.id]=="object"){this.selectorMap[c.id].locked=true;return this.selectorMap[c.id]}for(var q=0;q<e;++q)if(this.selectors[q]&&!this.selectors[q].locked){this.selectors[q].locked=true;this.selectors[q].reset(c);this.selectorMap[c.id]=this.selectors[q];return this.selectors[q]}this.selectors[e]=new svgedit.select.Selector(e,c);this.selectorParentGroup.appendChild(this.selectors[e].selectorGroup);this.selectorMap[c.id]=this.selectors[e];return this.selectors[e]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(c){if(c!=null)for(var e=this.selectors.length,q=this.selectorMap[c.id],b=0;b<e;++b)if(this.selectors[b]&&this.selectors[b]==q){q.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[c.id];q.locked=false;q.selectedElement=null;q.showGrips(false);try{q.selectorGroup.setAttribute("display","none")}catch(h){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(l.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(c,e){u=c;l=e;a=new svgedit.select.SelectorManager;l.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return a}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var l="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),u={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},a=u.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(c,e){this.name_=c;this.group_=e};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(c,e){a=c==false?u.NEVER_RANDOMIZE:
u.ALWAYS_RANDOMIZE;if(a==u.ALWAYS_RANDOMIZE&&!e.getNonce())e.setNonce(Math.floor(Math.random()*100001));else a==u.NEVER_RANDOMIZE&&e.getNonce()&&e.clearNonce()};svgedit.draw.Drawing=function(c,e){if(!c||!c.tagName||!c.namespaceURI||c.tagName!="svg"||c.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=c;this.obj_num=0;this.idPrefix=e||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var q=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(q&&a!=u.NEVER_RANDOMIZE)this.nonce_=q;else a==u.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(c){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+c):$(this.svgElem_).find("[id="+c+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(c){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",c);this.nonce_=c};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var c=
this.obj_num,e=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();e=true}else this.obj_num++;for(var q=this.getId();this.getElem_(q);){if(e){this.obj_num=c;e=false}this.obj_num++;q=this.getId()}if(e)this.obj_num=c;return q};svgedit.draw.Drawing.prototype.releaseId=function(c){var e=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof c!="string"||c.indexOf(e)!=0)return false;c=parseInt(c.substr(e.length));if(typeof c!="number"||c<=0||this.releasedNums.indexOf(c)!=-1)return false;
this.releasedNums.push(c);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(c){for(var e=0;e<this.getNumLayers();e++)if(this.all_layers[e][0]==c)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(c){if(c>=0&&c<this.getNumLayers())return this.all_layers[c][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var c=0;c<this.getNumLayers();++c)if(this.all_layers[c][1]==this.current_layer)return this.getLayerName(c);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(c){for(var e=0;e<this.getNumLayers();++e)if(c==this.getLayerName(e)){if(this.current_layer!=this.all_layers[e][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[e][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var c=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return c}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var c=this.svgElem_.childNodes.length,e=[],q=[],b=null,h=false,f=0;f<c;++f){var n=this.svgElem_.childNodes.item(f);if(n&&n.nodeType==1)if(n.tagName=="g"){h=true;var s=$("title",n).text();if(!s&&svgedit.browser.isOpera()&&n.querySelectorAll)s=$(n.querySelectorAll("title")).text();
if(s){q.push(s);this.all_layers.push([s,n]);b=n;svgedit.utilities.walkTree(n,function(A){A.setAttribute("style","pointer-events:inherit")});b.setAttribute("style","pointer-events:none")}else e.push(n)}else if(~l.indexOf(n.nodeName)){svgedit.utilities.getBBox(n);e.push(n)}}c=this.svgElem_.ownerDocument;if(e.length>0||!h){for(f=1;q.indexOf("Layer "+f)>=0;)f++;q="Layer "+f;b=c.createElementNS("http://www.w3.org/2000/svg","g");h=c.createElementNS("http://www.w3.org/2000/svg","title");h.textContent=q;
b.appendChild(h);for(h=0;h<e.length;++h)b.appendChild(e[h]);this.svgElem_.appendChild(b);this.all_layers.push([q,b])}svgedit.utilities.walkTree(b,function(A){A.setAttribute("style","pointer-events:inherit")});this.current_layer=b.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:b;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(c){var e=this.svgElem_.ownerDocument,q=e.createElementNS("http://www.w3.org/2000/svg",
"g");e=e.createElementNS("http://www.w3.org/2000/svg","title");e.textContent=c;q.appendChild(e);this.svgElem_.appendChild(q);this.identifyLayers();return q};svgedit.draw.Drawing.prototype.getLayerVisibility=function(c){for(var e=null,q=0;q<this.getNumLayers();++q)if(this.getLayerName(q)==c){e=this.all_layers[q][1];break}if(!e)return false;return e.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(c,e){if(typeof e!="boolean")return null;for(var q=null,b=0;b<
this.getNumLayers();++b)if(this.getLayerName(b)==c){q=this.all_layers[b][1];break}if(!q)return null;q.getAttribute("display");q.setAttribute("display",e?"inline":"none");return q};svgedit.draw.Drawing.prototype.getLayerOpacity=function(c){for(var e=0;e<this.getNumLayers();++e)if(this.getLayerName(e)==c){(c=this.all_layers[e][1].getAttribute("opacity"))||(c="1.0");return parseFloat(c)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(c,e){if(!(typeof e!="number"||e<0||e>1))for(var q=
0;q<this.getNumLayers();++q)if(this.getLayerName(q)==c){this.all_layers[q][1].setAttribute("opacity",e);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var l={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},u={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},a=[],c=false,e={};svgedit.path.setLinkControlPoints=function(h){c=h};var q=svgedit.path.path=null;svgedit.path.init=
function(h){q=h;a=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(f,n){a.push(n+"Abs");a.push(n+"Rel")})};svgedit.path.insertItemBefore=function(h,f,n){h=h.pathSegList;if(svgedit.browser.supportsPathInsertItemBefore())h.insertItemBefore(f,n);else{for(var s=h.numberOfItems,A=[],p=0;p<s;p++){var L=h.getItem(p);A.push(L)}h.clear();for(p=0;p<s;p++){p==n&&h.appendItem(f);h.appendItem(A[p])}}};
svgedit.path.ptObjToArr=function(h,f){for(var n=u[h],s=n.length,A=Array(s),p=0;p<s;p++)A[p]=f[n[p]];return A};svgedit.path.getGripPt=function(h,f){var n={x:f?f.x:h.item.x,y:f?f.y:h.item.y},s=h.path;if(s.matrix)n=svgedit.math.transformPoint(n.x,n.y,s.matrix);n.x*=q.getCurrentZoom();n.y*=q.getCurrentZoom();return n};svgedit.path.getPointFromGrip=function(h,f){var n={x:h.x,y:h.y};if(f.matrix){h=svgedit.math.transformPoint(n.x,n.y,f.imatrix);n.x=h.x;n.y=h.y}n.x/=q.getCurrentZoom();n.y/=q.getCurrentZoom();
return n};svgedit.path.addPointGrip=function(h,f,n){var s=svgedit.path.getGripContainer(),A=svgedit.utilities.getElem("pathpointgrip_"+h);if(!A){A=document.createElementNS("http://www.w3.org/2000/svg","rect");svgedit.utilities.assignAttributes(A,{id:"pathpointgrip_"+h,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":l.pathNodeTooltip});
A=s.appendChild(A);$("#pathpointgrip_"+h).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(f&&n)svgedit.utilities.assignAttributes(A,{x:f-(svgedit.browser.isTouch()?15:2.5),y:n-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return A};svgedit.path.getGripContainer=function(){var h=svgedit.utilities.getElem("pathpointgrip_container");if(!h){h=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));h.id=
"pathpointgrip_container"}return h};svgedit.path.addCtrlGrip=function(h){var f=svgedit.utilities.getElem("ctrlpointgrip_"+h);if(f)return f;f=document.createElementNS("http://www.w3.org/2000/svg","circle");svgedit.utilities.assignAttributes(f,{id:"ctrlpointgrip_"+h,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":l.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(f);
return f};svgedit.path.getCtrlLine=function(h){var f=svgedit.utilities.getElem("ctrlLine_"+h);if(f)return f;f=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(f,{id:"ctrlLine_"+h,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(f);return f};svgedit.path.getPointGrip=function(h,f){var n=svgedit.path.addPointGrip(h.index);if(f){var s=svgedit.path.getGripPt(h);svgedit.utilities.assignAttributes(n,
{x:s.x-(svgedit.browser.isTouch()?15:2.5),y:s.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return n};svgedit.path.getControlPoints=function(h){var f=h.item,n=h.index;if(!f||!("x1"in f)||!("x2"in f))return null;var s={};svgedit.path.getGripContainer();for(var A=[svgedit.path.path.segs[n-1].item,f],p=1;p<3;p++){var L=n+"c"+p,Q=s["c"+p+"_line"]=svgedit.path.getCtrlLine(L),N=svgedit.path.getGripPt(h,{x:f["x"+p],y:f["y"+p]}),J=svgedit.path.getGripPt(h,{x:A[p-1].x,y:A[p-1].y});svgedit.utilities.assignAttributes(Q,
{x1:N.x,y1:N.y,x2:J.x,y2:J.y,display:"inline"});s["c"+p+"_line"]=Q;pointGrip=s["c"+p]=svgedit.path.addCtrlGrip(L);svgedit.utilities.assignAttributes(pointGrip,{cx:N.x,cy:N.y,display:"inline"});s["c"+p]=pointGrip}return s};svgedit.path.replacePathSeg=function(h,f,n,s){s=s||svgedit.path.path.elem;h=s["createSVGPathSeg"+a[h]].apply(s,n);if(svgedit.browser.supportsPathReplaceItem())s.pathSegList.replaceItem(h,f);else{n=s.pathSegList;s=n.numberOfItems;for(var A=[],p=0;p<s;p++){var L=n.getItem(p);A.push(L)}n.clear();
for(p=0;p<s;p++)p==f?n.appendItem(h):n.appendItem(A[p])}};svgedit.path.getSegSelector=function(h,f){var n=h.index,s=svgedit.utilities.getElem("segline_"+n);if(!s){var A=svgedit.path.getGripContainer();s=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(s,{id:"segline_"+n,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});A.appendChild(s)}if(f){n=h.prev;
if(!n){s.setAttribute("display","none");return s}n=svgedit.path.getGripPt(n);svgedit.path.replacePathSeg(2,0,[n.x,n.y],s);A=svgedit.path.ptObjToArr(h.type,h.item,true);for(var p=0;p<A.length;p+=2){n=svgedit.path.getGripPt(h,{x:A[p],y:A[p+1]});A[p]=n.x;A[p+1]=n.y}svgedit.path.replacePathSeg(h.type,1,A,s)}return s};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(h,f,n){var s=h.x-n.x,A=h.y-n.y,p=f.x-n.x,L=f.y-n.y;if((s!=0||A!=0)&&(p!=0||L!=0)){h=Math.atan2(A,s);f=Math.atan2(L,p);s=
Math.sqrt(s*s+A*A);p=Math.sqrt(p*p+L*L);A=q.getSVGRoot().createSVGPoint();L=q.getSVGRoot().createSVGPoint();if(h<0)h+=2*Math.PI;if(f<0)f+=2*Math.PI;var Q=Math.abs(h-f),N=Math.abs(Math.PI-Q)/2;if(h-f>0){h=Q<Math.PI?h+N:h-N;f=Q<Math.PI?f-N:f+N}else{h=Q<Math.PI?h-N:h+N;f=Q<Math.PI?f+N:f-N}A.x=s*Math.cos(h)+n.x;A.y=s*Math.sin(h)+n.y;L.x=p*Math.cos(f)+n.x;L.y=p*Math.sin(f)+n.y;return[A,L]}};svgedit.path.Segment=function(h,f){this.selected=false;this.index=h;this.item=f;this.type=f.pathSegType;this.ctrlpts=
[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(h){for(var f in this.ctrlpts)this.ctrlpts[f].setAttribute("display",h?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(h){if(this.ptgrip){this.ptgrip.setAttribute("display",h?"inline":"none");this.segsel.setAttribute("display",h?"inline":"none");this.showCtrlPts(h)}};
svgedit.path.Segment.prototype.select=function(h){if(this.ptgrip){this.ptgrip.setAttribute("stroke",h?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",h?"#4F80FF":"#fff");this.segsel.setAttribute("display",h?"inline":"none");this.ctrlpts&&this.selectCtrls(h);this.selected=h}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=
function(h){if(this.ptgrip){var f=svgedit.path.getGripPt(this),n=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:f.x-n,y:f.y-n}:{cx:f.x,cy:f.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(h){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};svgedit.path.Segment.prototype.move=function(h,f){var n=this.item;n=this.ctrlpts?[n.x+=h,n.y+=
f,n.x1,n.y1,n.x2+=h,n.y2+=f]:[n.x+=h,n.y+=f];svgedit.path.replacePathSeg(this.type,this.index,n);if(this.next&&this.next.ctrlpts){n=this.next.item;n=[n.x,n.y,n.x1+=h,n.y1+=f,n.x2,n.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,n)}if(this.mate){n=this.mate.item;n=[n.x+=h,n.y+=f];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,n)}this.update(true);this.next&&this.next.update(true)};svgedit.path.Segment.prototype.setLinked=function(h){var f,n,s;if(h==2){n=1;f=this.next;if(!f)return;
s=this.item}else{n=2;f=this.prev;if(!f)return;s=f.item}var A=f.item;A["x"+n]=s.x+s.x-this.item["x"+h];A["y"+n]=s.y+s.y-this.item["y"+h];svgedit.path.replacePathSeg(f.type,f.index,[A.x,A.y,A.x1,A.y1,A.x2,A.y2]);f.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(h,f,n){var s=this.item;s["x"+h]+=f;s["y"+h]+=n;svgedit.path.replacePathSeg(this.type,this.index,[s.x,s.y,s.x1,s.y1,s.x2,s.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=function(h,f){svgedit.path.replacePathSeg(h,
this.index,f);this.type=h;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(h===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(h){if(!h||h.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=h;this.segs=[];this.selected_pts=[];svgedit.path.path=this;this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display","none");var h=
this.elem.pathSegList,f=h.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var n=0;n<f;n++){var s=h.getItem(n);s=new svgedit.path.Segment(n,s);s.path=this;this.segs.push(s)}h=this.segs;s=null;for(n=0;n<f;n++){var A=h[n],p=n+1>=f?null:h[n+1],L=n-1<0?null:h[n-1];if(A.type===2){if(L&&L.type!==1){p=h[s];p.next=h[s+1];p.next.prev=p;p.addGrip()}s=n}else if(p&&p.type===1){A.next=h[s+1];A.next.prev=A;A.mate=h[s];A.addGrip();if(this.first_seg==null)this.first_seg=A}else if(p){if(A.type!==
1){A.addGrip();if(p&&p.type!==2){A.next=p;A.next.prev=A}}}else if(A.type!==1){p=h[s];p.next=h[s+1];p.next.prev=p;p.addGrip();A.addGrip();if(!this.first_seg)this.first_seg=h[s]}}return this};svgedit.path.Path.prototype.eachSeg=function(h){for(var f=this.segs.length,n=0;n<f;n++)if(h.call(this.segs[n],n)===false)break};svgedit.path.Path.prototype.addSeg=function(h){var f=this.segs[h];if(f.prev){var n=f.prev,s;switch(f.item.pathSegType){case 4:var A=(f.item.x+n.item.x)/2,p=(f.item.y+n.item.y)/2;s=this.elem.createSVGPathSegLinetoAbs(A,
p);break;case 6:s=(n.item.x+f.item.x1)/2;var L=(f.item.x1+f.item.x2)/2,Q=(f.item.x2+f.item.x)/2,N=(s+L)/2;L=(L+Q)/2;A=(N+L)/2;var J=(n.item.y+f.item.y1)/2,P=(f.item.y1+f.item.y2)/2;n=(f.item.y2+f.item.y)/2;var U=(J+P)/2;P=(P+n)/2;p=(U+P)/2;s=this.elem.createSVGPathSegCurvetoCubicAbs(A,p,s,J,N,U);svgedit.path.replacePathSeg(f.type,h,[f.item.x,f.item.y,L,P,Q,n])}svgedit.path.insertItemBefore(this.elem,s,h)}};svgedit.path.Path.prototype.deleteSeg=function(h){var f=this.segs[h],n=this.elem.pathSegList;
f.show(false);var s=f.next;if(f.mate){var A=[s.item.x,s.item.y];svgedit.path.replacePathSeg(2,s.index,A);svgedit.path.replacePathSeg(4,f.index,A);n.removeItem(f.mate.index)}else{if(!f.prev){A=[s.item.x,s.item.y];svgedit.path.replacePathSeg(2,f.next.index,A)}n.removeItem(h)}};svgedit.path.Path.prototype.subpathIsClosed=function(h){var f=false;svgedit.path.path.eachSeg(function(n){if(n<=h)return true;if(this.type===2)return false;else if(this.type===1){f=true;return false}});return f};svgedit.path.Path.prototype.removePtFromSelection=
function(h){var f=this.selected_pts.indexOf(h);if(f!=-1){this.segs[h].select(false);this.selected_pts.splice(f,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=function(h){this.eachSeg(function(){this.show(h)});h&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(h,
f){for(var n=this.selected_pts.length;n--;)this.segs[this.selected_pts[n]].move(h,f)};svgedit.path.Path.prototype.moveCtrl=function(h,f){var n=this.segs[this.selected_pts[0]];n.moveCtrl(this.dragctrl,h,f);c&&n.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(h){this.storeD();for(var f=this.selected_pts.length,n;f--;){var s=this.segs[this.selected_pts[f]],A=s.prev;if(A){if(!h){n="Toggle Path Segment Type";h=s.type==6?4:6}h-=0;var p=s.item.x,L=s.item.y,Q=A.item.x;A=A.item.y;
var N;switch(h){case 6:if(s.olditem){Q=s.olditem;N=[p,L,Q.x1,Q.y1,Q.x2,Q.y2]}else{N=p-Q;var J=L-A;N=[p,L,Q+N/3,A+J/3,p-N/3,L-J/3]}break;case 4:N=[p,L];s.olditem=s.item}s.setType(h,N)}}svgedit.path.path.endChanges(n)};svgedit.path.Path.prototype.selectPt=function(h,f){this.clearSelection();h==null&&this.eachSeg(function(n){if(this.prev)h=n});this.addPtsToSelection(h);if(f){this.dragctrl=f;c&&this.segs[h].setLinked(f)}};svgedit.path.Path.prototype.update=function(){var h=this.elem;if(svgedit.utilities.getRotationAngle(h)){this.matrix=
svgedit.math.getMatrix(h);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(f){this.item=h.pathSegList.getItem(f);this.update()});return this};svgedit.path.getPath_=function(h){var f=e[h.id];f||(f=e[h.id]=new svgedit.path.Path(h));return f};svgedit.path.removePath_=function(h){h in e&&delete e[h]};var b=function(h,f,n,s,A,p,L){dx=h-n;dy=f-s;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+L;dx=r*Math.cos(theta)+n;dy=r*Math.sin(theta)+s;dx-=A;dy-=p;r=Math.sqrt(dx*
dx+dy*dy);theta=Math.atan2(dy,dx)-L;return{x:(r*Math.cos(theta)+A)/1,y:(r*Math.sin(theta)+p)/1}};svgedit.path.recalcRotatedPath=function(){var h=svgedit.path.path.elem,f=svgedit.utilities.getRotationAngle(h,true);if(f){var n=svgedit.utilities.getBBox(h),s=svgedit.path.path.oldbbox,A=s.x+s.width/2;s=s.y+s.height/2;var p=n.x+n.width/2;n=n.y+n.height/2;p=p-A;var L=n-s;n=Math.sqrt(p*p+L*L);L=Math.atan2(L,p)+f;p=n*Math.cos(L)+A;n=n*Math.sin(L)+s;L=h.pathSegList;for(var Q=L.numberOfItems;Q;){Q-=1;var N=
L.getItem(Q),J=N.pathSegType;if(J!=1){var P=b(N.x,N.y,A,s,p,n,f);P=[P.x,P.y];if(N.x1!=null&&N.x2!=null){c_vals1=b(N.x1,N.y1,A,s,p,n,f);c_vals2=b(N.x2,N.y2,A,s,p,n,f);P.splice(P.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(J,Q,P)}}svgedit.utilities.getBBox(h);A=svgroot.createSVGTransform();h=svgedit.transformlist.getTransformList(h);A.setRotate(f*180/Math.PI,p,n);h.replaceItem(A,0)}};svgedit.path.clearData=function(){e={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(l){opera.postError(l)};window.console.dir=function(){}}
(function(){var l=jQuery.fn.attr;jQuery.fn.attr=function(u,a){var c=this.length;if(!c)return l.apply(this,arguments);for(var e=0;e<c;e++){var q=this[e];if(q.namespaceURI==="http://www.w3.org/2000/svg")if(a!==undefined)q.setAttribute(u,a);else if($.isArray(u)){c=u.length;for(e={};c--;){var b=u[c],h=q.getAttribute(b);if(h||h==="0")h=isNaN(h)?h:h-0;e[b]=h}return e}else if(typeof u==="object")for(b in u)q.setAttribute(b,u[b]);else{if((h=q.getAttribute(u))||h==="0")h=isNaN(h)?h:h-0;return h}else return l.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(l,u){function a(g,k){for(var m=svgedit.utilities.getBBox(g),B=0;B<2;B++){var z=B===0?"fill":"stroke",H=g.getAttribute(z);if(H&&H.indexOf("url(")===0){H=R(H);if(H.tagName==="linearGradient"){var C=H.getAttribute("x1")||0,v=H.getAttribute("y1")||0,F=H.getAttribute("x2")||1,I=H.getAttribute("y2")||0;C=m.width*C+m.x;v=m.height*v+m.y;F=m.width*F+m.x;I=m.height*I+m.y;C=O(C,v,k);I=O(F,I,k);F={};F.x1=(C.x-m.x)/m.width;F.y1=(C.y-m.y)/m.height;F.x2=(I.x-m.x)/m.width;F.y2=(I.y-m.y)/m.height;
H=H.cloneNode(true);$(H).attr(F);H.id=ka();ib().appendChild(H);g.setAttribute(z,"url(#"+H.id+")")}}}}var c="http://www.w3.org/2000/svg",e={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};u&&$.extend(e,u);var q=e.dimensions,b=this,h=l.ownerDocument,f=h.importNode(svgedit.utilities.text2xml('<svg id="svgroot" xmlns="'+c+'" xlinkns="http://www.w3.org/1999/xlink" width="'+q[0]+'" height="'+q[1]+'" x="'+q[0]+'" y="'+q[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,
true);l.appendChild(f);var n=h.createElementNS(c,"svg");(b.clearSvgContentElement=function(){for(;n.firstChild;)n.removeChild(n.firstChild);$(n).attr({id:"svgcontent",width:q[0],height:q[1],x:q[0],y:q[1],overflow:e.show_outside_canvas?"visible":"hidden",xmlns:c,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink"}).appendTo(f);var g=h.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");n.appendChild(g)})();var s="svg_";b.setIdPrefix=
function(g){s=g};b.current_drawing_=new svgedit.draw.Drawing(n,s);var A=b.getCurrentDrawing=function(){return b.current_drawing_},p=1,L=null,Q={shape:{fill:(e.initFill.color=="none"?"":"#")+e.initFill.color,fill_paint:null,fill_opacity:e.initFill.opacity,stroke:"#"+e.initStroke.color,stroke_paint:null,stroke_opacity:e.initStroke.opacity,stroke_width:e.initStroke.width,stroke_dasharray:"none",opacity:e.initOpacity}};Q.text=$.extend(true,{},Q.shape);$.extend(Q.text,{fill:"#000000",stroke_width:0,font_size:24,
font_family:"Helvetica, Arial, sans-serif"});var N=Q.shape,J=Array(1),P=this.addSvgElementFromJson=function(g){var k=svgedit.utilities.getElem(g.attr.id),m=A().getCurrentLayer();if(k&&g.element!=k.tagName){m.removeChild(k);k=null}if(!k){k=h.createElementNS(c,g.element);if(m)(L||m).appendChild(k)}g.curStyles&&svgedit.utilities.assignAttributes(k,{fill:N.fill,stroke:N.stroke,"stroke-width":N.stroke_width,"stroke-dasharray":N.stroke_dasharray,"stroke-opacity":N.stroke_opacity,"fill-opacity":N.fill_opacity,
opacity:N.opacity/2,style:"pointer-events:inherit"},100);svgedit.utilities.assignAttributes(k,g.attr,100);svgedit.utilities.cleanupElement(k);return k},U=b.getTransformList=svgedit.transformlist.getTransformList,O=svgedit.math.transformPoint,ha=b.matrixMultiply=svgedit.math.matrixMultiply,pa=b.hasMatrixTransform=svgedit.math.hasMatrixTransform,fa=b.transformListToTransform=svgedit.math.transformListToTransform,aa=svgedit.math.snapToAngle,W=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return e.baseUnit},
getElement:svgedit.utilities.getElem,getHeight:function(){return n.getAttribute("height")/p},getWidth:function(){return n.getAttribute("width")/p},getRoundDigits:function(){return db.round_digits}});var ra=b.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return h},getDOMContainer:function(){return l},getSVGRoot:function(){return f},getSelectedElements:function(){return J},getSVGContent:function(){return n}});var ja=b.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,
da=b.getHref=svgedit.utilities.getHref,V=b.setHref=svgedit.utilities.setHref,X=svgedit.utilities.getPathBBox;b.getBBox=svgedit.utilities.getBBox;var na=b.getRotationAngle=svgedit.utilities.getRotationAngle,qa=b.getElem=svgedit.utilities.getElem,la=b.assignAttributes=svgedit.utilities.assignAttributes,ma=this.cleanupElement=svgedit.utilities.cleanupElement,Ca=svgedit.sanitize.getNSMap(),Ga=b.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Ia=svgedit.history.MoveElementCommand,xa=svgedit.history.InsertElementCommand,
Ja=svgedit.history.RemoveElementCommand,Na=svgedit.history.ChangeElementCommand,ta=svgedit.history.BatchCommand;b.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(g,k){var m=svgedit.history.HistoryEventTypes;if(g==m.BEFORE_UNAPPLY||g==m.BEFORE_APPLY)b.clearSelection();else if(g==m.AFTER_APPLY||g==m.AFTER_UNAPPLY){var B=k.elements();b.pathActions.clear();M("changed",B);B=k.type();m=g==m.AFTER_APPLY;if(B==Ia.type())(m?k.newParent:k.oldParent)==n&&b.identifyLayers();else if(B==xa.type()||
B==Ja.type()){k.parent==n&&b.identifyLayers();if(B==xa.type())m&&Wa(k.elem);else m||Wa(k.elem);k.elem.tagName==="use"&&zb(k.elem)}else if(B==Na.type()){k.elem.tagName=="title"&&k.elem.parentNode.parentNode==n&&b.identifyLayers();m=m?k.newValues:k.oldValues;m.stdDeviation&&b.setBlurOffsets(k.elem.parentNode,m.stdDeviation)}}}});var wa=function(g){b.undoMgr.addCommandToHistory(g)};svgedit.select.init(e,{createSVGElement:function(g){return b.addSvgElementFromJson(g)},svgRoot:function(){return f},svgContent:function(){return n},
currentZoom:function(){return p},getStrokedBBox:function(g){return b.getStrokedBBox([g])}});var Ha=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return p},getSVGRoot:function(){return f}});svgedit.utilities.snapToGrid=function(g){var k=e.snappingStep,m=e.baseUnit;if(m!=="px")k*=svgedit.units.getTypeMap()[m];return g=Math.round(g/k)*k};var va=svgedit.utilities.snapToGrid,Va={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},ub=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],fb=$.data,Wa=function(g){var k=$(g).attr(ub),m;for(m in k){var B=k[m];if(B&&B.indexOf("url(")===0){B=ja(B).substr(1);if(!qa(B)){ib().appendChild(tb[B]);delete tb[B]}}}g=g.getElementsByTagName("*");if(g.length){k=0;for(m=g.length;k<m;k++)Wa(g[k])}},Ya={},Da=e.imgPath+"logo.png",ua=[],db={round_digits:5},Ka=false,Ua=
null,Ea="select",hb="none",qb={},Za=Q.text,$a=N,vb=null,sa=null,kb=[],gb={},tb={};b.clipBoard=[];var lb=this.runExtensions=function(g,k,m){var B=false;if(m)B=[];$.each(gb,function(z,H){if(g in H)if(m)B.push(H[g](k));else B=H[g](k)});return B};this.addExtension=function(g,k){if(g in gb)console.log('Cannot add extension "'+g+'", an extension by that name already exists"');else{var m=$.isFunction(k)?k($.extend(b.getPrivateMethods(),{svgroot:f,svgcontent:n,nonce:A().getNonce(),selectorManager:Ha})):k;
gb[g]=m;M("extension_added",m)}};var eb=this.round=function(g){return parseInt(g*p)/p},nb=this.getIntersectionList=function(g){if(sa==null)return null;var k=L||A().getCurrentLayer();kb.length||(kb=wb(k));var m=null;try{m=k.getIntersectionList(g,null)}catch(B){}if(m==null||typeof m.item!="function"){m=[];if(g)g=g;else{g=sa.getBBox();k={};for(var z in g)k[z]=g[z]/p;g=k}for(z=kb.length;z--;)g.width&&g.width&&svgedit.math.rectsIntersect(g,kb[z].bbox)&&m.push(kb[z].elem)}return m};getStrokedBBox=this.getStrokedBBox=
function(g){g||(g=rb());if(!g.length)return false;var k=function(I){try{var E=svgedit.utilities.getBBox(I),d=svgedit.utilities.getRotationAngle(I);if(d&&d%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(I))){d=false;if(["ellipse","path","line","polyline","polygon"].indexOf(I.tagName)>=0)E=d=b.convertToPath(I,true);else if(I.tagName=="rect"){var o=I.getAttribute("rx"),w=I.getAttribute("ry");if(o||w)E=d=b.convertToPath(I,true)}if(!d){var D=I.cloneNode(true),G=document.createElementNS(c,
"g"),K=I.parentNode;K.appendChild(G);G.appendChild(D);E=svgedit.utilities.bboxToObj(G.getBBox());K.removeChild(G)}}return E}catch(T){console.log(I,T)}},m;$.each(g,function(){if(!m)if(this.parentNode)m=k(this)});if(m==null)return null;var B=m.x+m.width,z=m.y+m.height,H=m.x,C=m.y,v=function(I){var E=I.getAttribute("stroke-width"),d=0;if(I.getAttribute("stroke")!="none"&&!isNaN(E))d+=E/2;return d},F=[];$.each(g,function(I,E){var d=k(E);if(d){var o=v(E);H=Math.min(H,d.x-o);C=Math.min(C,d.y-o);F.push(d)}});
m.x=H;m.y=C;$.each(g,function(I,E){var d=F[I];if(d&&E.nodeType==1){var o=v(E);B=Math.max(B,d.x+d.width+o);z=Math.max(z,d.y+d.height+o)}});m.width=B-H;m.height=z-C;return m};var rb=this.getVisibleElements=function(g){g||(g=$(n).children());g.find("#canvas_background").length&&g.splice(0,1);var k=[];$(g).children().each(function(m,B){try{B.getBBox()&&k.push(B)}catch(z){}});return k.reverse()},wb=this.getVisibleElementsAndBBoxes=function(g){g||(g=$(n).children());var k=[];$(g).children().each(function(m,
B){try{B.getBBox()&&k.push({elem:B,bbox:getStrokedBBox([B])})}catch(z){}});return k.reverse()},xb=this.groupSvgElem=function(g){var k=document.createElementNS(c,"g");g.parentNode.replaceChild(k,g);$(k).append(g).data("gsvg",g)[0].id=ka()},ia=function(g){var k=document.createElementNS(g.namespaceURI,g.nodeName);k.removeAttribute("id");$.each(g.attributes,function(B,z){z.localName!="-moz-math-font-style"&&k.setAttributeNS(z.namespaceURI,z.nodeName,z.nodeValue)});if(svgedit.browser.isWebkit()&&g.nodeName==
"path"){var m=Ma.convertPath(g);k.setAttribute("d",m)}$.each(g.childNodes,function(B,z){switch(z.nodeType){case 1:k.appendChild(ia(z));break;case 3:k.textContent=z.nodeValue}});if($(g).data("gsvg"))$(k).data("gsvg",k.firstChild);else if($(g).data("symbol")){g=$(g).data("symbol");$(k).data("ref",g).data("symbol",g)}else k.tagName=="image"&&Eb(k);k.id=ka();return k},ca,ka,M;(function(g){var k={};ca=g.getId=function(){return A().getId()};ka=g.getNextId=function(){return A().getNextId()};M=g.call=function(m,
B){if(k[m])return k[m](this,B)};g.bind=function(m,B){var z=k[m];k[m]=B;return z}})(b);this.prepareSvg=function(g){this.sanitizeSvg(g.documentElement);g=g.getElementsByTagNameNS(c,"path");for(var k=0,m=g.length;k<m;++k){var B=g[k];B.setAttribute("d",Ma.convertPath(B));Ma.fixEnd(B)}};var R=this.getRefElem=function(g){return qa(ja(g).substr(1))},ea=function(g){if(!svgedit.browser.isGecko())return g;var k=g.cloneNode(true);g.parentNode.insertBefore(k,g);g.parentNode.removeChild(g);Ha.releaseSelector(g);
J[0]=k;Ha.requestSelector(k).showGrips(true);return k};this.setRotationAngle=function(g,k){g=parseFloat(g);var m=J[0];if(m){var B=m.getAttribute("transform"),z=svgedit.utilities.getBBox(m),H=z.x+z.width/2,C=z.y+z.height/2;z=U(m);z.numberOfItems>0&&z.getItem(0).type==4&&z.removeItem(0);if(g!=0){H=O(H,C,fa(z).matrix);C=f.createSVGTransform();C.setRotate(g,H.x,H.y);z.numberOfItems?z.insertItemBefore(C,0):z.appendItem(C)}else z.numberOfItems==0&&m.removeAttribute("transform");if(!k){z=m.getAttribute("transform");
m.setAttribute("transform",B);jb("transform",z,J);M("changed",J)}qa("pathpointgrip_container");m=Ha.requestSelector(J[0]);m.resize();m.updateGripCursors(g)}};var Fa=this.recalculateAllSelectedDimensions=function(){for(var g=new ta(hb=="none"?"position":"size"),k=J.length;k--;){var m=Ta(J[k]);m&&g.addSubCommand(m)}if(!g.isEmpty()){wa(g);M("changed",J)}},Oa=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Sa=function(g){console.log([g.a,g.b,g.c,g.d,g.e,g.f])},cb=this.remapElement=
function(g,k,m){var B=e.gridSnapping&&g.parentNode.parentNode.localName==="svg",z=function(){if(B)for(var d in k)k[d]=va(k[d]);la(g,k,1E3,true)};box=svgedit.utilities.getBBox(g);for(var H=0;H<2;H++){var C=H===0?"fill":"stroke",v=g.getAttribute(C);if(v&&v.indexOf("url(")===0)if(m.a<0||m.d<0){v=R(v).cloneNode(true);if(m.a<0){var F=v.getAttribute("x1"),I=v.getAttribute("x2");v.setAttribute("x1",-(F-1));v.setAttribute("x2",-(I-1))}if(m.d<0){F=v.getAttribute("y1");I=v.getAttribute("y2");v.setAttribute("y1",
-(F-1));v.setAttribute("y2",-(I-1))}v.id=ka();ib().appendChild(v);g.setAttribute(C,"url(#"+v.id+")")}}H=g.tagName;if(H==="g"||H==="text"||H==="use")if(m.a==1&&m.b==0&&m.c==0&&m.d==1&&(m.e!=0||m.f!=0)){C=fa(g).matrix;C=ha(C.inverse(),m,C);k.x=parseFloat(k.x)+C.e;k.y=parseFloat(k.y)+C.f}else{C=U(g);v=f.createSVGTransform();v.setMatrix(ha(fa(C).matrix,m));C.clear();C.appendItem(v)}switch(H){case "foreignObject":case "rect":case "image":if(H==="image"&&(m.a<0||m.d<0)){C=U(g);v=f.createSVGTransform();
v.setMatrix(ha(fa(C).matrix,m));C.clear();C.appendItem(v)}else{C=O(k.x,k.y,m);k.width=m.a*k.width;k.height=m.d*k.height;k.x=C.x+Math.min(0,k.width);k.y=C.y+Math.min(0,k.height);k.width=Math.abs(k.width);k.height=Math.abs(k.height)}z();break;case "ellipse":H=O(k.cx,k.cy,m);k.cx=H.x;k.cy=H.y;k.rx=m.a*k.rx;k.ry=m.d*k.ry;k.rx=Math.abs(k.rx);k.ry=Math.abs(k.ry);z();break;case "circle":H=O(k.cx,k.cy,m);k.cx=H.x;k.cy=H.y;H=svgedit.math.transformBox(box.x,box.y,box.width,box.height,m);k.r=Math.min((H.tr.x-
H.tl.x)/2,(H.bl.y-H.tl.y)/2);if(k.r)k.r=Math.abs(k.r);z();break;case "line":C=O(k.x1,k.y1,m);F=O(k.x2,k.y2,m);k.x1=C.x;k.y1=C.y;k.x2=F.x;k.y2=F.y;case "text":m=g.querySelectorAll("tspan");for(H=m.length;H--;){C=ra("x",g.getAttribute("x"));v=ra("x",m[H].getAttribute("x"));F=ra("y",g.getAttribute("y"));I=ra("y",m[H].getAttribute("y"));var E={};if(!isNaN(C)&&!isNaN(v)&&C!=0&&v!=0&&k.x)E.x=k.x-(C-v);if(!isNaN(F)&&!isNaN(I)&&F!=0&&I!=0&&k.y)E.y=k.y-(F-I);if(E.x||E.y)la(m[H],E,1E3,true)}z();break;case "use":z();
break;case "g":(z=$(g).data("gsvg"))&&la(z,k,1E3,true);break;case "polyline":case "polygon":z=k.points.length;for(H=0;H<z;++H){I=k.points[H];I=O(I.x,I.y,m);k.points[H].x=I.x;k.points[H].y=I.y}z=k.points.length;m="";for(H=0;H<z;++H){I=k.points[H];m+=I.x+","+I.y+" "}g.setAttribute("points",m);break;case "path":C=g.pathSegList;z=C.numberOfItems;k.d=Array(z);for(H=0;H<z;++H){v=C.getItem(H);k.d[H]={type:v.pathSegType,x:v.x,y:v.y,x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,r1:v.r1,r2:v.r2,angle:v.angle,largeArcFlag:v.largeArcFlag,
sweepFlag:v.sweepFlag}}z=k.d.length;H=k.d[0];E=O(H.x,H.y,m);k.d[0].x=E.x;k.d[0].y=E.y;for(H=1;H<z;++H){v=k.d[H];C=v.type;if(C%2==0){I=O(v.x!=undefined?v.x:E.x,v.y!=undefined?v.y:E.y,m);C=O(v.x1,v.y1,m);F=O(v.x2,v.y2,m);v.x=I.x;v.y=I.y;v.x1=C.x;v.y1=C.y;v.x2=F.x;v.y2=F.y}else{v.x=m.a*v.x;v.y=m.d*v.y;v.x1=m.a*v.x1;v.y1=m.d*v.y1;v.x2=m.a*v.x2;v.y2=m.d*v.y2}v.r1=m.a*v.r1;v.r2=m.d*v.r2}m="";z=k.d.length;for(H=0;H<z;++H){v=k.d[H];C=v.type;m+=Oa[C];switch(C){case 13:case 12:m+=v.x+" ";break;case 15:case 14:m+=
v.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:m+=v.x+","+v.y+" ";break;case 7:case 6:m+=v.x1+","+v.y1+" "+v.x2+","+v.y2+" "+v.x+","+v.y+" ";break;case 9:case 8:m+=v.x1+","+v.y1+" "+v.x+","+v.y+" ";break;case 11:case 10:m+=v.r1+","+v.r2+" "+v.angle+" "+ +v.largeArcFlag+" "+ +v.sweepFlag+" "+v.x+","+v.y+" ";break;case 17:case 16:m+=v.x2+","+v.y2+" "+v.x+","+v.y+" "}}g.setAttribute("d",m)}},pb=function(g,k,m){g=R(g).firstChild;var B=U(g),z=f.createSVGTransform();z.setTranslate(k,m);B.appendItem(z);
Ta(g)},Ta=this.recalculateDimensions=function(g){if(g==null)return null;var k=U(g);if(k&&k.numberOfItems>0){for(var m=k.numberOfItems;m--;){var B=k.getItem(m);if(B.type===0)k.removeItem(m);else if(B.type===1)svgedit.math.isIdentity(B.matrix)&&k.removeItem(m);else B.type===4&&B.angle===0&&k.removeItem(m)}if(k.numberOfItems===1&&na(g))return null}if(!k||k.numberOfItems==0){g.removeAttribute("transform");return null}if(k){m=k.numberOfItems;for(var z=[];m--;){B=k.getItem(m);if(B.type===1)z.push([B.matrix,
m]);else if(z.length)z=[]}if(z.length===2){m=f.createSVGTransformFromMatrix(ha(z[1][0],z[0][0]));k.removeItem(z[0][1]);k.removeItem(z[1][1]);k.insertItemBefore(m,z[1][1])}m=k.numberOfItems;if(m>=2&&k.getItem(m-2).type===1&&k.getItem(m-1).type===2){z=f.createSVGTransform();B=ha(k.getItem(m-2).matrix,k.getItem(m-1).matrix);z.setMatrix(B);k.removeItem(m-2);k.removeItem(m-2);k.appendItem(z)}}switch(g.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(k.numberOfItems===1&&
k.getItem(0).type===1||k.numberOfItems===2&&k.getItem(0).type===1&&k.getItem(0).type===4)return null}var H=$(g).data("gsvg");m=new ta("Transform");var C={},v=null;B=[];switch(g.tagName){case "line":B=["x1","y1","x2","y2"];break;case "circle":B=["cx","cy","r"];break;case "ellipse":B=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":B=["width","height","x","y"];break;case "use":case "text":case "tspan":B=["x","y"];break;case "polygon":case "polyline":v={};v.points=g.getAttribute("points");
z=g.points;var F=z.numberOfItems;C.points=Array(F);for(var I=0;I<F;++I){var E=z.getItem(I);C.points[I]={x:E.x,y:E.y}}break;case "path":v={};v.d=g.getAttribute("d");C.d=g.getAttribute("d")}if(B.length){C=$(g).attr(B);$.each(C,function(ya,za){C[ya]=ra(ya,za)})}else if(H)C={x:$(H).attr("x")||0,y:$(H).attr("y")||0};if(v==null){v=$.extend(true,{},C);$.each(v,function(ya,za){v[ya]=ra(ya,za)})}v.transform=Ua?Ua:"";if(g.tagName=="g"&&!H||g.tagName=="a"){z=svgedit.utilities.getBBox(g);var d={x:z.x+z.width/
2,y:z.y+z.height/2},o=O(z.x+z.width/2,z.y+z.height/2,fa(k).matrix);B=f.createSVGMatrix();if(z=na(g)){I=z*Math.PI/180;F=Math.abs(I)>1.0E-10?Math.sin(I)/(1-Math.cos(I)):2/I;for(I=0;I<k.numberOfItems;++I){B=k.getItem(I);if(B.type==4){B=B.matrix;d.y=(F*B.e+B.f)/2;d.x=(B.e-F*B.f)/2;k.removeItem(I);break}}}I=B=H=0;var w=k.numberOfItems;if(w)var D=k.getItem(0).matrix;if(w>=3&&k.getItem(w-2).type==3&&k.getItem(w-3).type==2&&k.getItem(w-1).type==2){I=3;var G=k.getItem(w-3).matrix,K=k.getItem(w-2).matrix,T=
k.getItem(w-1).matrix;F=g.childNodes;for(E=F.length;E--;){var Y=F.item(E);B=H=0;if(Y.nodeType==1){var S=U(Y);if(S){B=fa(S).matrix;H=na(Y);var Z=Ua,ba=[];Ua=Y.getAttribute("transform");if(H||pa(S)){var oa=f.createSVGTransform();oa.setMatrix(ha(G,K,T,B));S.clear();S.appendItem(oa);ba.push(oa)}else{H=ha(B.inverse(),T,B);oa=f.createSVGMatrix();oa.e=-H.e;oa.f=-H.f;B=ha(oa.inverse(),B.inverse(),G,K,T,B,H.inverse());var Aa=f.createSVGTransform(),ga=f.createSVGTransform(),Ba=f.createSVGTransform();Aa.setTranslate(H.e,
H.f);ga.setScale(B.a,B.d);Ba.setTranslate(oa.e,oa.f);S.appendItem(Ba);S.appendItem(ga);S.appendItem(Aa);ba.push(Ba);ba.push(ga);ba.push(Aa)}m.addSubCommand(Ta(Y));Ua=Z}}}k.removeItem(w-1);k.removeItem(w-2);k.removeItem(w-3)}else if(w>=3&&k.getItem(w-1).type==1){I=3;B=fa(k).matrix;oa=f.createSVGTransform();oa.setMatrix(B);k.clear();k.appendItem(oa)}else if((w==1||w>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){I=2;H=fa(k).matrix;k.removeItem(0);B=fa(k).matrix.inverse();B=ha(B,H);H=B.e;B=B.f;if(H!=
0||B!=0){F=g.childNodes;E=F.length;for(w=[];E--;){Y=F.item(E);if(Y.nodeType==1){if(Y.getAttribute("clip-path")){Z=Y.getAttribute("clip-path");if(w.indexOf(Z)===-1){pb(Z,H,B);w.push(Z)}}Z=Ua;Ua=Y.getAttribute("transform");if(S=U(Y)){G=f.createSVGTransform();G.setTranslate(H,B);S.numberOfItems?S.insertItemBefore(G,0):S.appendItem(G);m.addSubCommand(Ta(Y));S=g.getElementsByTagNameNS(c,"use");Y="#"+Y.id;for(G=S.length;G--;){K=S.item(G);if(Y==da(K)){T=f.createSVGTransform();T.setTranslate(-H,-B);U(K).insertItemBefore(T,
0);m.addSubCommand(Ta(K))}}Ua=Z}}}w=[];Ua=Z}}else if(w==1&&k.getItem(0).type==1&&!z){I=1;B=k.getItem(0).matrix;F=g.childNodes;for(E=F.length;E--;){Y=F.item(E);if(Y.nodeType==1){Z=Ua;Ua=Y.getAttribute("transform");if(S=U(Y)){H=ha(B,fa(S).matrix);w=f.createSVGTransform();w.setMatrix(H);S.clear();S.appendItem(w,0);m.addSubCommand(Ta(Y));Ua=Z;Z=Y.getAttribute("stroke-width");Y.getAttribute("stroke")!=="none"&&!isNaN(Z)&&Y.setAttribute("stroke-width",Z*((Math.abs(H.a)+Math.abs(H.d))/2))}}}k.clear()}else{if(z){d=
f.createSVGTransform();d.setRotate(z,o.x,o.y);k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}k.numberOfItems==0&&g.removeAttribute("transform");return null}if(I==2){if(z){o={x:d.x+D.e,y:d.y+D.f};d=f.createSVGTransform();d.setRotate(z,o.x,o.y);k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}}else if(I==3){B=fa(k).matrix;D=f.createSVGTransform();D.setRotate(z,d.x,d.y);D=D.matrix;d=f.createSVGTransform();d.setRotate(z,o.x,o.y);o=d.matrix.inverse();Z=B.inverse();o=ha(Z,o,D,B);H=o.e;B=
o.f;if(H!=0||B!=0){F=g.childNodes;for(E=F.length;E--;){Y=F.item(E);if(Y.nodeType==1){Z=Ua;Ua=Y.getAttribute("transform");S=U(Y);G=f.createSVGTransform();G.setTranslate(H,B);S.numberOfItems?S.insertItemBefore(G,0):S.appendItem(G);m.addSubCommand(Ta(Y));Ua=Z}}}if(z)k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}}else{z=svgedit.utilities.getBBox(g);if(!z&&g.tagName!="path")return null;B=f.createSVGMatrix();if(H=na(g)){d={x:z.x+z.width/2,y:z.y+z.height/2};o=O(z.x+z.width/2,z.y+z.height/2,fa(k).matrix);
I=H*Math.PI/180;F=Math.abs(I)>1.0E-10?Math.sin(I)/(1-Math.cos(I)):2/I;for(I=0;I<k.numberOfItems;++I){B=k.getItem(I);if(B.type==4){B=B.matrix;d.y=(F*B.e+B.f)/2;d.x=(B.e-F*B.f)/2;k.removeItem(I);break}}}I=0;w=k.numberOfItems;if(!svgedit.browser.isWebkit())if((D=g.getAttribute("fill"))&&D.indexOf("url(")===0){D=R(D);Z="pattern";if(D.tagName!==Z)Z="gradient";if(D.getAttribute(Z+"Units")==="userSpaceOnUse"){B=fa(k).matrix;z=U(D);z=fa(z).matrix;B=ha(B,z);z="matrix("+[B.a,B.b,B.c,B.d,B.e,B.f].join(",")+
")";D.setAttribute(Z+"Transform",z)}}if(w>=3&&k.getItem(w-2).type==3&&k.getItem(w-3).type==2&&k.getItem(w-1).type==2){I=3;B=fa(k,w-3,w-1).matrix;k.removeItem(w-1);k.removeItem(w-2);k.removeItem(w-3)}else if(w==4&&k.getItem(w-1).type==1){I=3;B=fa(k).matrix;oa=f.createSVGTransform();oa.setMatrix(B);k.clear();k.appendItem(oa);B=f.createSVGMatrix()}else if((w==1||w>1&&k.getItem(1).type!=3)&&k.getItem(0).type==2){I=2;D=k.getItem(0).matrix;Z=fa(k,1).matrix;z=Z.inverse();B=ha(z,D,Z);k.removeItem(0)}else if(w==
1&&k.getItem(0).type==1&&!H){B=fa(k).matrix;switch(g.tagName){case "line":C=$(g).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":C.points=g.getAttribute("points");if(C.points){z=g.points;F=z.numberOfItems;C.points=Array(F);for(I=0;I<F;++I){E=z.getItem(I);C.points[I]={x:E.x,y:E.y}}}case "path":C.d=g.getAttribute("d");I=1;k.clear()}}else{I=4;if(H){d=f.createSVGTransform();d.setRotate(H,o.x,o.y);k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}k.numberOfItems==0&&g.removeAttribute("transform");
return null}if(I==1||I==2||I==3)cb(g,C,B);if(I==2){if(H){pa(k)||(o={x:d.x+B.e,y:d.y+B.f});d=f.createSVGTransform();d.setRotate(H,o.x,o.y);k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}}else if(I==3&&H){B=fa(k).matrix;D=f.createSVGTransform();D.setRotate(H,d.x,d.y);D=D.matrix;d=f.createSVGTransform();d.setRotate(H,o.x,o.y);o=d.matrix.inverse();Z=B.inverse();o=ha(Z,o,D,B);cb(g,C,o);if(H)k.numberOfItems?k.insertItemBefore(d,0):k.appendItem(d)}}k.numberOfItems==0&&g.removeAttribute("transform");
m.addSubCommand(new Na(g,v));return m},ob=null,Qa=this.clearSelection=function(g){if(J[0]!=null)for(var k=J.length,m=0;m<k;++m){var B=J[m];if(B==null)break;Ha.releaseSelector(B);J[m]=null}g||M("selected",J)},sb=this.addToSelection=function(g,k){if(g.length!=0){for(var m=0;m<J.length;){if(J[m]==null)break;++m}for(var B=g.length;B--;){var z=g[B];if(z&&svgedit.utilities.getBBox(z)){if(z.tagName==="a"&&z.childNodes.length===1)z=z.firstChild;if(J.indexOf(z)==-1){J[m]=z;m++;z=Ha.requestSelector(z);J.length>
1&&z.showGrips(false)}}}M("selected",J);k||J.length==1?Ha.requestSelector(J[0]).showGrips(true):Ha.requestSelector(J[0]).showGrips(false);for(J.sort(function(H,C){if(H&&C&&H.compareDocumentPosition)return 3-(C.compareDocumentPosition(H)&6);else if(H==null)return 1});J[0]==null;)J.shift(0)}},Ra=this.selectOnly=function(g,k){Qa(true);sb(g,k)};this.removeFromSelection=function(g){if(J[0]!=null)if(g.length!=0){var k=Array(J.length);j=0;len=J.length;for(var m=0;m<len;++m){var B=J[m];if(B)if(g.indexOf(B)==
-1){k[j]=B;j++}else Ha.releaseSelector(B)}J=k}};this.selectAllInCurrentLayer=function(){var g=A().getCurrentLayer();if(g){Ea="select";Ra($(L||g).children())}};var Fb=this.getMouseTarget=function(g){if(g==null||g.target==null)return null;g=g.target;if(g.correspondingUseElement)g=g.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(g.namespaceURI)>=0&&g.id!="svgcanvas")for(;g.nodeName!="foreignObject";){g=g.parentNode;if(!g)return f}var k=A().getCurrentLayer();
if([f,l,n,k].indexOf(g)>=0)return f;if($(g).closest("#selectorParentGroup").length)return Ha.selectorParentGroup;for(;g.parentNode&&g.parentNode!==(L||k);)g=g.parentNode;return g};(function(){var g=null,k=null,m=null,B=null,z=null,H={},C={minx:null,miny:null,maxx:null,maxy:null};$(l).mousedown(function(v){if(!b.spaceKey){var F=v.button===2;ob=n.getScreenCTM().inverse();isBotchedZoom=svgedit.browser.isGecko();var I=O(v.pageX,v.pageY,ob),E=I.x*(isBotchedZoom?1:p);I=I.y*(isBotchedZoom?1:p);v.preventDefault();
if(F)Ea="select";E=E/p;I=I/p;var d=Fb(v);if(d.tagName==="a"&&d.childNodes.length===1)d=d.firstChild;var o=B=k=E,w=z=m=I;if(e.gridSnapping){E=va(E);I=va(I);k=va(k);m=va(m)}if(d==Ha.selectorParentGroup&&J[0]!=null){d=v.target;var D=fb(d,"type");if(D=="rotate"){Ea="rotate";current_rotate_mode=fb(d,"dir")}else if(D=="resize"){Ea="resize";hb=fb(d,"dir")}d=J[0]}Ua=d.getAttribute("transform");D=U(d);switch(Ea){case "select":Ka=true;hb="none";if(F)Ka=false;if(d!=f){if(J.indexOf(d)==-1){v.shiftKey||Qa(true);
sb([d]);vb=d;Ma.clear()}if(!F)for(F=0;F<J.length;++F)if(J[F]!=null){var G=U(J[F]);G.numberOfItems?G.insertItemBefore(f.createSVGTransform(),0):G.appendItem(f.createSVGTransform())}}else if(!F){Qa();Ea="multiselect";if(sa==null)sa=Ha.getRubberBandBox();B*=p;z*=p;la(sa,{x:B,y:z,width:0,height:0,display:"inline"},100)}break;case "zoom":Ka=true;if(sa==null)sa=Ha.getRubberBandBox();la(sa,{x:o*p,y:o*p,width:0,height:0,display:"inline"},100);break;case "resize":Ka=true;k=E;m=I;H=svgedit.utilities.getBBox($("#selectedBox0")[0]);
var K={};$.each(H,function(T,Y){K[T]=Y/p});H=K;F=na(d)?1:0;if(pa(D)){D.insertItemBefore(f.createSVGTransform(),F);D.insertItemBefore(f.createSVGTransform(),F);D.insertItemBefore(f.createSVGTransform(),F)}else{D.appendItem(f.createSVGTransform());D.appendItem(f.createSVGTransform());D.appendItem(f.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(E=svgedit.browser.isWebkit())G=function(T){var Y=T.getAttributeNS(null,"stroke");T.removeAttributeNS(null,"stroke");setTimeout(function(){T.setAttributeNS(null,
"stroke",Y)},0)};d.style.vectorEffect="non-scaling-stroke";E&&G(d);I=d.getElementsByTagName("*");o=I.length;for(F=0;F<o;F++){I[F].style.vectorEffect="non-scaling-stroke";E&&G(I[F])}}}break;case "fhellipse":case "fhrect":case "fhpath":Ka=true;g=o+","+w+" ";G=N.stroke_width==0?1:N.stroke_width;P({element:"polyline",curStyles:true,attr:{points:g,id:ka(),fill:"none",opacity:N.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});C.minx=o;C.maxx=o;C.miny=w;C.maxy=w;break;case "image":Ka=true;
G=P({element:"image",attr:{x:E,y:I,width:0,height:0,id:ka(),opacity:N.opacity/2,style:"pointer-events:inherit"}});V(G,Da);Eb(G);break;case "square":case "rect":Ka=true;k=E;m=I;P({element:"rect",curStyles:true,attr:{x:E,y:I,width:0,height:0,id:ka(),opacity:N.opacity/2}});break;case "line":Ka=true;G=N.stroke_width==0?1:N.stroke_width;P({element:"line",curStyles:true,attr:{x1:E,y1:I,x2:E,y2:I,id:ka(),stroke:N.stroke,"stroke-width":G,"stroke-dasharray":N.stroke_dasharray,"stroke-linejoin":N.stroke_linejoin,
"stroke-linecap":N.stroke_linecap,"stroke-opacity":N.stroke_opacity,fill:"none",opacity:N.opacity/2,style:"pointer-events:none"}});break;case "circle":Ka=true;P({element:"circle",curStyles:true,attr:{cx:E,cy:I,r:0,id:ka(),opacity:N.opacity/2}});break;case "ellipse":Ka=true;P({element:"ellipse",curStyles:true,attr:{cx:E,cy:I,rx:0,ry:0,id:ka(),opacity:N.opacity/2}});break;case "text":Ka=true;P({element:"text",curStyles:true,attr:{x:E,y:I,id:ka(),fill:Za.fill,"stroke-width":Za.stroke_width,"font-size":Za.font_size,
"font-family":Za.font_family,"text-anchor":"left","xml:space":"preserve",opacity:N.opacity}});break;case "path":case "pathedit":k*=p;m*=p;Ma.mouseDown(v,d,k,m);Ka=true;break;case "textedit":k*=p;m*=p;bb.mouseDown(v,d,k,m);Ka=true;break;case "rotate":Ka=true;b.undoMgr.beginUndoableChange("transform",J);document.getElementById("workarea").className="rotate"}G=lb("mouseDown",{event:v,start_x:k,start_y:m,selectedElements:J},true);$.each(G,function(T,Y){if(Y&&Y.started)Ka=true});if(Ea)document.getElementById("workarea").className=
Ea=="resize"?v.target.style.cursor:Ea}}).mousemove(function(v){if(!(v.originalEvent.touches&&v.originalEvent.touches.length>1))if(Ka)if(!(v.button===1||b.spaceKey)){var F=J[0],I=O(v.pageX,v.pageY,ob),E=I.x*(isBotchedZoom?1:p);I=I.y*(isBotchedZoom?1:p);var d=qa(ca()),o=x=E/p,w=y=I/p;if(e.gridSnapping){x=va(x);y=va(y)}v.preventDefault();switch(Ea){case "select":if(J[0]!==null){o=x-k;var D=y-m;if(e.gridSnapping){o=va(o);D=va(D)}if(v.shiftKey){var G=aa(k,m,x,y);x=G.x;y=G.y}if(o!=0||D!=0){w=J.length;for(var K=
0;K<w;++K){F=J[K];if(F==null)break;var T=f.createSVGTransform();d=U(F);if(G){o=G.x-k;D=G.y-m}T.setTranslate(o,D);d.numberOfItems?d.replaceItem(T,0):d.appendItem(T);Ha.requestSelector(F).resize()}if(v.altKey)if(!b.addClones){b.addClones=b.cloneSelectedElements(0,0,T);b.removeClones=function(){b.addClones&&b.addClones.forEach(function(ga){ga.parentNode&&ga.parentNode.removeChild(ga);b.addClones=false})};window.addEventListener("keyup",b.removeClones)}M("transition",J)}}break;case "multiselect":o*=p;
w*=p;la(sa,{x:Math.min(B,o),y:Math.min(z,w),width:Math.abs(o-B),height:Math.abs(w-z)},100);d=[];o=[];G=nb();w=J.length;for(K=0;K<w;++K){D=G.indexOf(J[K]);if(D==-1)d.push(J[K]);else G[D]=null}w=G.length;for(K=0;K<w;++K)G[K]&&o.push(G[K]);d.length>0&&b.removeFromSelection(d);o.length>0&&sb(o);break;case "resize":d=U(F);o=(G=pa(d))?H:svgedit.utilities.getBBox(F);w=o.x;K=o.y;var Y=o.width,S=o.height;o=x-k;D=y-m;if(e.gridSnapping){o=va(o);D=va(D);S=va(S);Y=va(Y)}if(T=na(F)){var Z=Math.sqrt(o*o+D*D);D=
Math.atan2(D,o)-T*Math.PI/180;o=Z*Math.cos(D);D=Z*Math.sin(D)}if(hb.indexOf("n")==-1&&hb.indexOf("s")==-1)D=0;if(hb.indexOf("e")==-1&&hb.indexOf("w")==-1)o=0;var ba=Z=0,oa=S?(S+D)/S:1,Aa=Y?(Y+o)/Y:1;if(hb.indexOf("n")>=0){oa=S?(S-D)/S:1;ba=S}if(hb.indexOf("w")>=0){Aa=Y?(Y-o)/Y:1;Z=Y}o=f.createSVGTransform();D=f.createSVGTransform();Y=f.createSVGTransform();if(e.gridSnapping){w=va(w);Z=va(Z);K=va(K);ba=va(ba)}o.setTranslate(-(w+Z),-(K+ba));if(v.shiftKey)if(Aa==1)Aa=oa;else oa=Aa;D.setScale(Aa,oa);
Y.setTranslate(w+Z,K+ba);if(G){G=T?1:0;d.replaceItem(o,2+G);d.replaceItem(D,1+G);d.replaceItem(Y,0+G)}else{G=d.numberOfItems;d.replaceItem(Y,G-3);d.replaceItem(D,G-2);d.replaceItem(o,G-1)}Ha.requestSelector(F).resize();M("transition",J);break;case "zoom":o*=p;w*=p;la(sa,{x:Math.min(B*p,o),y:Math.min(z*p,w),width:Math.abs(o-B*p),height:Math.abs(w-z*p)},100);break;case "text":la(d,{x:x,y:y},1E3);break;case "line":o=null;window.opera||f.suspendRedraw(1E3);if(e.gridSnapping){x=va(x);y=va(y)}w=x;G=y;if(v.shiftKey){G=
aa(k,m,w,G);w=G.x;G=G.y}d.setAttributeNS(null,"x2",w);d.setAttributeNS(null,"y2",G);window.opera||f.unsuspendRedraw(o);break;case "foreignObject":case "square":case "rect":case "image":o=Math.abs(x-k);G=Math.abs(y-m);if(Ea=="square"||v.shiftKey){o=G=Math.max(o,G);w=k<x?k:k-o;K=m<y?m:m-G}else{w=Math.min(k,x);K=Math.min(m,y)}if(v.altKey){o*=2;G*=2;w=k-o/2;K=m-G/2}if(e.gridSnapping){o=va(o);G=va(G);w=va(w);K=va(K)}la(d,{width:o,height:G,x:w,y:K},1E3);break;case "circle":o=$(d).attr(["cx","cy"]);G=o.cx;
w=o.cy;o=Math.sqrt((x-G)*(x-G)+(y-w)*(y-w));if(e.gridSnapping)o=va(o);d.setAttributeNS(null,"r",o);break;case "ellipse":o=$(d).attr(["cx","cy"]);G=Math.abs(k+(x-k)/2);w=Math.abs(m+(y-m)/2);o=null;window.opera||f.suspendRedraw(1E3);if(e.gridSnapping){x=va(x);G=va(G);y=va(y);w=va(w)}K=Math.abs(k-G);D=Math.abs(m-w);if(v.shiftKey){D=K;w=y>m?m+K:m-K}if(v.altKey){G=k;w=m;K=Math.abs(x-G);D=v.shiftKey?K:Math.abs(y-w)}d.setAttributeNS(null,"rx",K);d.setAttributeNS(null,"ry",D);d.setAttributeNS(null,"cx",G);
d.setAttributeNS(null,"cy",w);window.opera||f.unsuspendRedraw(o);break;case "fhellipse":case "fhrect":C.minx=Math.min(o,C.minx);C.maxx=Math.max(o,C.maxx);C.miny=Math.min(w,C.miny);C.maxy=Math.max(w,C.maxy);case "fhpath":g+=+o+","+w+" ";d.setAttributeNS(null,"points",g);break;case "path":case "pathedit":x*=p;y*=p;if(e.gridSnapping){x=va(x);y=va(y);k=va(k);m=va(m)}if(v.shiftKey){if(G=svgedit.path.path){d=G.dragging?G.dragging[0]:k;G=G.dragging?G.dragging[1]:m}else{d=k;G=m}G=aa(d,G,x,y);x=G.x;y=G.y}if(sa&&
sa.getAttribute("display")!=="none"){o*=p;w*=p;la(sa,{x:Math.min(B*p,o),y:Math.min(z*p,w),width:Math.abs(o-B*p),height:Math.abs(w-z*p)},100)}Ma.mouseMove(v,x,y);break;case "textedit":x*=p;y*=p;bb.mouseMove(E,I);break;case "rotate":o=svgedit.utilities.getBBox(F);G=o.x+o.width/2;w=o.y+o.height/2;d=W(F);d=O(G,w,d);G=d.x;w=d.y;d=o.x;K=o.y;if(current_rotate_mode=="nw")d=o.x+o.width;if(current_rotate_mode=="se")K=o.y+o.height;if(current_rotate_mode=="sw"){d=o.x+o.width;K=o.y+o.height}compensation_angle=
(Math.atan2(w-K,G-d)*(180/Math.PI)-90)%360;T=(Math.atan2(w-y,G-x)*(180/Math.PI)-90)%360;T+=compensation_angle;if(e.gridSnapping)T=va(T);if(v.shiftKey)T=Math.round(T/45)*45;b.setRotationAngle(T<-180?360+T:T,true);M("transition",J)}lb("mouseMove",{event:v,mouse_x:E,mouse_y:I,selected:F})}}).click(function(v){v.preventDefault();return false}).dblclick(function(v){var F=v.target.parentNode,I=Fb(v),E=I.tagName;if(F!==L){if(E==="text"&&Ea!=="textedit"){v=O(v.pageX,v.pageY,ob);bb.select(I,v.x,v.y)}if((E===
"g"||E==="a")&&na(I)){Gb(I);I=J[0];Qa(true)}L&&Hb();F.tagName!=="g"&&F.tagName!=="a"||F===A().getCurrentLayer()||I===Ha.selectorParentGroup||Jb(I)}}).mouseup(function(v){b.addClones=false;window.removeEventListener("keyup",b.removeClones);J=J.filter(Boolean);if(v.button!==2){var F=vb;vb=null;if(Ka){var I=O(v.pageX,v.pageY,ob),E=I.x*p;I=I.y*p;var d=E/p,o=I/p,w=qa(ca()),D=false;Ka=false;switch(Ea){case "resize":case "multiselect":if(sa!=null){sa.setAttribute("display","none");kb=[]}Ea="select";case "select":if(J[0]!=
null){if(J.length==1){E=J[0];switch(E.tagName){case "g":case "use":case "image":case "foreignObject":break;default:$a.fill=E.getAttribute("fill");$a.fill_opacity=E.getAttribute("fill-opacity");$a.stroke=E.getAttribute("stroke");$a.stroke_opacity=E.getAttribute("stroke-opacity");$a.stroke_width=E.getAttribute("stroke-width");$a.stroke_dasharray=E.getAttribute("stroke-dasharray");$a.stroke_linejoin=E.getAttribute("stroke-linejoin");$a.stroke_linecap=E.getAttribute("stroke-linecap")}if(E.tagName=="text"){Za.font_size=
E.getAttribute("font-size");Za.font_family=E.getAttribute("font-family")}Ha.requestSelector(E).showGrips(true)}Fa();B=(E=svgedit.browser.isGecko())?B*p:B;z=E?z*p:z;E=Math.abs(o-z);if(E>1||E>1){v=J.length;for(E=0;E<v;++E){if(J[E]==null)break;J[E].firstChild||Ha.requestSelector(J[E]).resize()}}else{E=v.target;if(J[0].nodeName==="path"&&J[1]==null)Ma.select(J[0]);else v.shiftKey&&F!=E&&b.removeFromSelection([E])}if(svgedit.browser.supportsNonScalingStroke())if(v=J[0]){v.removeAttribute("style");svgedit.utilities.walkTree(v,
function(T){T.removeAttribute("style")})}}return;case "zoom":sa!=null&&sa.setAttribute("display","none");M("zoomed",{x:Math.min(B,d),y:Math.min(z,o),width:Math.abs(d-B),height:Math.abs(o-z),factor:v.altKey?0.5:2});return;case "fhpath":F=w.getAttribute("points");o=F.indexOf(",");if(D=o>=0?F.indexOf(",",o+1)>=0:F.indexOf(" ",F.indexOf(" ")+1)>=0)w=Ma.smoothPolylineIntoPath(w);break;case "line":F=$(w).attr(["x1","x2","y1","y2"]);D=F.x1!=F.x2||F.y1!=F.y2;break;case "foreignObject":case "square":case "rect":case "image":F=
$(w).attr(["width","height"]);D=F.width!=0||F.height!=0||Ea==="image";break;case "circle":D=w.getAttribute("r")!=0;break;case "ellipse":F=$(w).attr(["rx","ry"]);D=F.rx!=null||F.ry!=null;break;case "fhellipse":if(C.maxx-C.minx>0&&C.maxy-C.miny>0){w=P({element:"ellipse",curStyles:true,attr:{cx:(C.minx+C.maxx)/2,cy:(C.miny+C.maxy)/2,rx:(C.maxx-C.minx)/2,ry:(C.maxy-C.miny)/2,id:ca()}});M("changed",[w]);D=true}break;case "fhrect":if(C.maxx-C.minx>0&&C.maxy-C.miny>0){w=P({element:"rect",curStyles:true,
attr:{x:C.minx,y:C.miny,width:C.maxx-C.minx,height:C.maxy-C.miny,id:ca()}});M("changed",[w]);D=true}break;case "text":D=true;Ra([w]);bb.start(w);break;case "path":w=null;Ka=true;F=Ma.mouseUp(v,w,E,I);w=F.element;D=F.keep;break;case "pathedit":D=true;w=null;Ma.mouseUp(v);break;case "textedit":D=false;w=null;bb.mouseUp(v,E,I);break;case "rotate":D=true;w=null;Ea="select";F=b.undoMgr.finishUndoableChange();F.isEmpty()||wa(F);Fa();M("changed",J)}E=lb("mouseUp",{event:v,mouse_x:E,mouse_y:I},true);$.each(E,
function(T,Y){if(Y){D=Y.keep||D;w=Y.element;Ka=Y.started||Ka}});if(!D&&w!=null){A().releaseId(ca());w.parentNode.removeChild(w);w=null;for(E=v.target;E.parentNode.parentNode.tagName=="g";)E=E.parentNode;if((Ea!="path"||!drawn_path)&&E.parentNode.id!="selectorParentGroup"&&E.id!="svgcanvas"&&E.id!="svgroot"){b.setMode("select");Ra([E],true)}}else if(w!=null){b.addedNew=true;v=0.2;var G;if(false.beginElement&&w.getAttribute("opacity")!=N.opacity){G=$(false).clone().attr({to:N.opacity,dur:v}).appendTo(w);
try{G[0].beginElement()}catch(K){}}else v=0;setTimeout(function(){G&&G.remove();w.setAttribute("opacity",N.opacity);w.setAttribute("style","pointer-events:inherit");ma(w);if(Ea==="path")Ma.toEditMode(w);else e.selectNew&&Ra([w],true);wa(new xa(w));M("changed",[w])},v*1E3)}Ua=null}}});$(l).bind("mousewheel DOMMouseScroll",function(v){if(v.shiftKey){v.preventDefault();ob=n.getScreenCTM().inverse();var F=O(v.pageX,v.pageY,ob);F={x:F.x,y:F.y,width:0,height:0};if(v.wheelDelta)if(v.wheelDelta>=120)F.factor=
2;else{if(v.wheelDelta<=-120)F.factor=0.5}else if(v.detail)if(v.detail>0)F.factor=0.5;else if(v.detail<0)F.factor=2;F.factor&&M("zoomed",F)}})})();var Eb=function(g){$(g).click(function(k){k.preventDefault()})},bb=b.textActions=function(){function g(S){var Z=I.value==="";$(I).focus();if(!arguments.length)if(Z)S=0;else{if(I.selectionEnd!==I.selectionStart)return;S=I.selectionEnd}var ba;ba=w[S];Z||I.setSelectionRange(S,S);E=qa("text_cursor");if(!E){E=document.createElementNS(c,"line");la(E,{id:"text_cursor",
stroke:"#333","stroke-width":1});E=qa("selectorParentGroup").appendChild(E)}o||(o=setInterval(function(){var oa=E.getAttribute("display")==="none";E.setAttribute("display",oa?"inline":"none")},600));Z=H(ba.x,D.y);ba=H(ba.x,D.y+D.height);la(E,{x1:Z.x,y1:Z.y,x2:ba.x,y2:ba.y,visibility:"visible",display:"inline"});d&&d.setAttribute("d","M 0 0")}function k(S,Z,ba){if(S===Z)g(Z);else{ba||I.setSelectionRange(S,Z);d=qa("text_selectblock");if(!d){d=document.createElementNS(c,"path");la(d,{id:"text_selectblock",
fill:"green",opacity:0.5,style:"pointer-events:none"});qa("selectorParentGroup").appendChild(d)}S=w[S];var oa=w[Z];E.setAttribute("visibility","hidden");Z=H(S.x,D.y);ba=H(S.x+(oa.x-S.x),D.y);var Aa=H(S.x,D.y+D.height);S=H(S.x+(oa.x-S.x),D.y+D.height);la(d,{d:"M"+Z.x+","+Z.y+" L"+ba.x+","+ba.y+" "+S.x+","+S.y+" "+Aa.x+","+Aa.y+"z",display:"inline"})}}function m(S,Z){var ba=f.createSVGPoint();ba.x=S;ba.y=Z;if(w.length==1)return 0;ba=F.getCharNumAtPosition(ba);if(ba<0){ba=w.length-2;if(S<=w[0].x)ba=
0}else if(ba>=w.length-2)ba=w.length-2;var oa=w[ba];S>oa.x+oa.width/2&&ba++;return ba}function B(S,Z,ba){var oa=I.selectionStart;S=m(S,Z);k(Math.min(oa,S),Math.max(oa,S),!ba)}function z(S,Z){var ba={x:S,y:Z};ba.x/=p;ba.y/=p;if(G){var oa=O(ba.x,ba.y,G.inverse());ba.x=oa.x;ba.y=oa.y}return ba}function H(S,Z){var ba={x:S,y:Z};if(G){var oa=O(ba.x,ba.y,G);ba.x=oa.x;ba.y=oa.y}ba.x*=p;ba.y*=p;return ba}function C(S){k(0,F.textContent.length);$(this).unbind(S)}function v(S){if(Y&&F){var Z=O(S.pageX,S.pageY,
ob);Z=z(Z.x*p,Z.y*p);Z=m(Z.x,Z.y);var ba=F.textContent,oa=ba.substr(0,Z).replace(/[a-z0-9]+$/i,"").length;ba=ba.substr(Z).match(/^[a-z0-9]+/i);k(oa,(ba?ba[0].length:0)+Z);$(S.target).click(C);setTimeout(function(){$(S.target).unbind("click",C)},300)}}var F,I,E,d,o,w=[],D,G,K,T,Y;return{select:function(S,Z,ba){F=S;bb.toEditMode(Z,ba)},start:function(S){F=S;bb.toEditMode()},mouseDown:function(S,Z,ba,oa){S=z(ba,oa);I.focus();g(m(S.x,S.y));K=ba;T=oa},mouseMove:function(S,Z){var ba=z(S,Z);B(ba.x,ba.y)},
mouseUp:function(S,Z,ba){var oa=z(Z,ba);B(oa.x,oa.y,true);S.target!==F&&Z<K+2&&Z>K-2&&ba<T+2&&ba>T-2&&bb.toSelectMode(true)},setCursor:g,toEditMode:function(S,Z){Ra([F],false);Y=false;Ea="textedit";Ha.requestSelector(F).showGrips(false);Ha.requestSelector(F);bb.init();$(F).css("cursor","text");if(arguments.length){var ba=z(S,Z);g(m(ba.x,ba.y))}else g();setTimeout(function(){Y=true},300)},toSelectMode:function(S){Ea="select";clearInterval(o);o=null;d&&$(d).attr("display","none");E&&$(E).attr("visibility",
"hidden");$(F).css("cursor","move");if(S){Qa();$(F).css("cursor","move");M("selected",[F]);sb([F],true)}F&&!F.textContent.length&&b.deleteSelectedElements();$(I).blur();F=false},setInputElem:function(S){I=S},clear:function(){Ea=="textedit"&&bb.toSelectMode()},init:function(){if(F){if(!F.parentNode){F=J[0];Ha.requestSelector(F).showGrips(false)}var S=F.textContent.length,Z=F.getAttribute("transform");D=svgedit.utilities.getBBox(F);G=Z?W(F):null;w=Array(S);I.focus();$(F).unbind("dblclick",v).dblclick(v);
if(!S)var ba={x:D.x+D.width/2,width:0};for(Z=0;Z<S;Z++){var oa=F.getStartPositionOfChar(Z);ba=F.getEndPositionOfChar(Z);if(!svgedit.browser.supportsGoodTextCharPos()){var Aa=b.contentW*p;oa.x-=Aa;ba.x-=Aa;oa.x/=p;ba.x/=p}w[Z]={x:oa.x,y:D.y,width:ba.x-oa.x,height:D.height}}w.push({x:ba.x,width:0});k(I.selectionStart,I.selectionEnd,true)}}}}(),Ma=b.pathActions=function(){var g=false,k,m,B;svgedit.path.Path.prototype.endChanges=function(C){if(svgedit.browser.isWebkit()){var v=this.elem;v.setAttribute("d",
Ma.convertPath(v))}C=new Na(this.elem,{d:this.last_d},C);wa(C);M("changed",[this.elem])};svgedit.path.Path.prototype.addPtsToSelection=function(C){$.isArray(C)||(C=[C]);for(var v=0;v<C.length;v++){var F=C[v],I=this.segs[F];I.ptgrip&&this.selected_pts.indexOf(F)==-1&&F>=0&&this.selected_pts.push(F)}this.selected_pts.sort();v=this.selected_pts.length;for(C=Array(v);v--;){I=this.segs[this.selected_pts[v]];I.select(true);C[v]=I.ptgrip}Ma.canDeleteNodes=true;Ma.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);
M("selected",C)};var z=k=null,H=false;this.lastCtrlPoint=[0,0];return{mouseDown:function(C,v,F,I){if(Ea==="path"){mouse_x=F;mouse_y=I;F=mouse_x/p;v=mouse_y/p;I=qa("path_stretch_line");m=[F,v];if(e.gridSnapping){F=va(F);v=va(v);mouse_x=va(mouse_x);mouse_y=va(mouse_y)}if(!I){I=document.createElementNS(c,"path");la(I,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});I=qa("selectorParentGroup").appendChild(I)}I.setAttribute("display","inline");this.stretchy=I;var E=null;if(z){E=
z.pathSegList;for(var d=E.numberOfItems,o=6/p,w=false;d;){d--;var D=E.getItem(d),G=D.x;D=D.y;if(F>=G-o&&F<=G+o&&v>=D-o&&v<=D+o){w=true;break}}o=ca();svgedit.path.removePath_(o);o=qa(o);G=E.numberOfItems;if(w){if(d<=1&&G>=2){F=E.getItem(0).x;v=E.getItem(0).y;d=svgedit.path.first_grip?svgedit.path.first_grip[0]/p:E.getItem(0).x;w=svgedit.path.first_grip?svgedit.path.first_grip[1]/p:E.getItem(0).y;C=I.pathSegList.getItem(1);C=C.pathSegType===4?z.createSVGPathSegLinetoAbs(F,v):z.createSVGPathSegCurvetoCubicAbs(F,
v,C.x1/p,C.y1/p,d,w);F=z.createSVGPathSegClosePath();E.appendItem(C);E.appendItem(F)}else if(G<3)return E=false;$(I).remove();element=o;z=null;Ka=false;if(g){svgedit.path.path.matrix&&cb(o,{},svgedit.path.path.matrix.inverse());F=o.getAttribute("d");I=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",I+F);$(o).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();Ma.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(l,
Fb(C))){console.log("Clicked outside canvas");return false}E=z.pathSegList.numberOfItems;d=z.pathSegList.getItem(E-1);o=d.x;d=d.y;if(C.shiftKey){v=aa(o,d,F,v);F=v.x;v=v.y}C=I.pathSegList.getItem(1);C=C.pathSegType===4?z.createSVGPathSegLinetoAbs(eb(F),eb(v)):z.createSVGPathSegCurvetoCubicAbs(eb(F),eb(v),C.x1/p,C.y1/p,C.x2/p,C.y2/p);z.pathSegList.appendItem(C);F*=p;v*=p;I.setAttribute("d",["M",F,v,F,v].join(" "));I=svgedit.path.addCtrlGrip("1c1");C=svgedit.path.addCtrlGrip("0c2");o=svgedit.path.getCtrlLine(1);
d=svgedit.path.getCtrlLine(2);I.setAttribute("cx",F);I.setAttribute("cy",v);C.setAttribute("cx",F);C.setAttribute("cy",v);o.setAttribute("x1",F);o.setAttribute("x2",F);o.setAttribute("y1",v);o.setAttribute("y2",v);d.setAttribute("x1",F);d.setAttribute("x2",F);d.setAttribute("y1",v);d.setAttribute("y2",v);I=E;if(g)I+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(I,F,v)}E=true}else{d_attr="M"+F+","+v+" ";z=P({element:"path",curStyles:true,attr:{d:d_attr,id:ka(),opacity:N.opacity/2}});I.setAttribute("d",
["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));I=g?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(I,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();o=C.target.id;if(o.substr(0,14)=="pathpointgrip_"){v=svgedit.path.path.cur_pt=parseInt(o.substr(14));svgedit.path.path.dragging=[F,I];o=svgedit.path.path.segs[v];if(C.shiftKey)o.selected?svgedit.path.path.removePtFromSelection(v):svgedit.path.path.addPtsToSelection(v);else{if(svgedit.path.path.selected_pts.length<=
1||!o.selected)svgedit.path.path.clearSelection();svgedit.path.path.addPtsToSelection(v)}}else if(o.indexOf("ctrlpointgrip_")==0){svgedit.path.path.dragging=[F,I];C=o.split("_")[1].split("c");v=C[0]-0;E=C=C[1]-0;d=svgedit.path.path.segs[v];svgedit.path.path.selectPt(v,C);if(E==2){w=1;o=d.next}else{w=2;o=d.prev}if(!o)return;C=function(K,T){return Math.sqrt(Math.pow(K.x-T.x,2)+Math.pow(K.y-T.y,2))};v={x:d.item["x"+E],y:d.item["y"+E]};E=E==2?{x:d.item.x,y:d.item.y}:{x:o.item.x,y:o.item.y};d={x:o.item["x"+
w],y:o.item["y"+w]};o=C(v,E);C=C(d,E);v=Math.abs(Math.round(Math.atan2(v.y-E.y,v.x-E.x)*(180/Math.PI),0)-Math.round(Math.atan2(d.y-E.y,d.x-E.x)*(180/Math.PI),0))==180;if(Math.abs(o-C)<5&&v){svgedit.path.setLinkControlPoints(true);svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(sa==null)sa=Ha.getRubberBandBox();la(sa,{x:F*p,y:I*p,width:0,height:0,display:"inline"},100)}}},mouseMove:function(C,v,F){H=true;var I=
!C.altKey;if(Ea==="path"){if(z){var E=z.pathSegList,d=E.numberOfItems-1,o=svgedit.path.addCtrlGrip("1c1"),w=svgedit.path.addCtrlGrip("0c2");if(m){var D=w.getAttribute("cx")/p||0,G=w.getAttribute("cy")/p||0;o.setAttribute("cx",v);o.setAttribute("cy",F);o.setAttribute("display","inline");C=m[0];o=m[1];E.getItem(d);var K=v/p,T=F/p;D=I?C+(C-K):D;I=I?o+(o-T):G;w.setAttribute("cx",D*p);w.setAttribute("cy",I*p);w.setAttribute("display","inline");w=svgedit.path.getCtrlLine(1);G=svgedit.path.getCtrlLine(2);
la(w,{x1:v,y1:F,x2:C*p,y2:o*p,display:"inline"});la(G,{x1:D*p,y1:I*p,x2:C*p,y2:o*p,display:"inline"});if(d===0)B=[v,F];else{E=E.getItem(d-1);v=E.x;F=E.y;if(E.pathSegType===6){v+=v-E.x2;F+=F-E.y2}else if(B){v=B[0]/p;F=B[1]/p}svgedit.path.replacePathSeg(6,d,[C,o,this.lastCtrlPoint[0]/p,this.lastCtrlPoint[1]/p,D,I],z)}}else if(I=this.stretchy){d=E.getItem(d);E=v;o=F;if(C.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){E=svgedit.path.first_grip[0];o=svgedit.path.first_grip[1]}if(d.pathSegType===
6)svgedit.path.replacePathSeg(6,1,[v,F,(this.lastCtrlPoint[0]/p||d.x+(d.x-d.x2))*p,(this.lastCtrlPoint[1]/p||d.y+(d.y-d.y2))*p,E,o],I);else B?svgedit.path.replacePathSeg(6,1,[v,F,B[0],B[1],v,F],I):svgedit.path.replacePathSeg(4,1,[v,F],I)}}}else if(svgedit.path.path.dragging){E=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],y:svgedit.path.path.dragging[1]},svgedit.path.path);C=svgedit.path.getPointFromGrip({x:v,y:F},svgedit.path.path);d=C.x-E.x;E=C.y-E.y;svgedit.path.path.dragging=
[v,F];!I||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(d,E):svgedit.path.path.movePts(d,E)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||this.prev){var Y=sa.getBBox(),S=svgedit.path.getGripPt(this);Y=svgedit.math.rectsIntersect(Y,{x:S.x,y:S.y,width:0,height:0});this.select(Y);Y&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(C,
v,F,I){var E=qa("ctrlpointgrip_1c1"),d=qa("ctrlpointgrip_0c2");this.lastCtrlPoint=E?[E.getAttribute("cx"),E.getAttribute("cy")]:[F,I];if(!svgedit.path.first_grip&&d)svgedit.path.first_grip=[d.getAttribute("cx"),d.getAttribute("cy")];if(Ea==="path"){m=null;if(!z){v=qa(ca());Ka=false;B=null}return{keep:true,element:v}}if(svgedit.path.path.dragging){v=svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();H&&svgedit.path.path.endChanges("Move path point(s)");
!C.shiftKey&&!H&&svgedit.path.path.selectPt(v)}else if(sa&&sa.getAttribute("display")!="none"){sa.setAttribute("display","none");sa.getAttribute("width")<=2&&sa.getAttribute("height")<=2&&Ma.toSelectMode(C.target)}else Ma.toSelectMode(C.target);H=false},toEditMode:function(C){svgedit.path.path=svgedit.path.getPath_(C);Ea="pathedit";Qa();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);g=false},toSelectMode:function(C){var v=C==svgedit.path.path.elem;
Ea="select";svgedit.path.path.show(false);k=false;Qa();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();if(v){M("selected",[C]);sb([C],true)}},addSubPath:function(C){if(C){Ea="path";g=true}else{Ma.clear(true);Ma.toEditMode(svgedit.path.path.elem)}},select:function(C){if(k===C){Ma.toEditMode(C);Ea="pathedit"}else k=C},reorient:function(){var C=J[0];if(C)if(na(C)!=0){var v=new ta("Reorient path"),F={d:C.getAttribute("d"),transform:C.getAttribute("transform")};v.addSubCommand(new Na(C,F));
Qa();this.resetOrientation(C);wa(v);svgedit.path.getPath_(C).show(false).matrix=null;this.clear();sb([C],true);M("changed",J)}},clear:function(C){k=null;if(z){var v=qa(ca());$(qa("path_stretch_line")).remove();C&&$(v).remove();$(qa("pathpointgrip_container")).find("*").attr("display","none");z=B=null;Ka=false}else Ea=="pathedit"&&this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(C){if(C==null||C.nodeName!="path")return false;var v=U(C),F=fa(v).matrix;
v.clear();C.removeAttribute("transform");v=C.pathSegList;for(var I=v.numberOfItems,E=0;E<I;++E){var d=v.getItem(E),o=d.pathSegType;if(o!=1){var w=[];$.each(["",1,2],function(D,G){var K=d["x"+G],T=d["y"+G];if(K!==undefined&&T!==undefined){K=O(K,T,F);w.splice(w.length,0,K.x,K.y)}});svgedit.path.replacePathSeg(o,E,w,C)}}a(C,F)},zoomChange:function(){Ea=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var C=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?
svgedit.path.path.selected_pts[0]:1];return{x:C.item.x,y:C.item.y,type:C.type}}},linkControlPoints:function(C){svgedit.path.setLinkControlPoints(C)},clonePathNode:function(){svgedit.path.path.storeD();for(var C=svgedit.path.path.selected_pts,v=C.length,F=[];v--;){var I=C[v];svgedit.path.path.addSeg(I);F.push(I+v);F.push(I+v+1)}svgedit.path.path.init().addPtsToSelection(F);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var C=svgedit.path.path.selected_pts;if(C.length===
1){var v=svgedit.path.path.elem,F=v.pathSegList,I=C[0],E=null,d=null;svgedit.path.path.eachSeg(function(G){if(this.type===2&&G<=I)d=this.item;if(G<=I)return true;if(this.type===2){E=G;return false}else if(this.type===1)return E=false});if(E==null)E=svgedit.path.path.segs.length-1;if(E!==false){var o=v.createSVGPathSegLinetoAbs(d.x,d.y),w=v.createSVGPathSegClosePath();if(E==svgedit.path.path.segs.length){F.appendItem(o);F.appendItem(w)}else{svgedit.path.insertItemBefore(v,w,E);svgedit.path.insertItemBefore(v,
o,E)}svgedit.path.path.init().selectPt(E+1)}else if(svgedit.path.path.segs[I].mate){F.removeItem(I);F.removeItem(I);svgedit.path.path.init().selectPt(I-1)}else{for(C=0;C<F.numberOfItems;C++){var D=F.getItem(C);if(D.pathSegType===2)o=C;else if(C===I)F.removeItem(o);else if(D.pathSegType===1&&I<C){w=C-1;F.removeItem(C);break}}for(C=I-o-1;C--;)svgedit.path.insertItemBefore(v,F.getItem(o),w);v=F.getItem(o);svgedit.path.replacePathSeg(2,o,[v.x,v.y]);C=I;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(Ma.canDeleteNodes){svgedit.path.path.storeD();
for(var C=svgedit.path.path.selected_pts,v=C.length;v--;)svgedit.path.path.deleteSeg(C[v]);var F=function(){var I=svgedit.path.path.elem.pathSegList,E=I.numberOfItems,d=function(D,G){for(;G--;)I.removeItem(D)};if(E<=1)return true;for(;E--;){var o=I.getItem(E);if(o.pathSegType===1){o=I.getItem(E-1);var w=I.getItem(E-2);if(o.pathSegType===2){d(E-1,2);F();break}else if(w.pathSegType===2){d(E-2,3);F();break}}else if(o.pathSegType===2)if(E>0){o=I.getItem(E-1).pathSegType;if(o===2){d(E-1,1);F();break}else if(o===
1&&I.numberOfItems-1===E){d(E,1);F();break}}}return false};F();if(svgedit.path.path.elem.pathSegList.numberOfItems<=1){b.setMode("select");b.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();if(window.opera){C=$(svgedit.path.path.elem);C.attr("d",C.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(C){var v=C.points,F=v.numberOfItems;if(F>=4){var I=v.getItem(0),E=null;C=[];C.push(["M",I.x,",",I.y," C"].join(""));
for(var d=1;d<=F-4;d+=3){var o=v.getItem(d),w=v.getItem(d+1),D=v.getItem(d+2);if(E)if((I=svgedit.path.smoothControlPoints(E,o,I))&&I.length==2){o=C[C.length-1].split(",");o[2]=I[0].x;o[3]=I[0].y;C[C.length-1]=o.join(",");o=I[1]}C.push([o.x,o.y,w.x,w.y,D.x,D.y].join(","));I=D;E=w}for(C.push("L");d<F;++d){w=v.getItem(d);C.push([w.x,w.y].join(","))}C=C.join(" ");C=P({element:"path",curStyles:true,attr:{id:ca(),d:C,fill:"none"}})}return C},setSegType:function(C){svgedit.path.path.setSegType(C)},moveNode:function(C,
v){var F=svgedit.path.path.selected_pts;if(F.length){svgedit.path.path.storeD();F=svgedit.path.path.segs[F[0]];var I={x:0,y:0};I[C]=v-F.item[C];F.move(I.x,I.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(C){for(var v=C.pathSegList,F=v.numberOfItems,I,E=0;E<F;++E){var d=v.getItem(E);if(d.pathSegType===2)I=d;if(d.pathSegType===1){d=v.getItem(E-1);if(d.x!=I.x||d.y!=I.y){v=C.createSVGPathSegLinetoAbs(I.x,I.y);svgedit.path.insertItemBefore(C,v,E);Ma.fixEnd(C);break}}}svgedit.browser.isWebkit()&&
C.setAttribute("d",Ma.convertPath(C))},convertPath:function(C,v){for(var F=C.pathSegList,I=F.numberOfItems,E=0,d=0,o="",w=null,D=0;D<I;++D){var G=F.getItem(D),K=G.x||0,T=G.y||0,Y=G.x1||0,S=G.y1||0,Z=G.x2||0,ba=G.y2||0,oa=G.pathSegType,Aa=Oa[oa]["to"+(v?"Lower":"Upper")+"Case"](),ga=function(Ba,ya,za){ya=ya?" "+ya.join(" "):"";za=za?" "+svgedit.units.shortFloat(za):"";$.each(Ba,function(La,ab){Ba[La]=svgedit.units.shortFloat(ab)});o+=Aa+Ba.join(" ")+ya+za};switch(oa){case 1:o+="z";break;case 12:K-=
E;case 13:if(v){E+=K;Aa="l"}else{K+=E;E=K;Aa="L"}ga([[K,d]]);break;case 14:T-=d;case 15:if(v){d+=T;Aa="l"}else{T+=d;d=T;Aa="L"}ga([[E,T]]);break;case 2:case 4:case 18:K-=E;T-=d;case 5:case 3:if(w&&F.getItem(D-1).pathSegType===1&&!v){E=w[0];d=w[1]}case 19:if(v){E+=K;d+=T}else{K+=E;T+=d;E=K;d=T}if(oa===3)w=[E,d];ga([[K,T]]);break;case 6:K-=E;Y-=E;Z-=E;T-=d;S-=d;ba-=d;case 7:if(v){E+=K;d+=T}else{K+=E;Y+=E;Z+=E;T+=d;S+=d;ba+=d;E=K;d=T}ga([[Y,S],[Z,ba],[K,T]]);break;case 8:K-=E;Y-=E;T-=d;S-=d;case 9:if(v){E+=
K;d+=T}else{K+=E;Y+=E;T+=d;S+=d;E=K;d=T}ga([[Y,S],[K,T]]);break;case 10:K-=E;T-=d;case 11:if(v){E+=K;d+=T}else{K+=E;T+=d;E=K;d=T}ga([[G.r1,G.r2]],[G.angle,G.largeArcFlag?1:0,G.sweepFlag?1:0],[K,T]);break;case 16:K-=E;Z-=E;T-=d;ba-=d;case 17:if(v){E+=K;d+=T}else{K+=E;Z+=E;T+=d;ba+=d;E=K;d=T}ga([[Z,ba],[K,T]])}}return o}}}(),Ob=this.removeUnusedDefElems=function(){var g=n.getElementsByTagNameNS(c,"defs");if(!g||!g.length)return 0;for(var k=[],m=0,B=["fill","stroke","filter","marker-start","marker-mid",
"marker-end"],z=B.length,H=n.getElementsByTagNameNS(c,"*"),C=H.length,v=0;v<C;v++){for(var F=H[v],I=0;I<z;I++)if(F){var E=ja(F.getAttribute(B[I]));E&&k.push(E.substr(1))}(F=da(F))&&F.indexOf("#")===0&&k.push(F.substr(1))}g=$(g).find("linearGradient, radialGradient, filter, marker, svg, symbol");defelem_ids=[];for(v=g.length;v--;){B=g[v];z=B.id;if(k.indexOf(z)<0){tb[z]=B;B.parentNode.removeChild(B);m++}}return m};this.svgCanvasToString=function(){for(;Ob()>0;);Ma.clear(true);$.each(n.childNodes,function(m,
B){m&&B.nodeType===8&&B.data.indexOf("Created with")>=0&&n.insertBefore(B,n.firstChild)});if(L){Hb();Ra([L])}$("#canvasGrid").attr("display","none");var g=[];$(n).find("g:data(gsvg)").each(function(){for(var m=this.attributes,B=m.length,z=0;z<B;z++)if(m[z].nodeName=="id"||m[z].nodeName=="style")B--;if(B<=0){m=this.firstChild;g.push(m);$(this).replaceWith(m)}});var k=this.svgToString(n,0);g.length&&$(g).each(function(){xb(this)});return k};this.svgToString=function(g,k){var m=[],B=svgedit.utilities.toXml,
z=e.baseUnit,H=RegExp("^-?[\\d\\.]+"+z+"$");if(g){ma(g);var C=g.attributes,v,F,I=g.childNodes;for(F=0;F<k;F++)m.push(" ");m.push("<");m.push(g.nodeName);if(g.id==="svgcontent"){F=Ab();if(z!=="px"){F.w=svgedit.units.convertUnit(F.w,z)+z;F.h=svgedit.units.convertUnit(F.h,z)+z}m.push(' width="'+F.w+'" height="'+F.h+'" xmlns="'+c+'"');var E={};$(g).find("*").andSelf().each(function(){$.each(this.attributes,function(D,G){var K=G.namespaceURI;if(K&&!E[K]&&Ca[K]!=="xmlns"&&Ca[K]!=="xml"){E[K]=true;m.push(" xmlns:"+
Ca[K]+'="'+K+'"')}})});F=C.length;for(z=["width","height","xmlns","x","y","viewBox","id","overflow"];F--;){v=C.item(F);var d=B(v.nodeValue);if(v.nodeName.indexOf("xmlns:")!==0)if(d!=""&&z.indexOf(v.localName)==-1)if(!v.namespaceURI||Ca[v.namespaceURI]){m.push(" ");m.push(v.nodeName);m.push('="');m.push(d);m.push('"')}}}else{if(g.nodeName==="defs"&&!g.firstChild)return;var o=["-moz-math-font-style","_moz-math-font-style"];for(F=C.length-1;F>=0;F--){v=C.item(F);d=B(v.nodeValue);if(!(o.indexOf(v.localName)>=
0))if(d!="")if(d.indexOf("pointer-events")!==0)if(!(v.localName==="class"&&d.indexOf("se_")===0)){m.push(" ");if(v.localName==="d")d=Ma.convertPath(g,true);if(isNaN(d)){if(H.test(d))d=svgedit.units.shortFloat(d)+z}else d=svgedit.units.shortFloat(d);if(db.apply&&g.nodeName==="image"&&v.localName==="href"&&db.images&&db.images==="embed"){var w=Ya[d];if(w)d=w}if(!v.namespaceURI||v.namespaceURI==c||Ca[v.namespaceURI]){m.push(v.nodeName);m.push('="');m.push(d);m.push('"')}}}}if(g.hasChildNodes()){m.push(">");
k++;C=false;for(F=0;F<I.length;F++){z=I.item(F);switch(z.nodeType){case 1:m.push("\n");m.push(this.svgToString(I.item(F),k));break;case 3:z=z.nodeValue.replace(/^\s+|\s+$/g,"");if(z!=""){C=true;m.push(B(z)+"")}break;case 4:m.push("\n");m.push(Array(k+1).join(" "));m.push("<![CDATA[");m.push(z.nodeValue);m.push("]]\>");break;case 8:m.push("\n");m.push(Array(k+1).join(" "));m.push("<!--");m.push(z.data);m.push("--\>")}}k--;if(!C){m.push("\n");for(F=0;F<k;F++)m.push(" ")}m.push("</");m.push(g.nodeName);
m.push(">")}else m.push("/>")}return m.join("")};this.embedImage=function(g,k){$(new Image).load(function(){var m=document.createElement("canvas");m.width=this.width;m.height=this.height;m.getContext("2d").drawImage(this,0,0);try{var B=";svgedit_url="+encodeURIComponent(g);B=m.toDataURL().replace(";base64",B+";base64");Ya[g]=B}catch(z){Ya[g]=false}Da=g;k&&k(Ya[g])}).attr("src",g)};this.setGoodImage=function(g){Da=g};this.open=function(){};this.save=function(g){Qa();g&&$.extend(db,g);db.apply=true;
g=this.svgCanvasToString();M("saved",g)};this.rasterExport=function(){Qa();var g=[],k={feGaussianBlur:Va.exportNoBlur,foreignObject:Va.exportNoforeignObject,"[stroke-dasharray]":Va.exportNoDashArray},m=$(n);if(!("font"in $("<canvas>")[0].getContext("2d")))k.text=Va.exportNoText;$.each(k,function(B,z){m.find(B).length&&g.push(z)});k=this.svgCanvasToString();M("exported",{svg:k,issues:g})};this.getSvgString=function(){db.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>
0&&arguments[0]==false?svgedit.draw.randomizeIds(false,A()):svgedit.draw.randomizeIds(true,A())};var Kb=this.uniquifyElems=function(g){var k={},m=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];svgedit.utilities.walkTree(g,function(v){if(v.nodeType==1){if(v.id){v.id in k||(k[v.id]={elem:null,attrs:[],hrefs:[]});k[v.id].elem=v}$.each(ub,function(I,E){var d=v.getAttributeNode(E);if(d){var o=svgedit.utilities.getUrlFromAttr(d.value);if(o=o?o.substr(1):null){o in k||(k[o]=
{elem:null,attrs:[],hrefs:[]});k[o].attrs.push(d)}}});var F=svgedit.utilities.getHref(v);if(F&&m.indexOf(v.nodeName)>=0)if(F=F.substr(1)){F in k||(k[F]={elem:null,attrs:[],hrefs:[]});k[F].hrefs.push(v)}}});for(var B in k)if(B){var z=k[B].elem;if(z){g=ka();z.id=g;z=k[B].attrs;for(var H=z.length;H--;){var C=z[H];C.ownerElement.setAttribute(C.name,"url(#"+g+")")}z=k[B].hrefs;for(H=z.length;H--;)svgedit.utilities.setHref(z[H],"#"+g)}}},zb=this.setUseData=function(g){var k=$(g);if(g.tagName!=="use")k=
k.find("use");k.each(function(){var m=da(this).substr(1);if(m=qa(m)){$(this).data("ref",m);if(m.tagName=="symbol"||m.tagName=="svg")$(this).data("symbol",m).data("ref",m)}})},Lb=this.convertGradients=function(g){var k=$(g).find("linearGradient, radialGradient");if(!k.length&&svgedit.browser.isWebkit())k=$(g).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});k.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var m=$(n).find('[fill="url(#'+this.id+')"],[stroke="url(#'+
this.id+')"]');if(m.length)if(m=svgedit.utilities.getBBox(m[0]))if(this.tagName==="linearGradient"){var B=$(this).attr(["x1","y1","x2","y2"]),z=this.gradientTransform.baseVal;if(z&&z.numberOfItems>0){var H=fa(z).matrix;z=O(B.x1,B.y1,H);H=O(B.x2,B.y2,H);B.x1=z.x;B.y1=z.y;B.x2=H.x;B.y2=H.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(B.x1-m.x)/m.width,y1:(B.y1-m.y)/m.height,x2:(B.x2-m.x)/m.width,y2:(B.y2-m.y)/m.height});this.removeAttribute("gradientUnits")}}})},Pb=this.convertToGroup=
function(g){g||(g=J[0]);var k=$(g),m=new ta,B;if(k.data("gsvg")){m=$(g.firstChild).attr(["x","y"]);$(g.firstChild.firstChild).unwrap();$(g).removeData("gsvg");B=U(g);var z=f.createSVGTransform();z.setTranslate(m.x,m.y);B.appendItem(z);Ta(g);M("selected",[g])}else if(k.data("symbol")){g=k.data("symbol");B=k.attr("transform");z=k.attr(["x","y"]);var H=g.getAttribute("viewBox");if(H){H=H.split(" ");z.x-=+H[0];z.y-=+H[1]}B+=" translate("+(z.x||0)+","+(z.y||0)+")";z=k.prev();m.addSubCommand(new Ja(k[0],
k[0].nextSibling,k[0].parentNode));k.remove();H=$(n).find("use:data(symbol)").length;k=h.createElementNS(c,"g");for(var C=g.childNodes,v=0;v<C.length;v++)k.appendChild(C[v].cloneNode(true));if(svgedit.browser.isGecko()){C=$(ib()).children("linearGradient,radialGradient,pattern").clone();$(k).append(C)}B&&k.setAttribute("transform",B);B=g.parentNode;Kb(k);svgedit.browser.isGecko()&&$(ib()).append($(k).find("linearGradient,radialGradient,pattern"));k.id=ka();z.after(k);if(B){if(!H){z=g.nextSibling;
B.removeChild(g);m.addSubCommand(new Ja(g,z,B))}m.addSubCommand(new xa(k))}zb(k);svgedit.browser.isGecko()?Lb(ib()):Lb(k);svgedit.utilities.walkTreePost(k,function(F){try{Ta(F)}catch(I){console.log(I)}});$(k).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=ka()});Ra([k]);(g=Gb(k,true))&&m.addSubCommand(g);wa(m)}else console.log("Unexpected element to ungroup:",g)};this.setSvgString=function(g){try{var k=svgedit.utilities.text2xml(g);
this.prepareSvg(k);var m=new ta("Change Source"),B=n.nextSibling,z=f.removeChild(n);m.addSubCommand(new Ja(z,B,f));n=h.adoptNode?h.adoptNode(k.documentElement):h.importNode(k.documentElement,true);f.appendChild(n);var H=$(n);b.current_drawing_=new svgedit.draw.Drawing(n,s);var C=A().getNonce();C?M("setnonce",C):M("unsetnonce");H.find("image").each(function(){var G=this;Eb(G);var K=da(this);if(K.indexOf("data:")===0){var T=K.match(/svgedit_url=(.*?);/);if(T){var Y=decodeURIComponent(T[1]);$(new Image).load(function(){G.setAttributeNS("http://www.w3.org/1999/xlink",
"xlink:href",Y)}).attr("src",Y)}}b.embedImage(K)});H.find("svg").each(function(){if(!$(this).closest("defs").length){Kb(this);var G=this.parentNode;if(G.childNodes.length===1&&G.nodeName==="g"){$(G).data("gsvg",this);G.id=G.id||ka()}else xb(this)}});H.find("linearGradient, radialGradient, pattern").appendTo(ib());zb(H);Lb(H[0]);svgedit.utilities.walkTreePost(n,function(G){try{Ta(G)}catch(K){console.log(K)}});var v={id:"svgcontent",overflow:e.show_outside_canvas?"visible":"hidden"},F=false;if(H.attr("viewBox")){var I=
H.attr("viewBox").split(" ");v.width=I[2];v.height=I[3]}else $.each(["width","height"],function(G,K){var T=H.attr(K);T||(T="100%");if((T+"").substr(-1)==="%")F=true;else v[K]=ra(K,T)});Bb();H.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=ka()});if(F){var E=getStrokedBBox();v.width=E.width+E.x;v.height=E.height+E.y}if(v.width<=0)v.width=200;if(v.height<=0)v.height=200;H.attr(v);this.contentW=v.width;
this.contentH=v.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var d=$("#canvas_background");if(d.length){var o=d.attr("fill-opacity");o=o?parseInt(o)*100:100;fill=this.getPaint(d.attr("fill"),o,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);m.addSubCommand(new xa(n));var w=H.attr(["width","height"]);m.addSubCommand(new Na(f,w));p=1;svgedit.transformlist.resetListMap();Qa();svgedit.path.clearData();f.appendChild(Ha.selectorParentGroup);
wa(m);M("changed",[n])}catch(D){console.log(D);return false}return true};this.getPaint=function(g,k,m){var B=null;if(g.indexOf("url(#")===0){g=(g=svgCanvas.getRefElem(g))?g.cloneNode(true):$("#"+m+"_color defs *")[0];B={alpha:k};B[g.tagName]=g}else B=g.indexOf("#")===0?{alpha:k,solidColor:g.substr(1)}:{alpha:k,solidColor:"none"};return new $.jGraduate.Paint(B)};this.importSvgString=function(g){try{var k=svgedit.utilities.encode64(g.length+g).substr(0,32),m=false;if(qb[k])if($(qb[k].symbol).parents("#svgroot").length)m=
true;var B=new ta("Import SVG");if(m)var z=qb[k].symbol,H=qb[k].xform;else{var C=svgedit.utilities.text2xml(g);this.prepareSvg(C);var v;v=h.adoptNode?h.adoptNode(C.documentElement):h.importNode(C.documentElement,true);Kb(v);var F=ra("width",v.getAttribute("width")),I=ra("height",v.getAttribute("height")),E=v.getAttribute("viewBox"),d=E?E.split(" "):[0,0,F,I];for(g=0;g<4;++g)d[g]=+d[g];n.getAttribute("width");var o=+n.getAttribute("height");H=I>F?"scale("+o/3/d[3]+")":"scale("+o/3/d[2]+")";H="translate(0) "+
H+" translate(0)";z=h.createElementNS(c,"symbol");var w=ib();for(svgedit.browser.isGecko()&&$(v).find("linearGradient, radialGradient, pattern").appendTo(w);v.firstChild;)z.appendChild(v.firstChild);var D=v.attributes;for(v=0;v<D.length;v++){var G=D[v];z.setAttribute(G.nodeName,G.nodeValue)}z.id=ka();qb[k]={symbol:z,xform:H};ib().appendChild(z);B.addSubCommand(new xa(z))}var K=h.createElementNS(c,"use");K.id=ka();V(K,"#"+z.id);(L||A().getCurrentLayer()).appendChild(K);B.addSubCommand(new xa(K));Qa();
K.setAttribute("transform",H);Ta(K);$(K).data("symbol",z).data("ref",z);sb([K]);wa(B);M("changed",[n])}catch(T){console.log(T);return false}return true};var Bb=b.identifyLayers=function(){Hb();A().identifyLayers()};this.createLayer=function(g){var k=new ta("Create Layer");g=A().createLayer(g);k.addSubCommand(new xa(g));wa(k);Qa();M("changed",[g])};this.cloneLayer=function(g){var k=new ta("Duplicate Layer"),m=h.createElementNS(c,"g"),B=h.createElementNS(c,"title");B.textContent=g;m.appendChild(B);
B=A().getCurrentLayer();$(B).after(m);B=B.childNodes;for(var z=0;z<B.length;z++){var H=B[z];H.localName!="title"&&m.appendChild(ia(H))}Qa();Bb();k.addSubCommand(new xa(m));wa(k);b.setCurrentLayer(g);M("changed",[m])};this.deleteCurrentLayer=function(){var g=A().getCurrentLayer(),k=g.nextSibling,m=g.parentNode;if(g=A().deleteCurrentLayer()){var B=new ta("Delete Layer");B.addSubCommand(new Ja(g,k,m));wa(B);Qa();M("changed",[m]);return true}return false};this.setCurrentLayer=function(g){(g=A().setCurrentLayer(svgedit.utilities.toXml(g)))&&
Qa();return g};this.renameCurrentLayer=function(g){var k=A();if(k.current_layer){var m=k.current_layer;if(!b.setCurrentLayer(g)){for(var B=new ta("Rename Layer"),z=0;z<k.getNumLayers();++z)if(k.all_layers[z][1]==m)break;var H=k.getLayerName(z);k.all_layers[z][0]=svgedit.utilities.toXml(g);var C=m.childNodes.length;for(z=0;z<C;++z){var v=m.childNodes.item(z);if(v&&v.tagName=="title"){for(;v.firstChild;)v.removeChild(v.firstChild);v.textContent=g;B.addSubCommand(new Na(v,{"#text":H}));wa(B);M("changed",
[m]);return true}}}k.current_layer=m}return false};this.setCurrentLayerPosition=function(g){var k=A();if(k.current_layer&&g>=0&&g<k.getNumLayers()){for(var m=0;m<k.getNumLayers();++m)if(k.all_layers[m][1]==k.current_layer)break;if(m==k.getNumLayers())return false;if(m!=g){var B=null,z=k.current_layer.nextSibling;if(g>m){if(g<k.getNumLayers()-1)B=k.all_layers[g+1][1]}else B=k.all_layers[g][1];n.insertBefore(k.current_layer,B);wa(new Ia(k.current_layer,z,n));Bb();b.setCurrentLayer(k.getLayerName(g));
return true}}return false};this.setLayerVisibility=function(g,k){var m=A(),B=m.getLayerVisibility(g),z=m.setLayerVisibility(g,k);if(z)wa(new Na(z,{display:B?"inline":"none"},"Layer Visibility"));else return false;if(z==m.getCurrentLayer()){Qa();Ma.clear()}return true};this.moveSelectedToLayer=function(g){for(var k=null,m=A(),B=0;B<m.getNumLayers();++B)if(m.getLayerName(B)==g){k=m.all_layers[B][1];break}if(!k)return false;g=new ta("Move Elements to Layer");m=J;for(B=m.length;B--;){var z=m[B];if(z){var H=
z.nextSibling,C=z.parentNode;k.appendChild(z);g.addSubCommand(new Ia(z,H,C))}}wa(g);return true};this.mergeLayer=function(g){var k=new ta("Merge Layer"),m=A(),B=$(m.current_layer).prev()[0];if(B){for(k.addSubCommand(new Ja(m.current_layer,m.current_layer.nextSibling,n));m.current_layer.firstChild;){var z=m.current_layer.firstChild;if(z.localName=="title"){k.addSubCommand(new Ja(z,z.nextSibling,m.current_layer));m.current_layer.removeChild(z)}else{var H=z.nextSibling;B.appendChild(z);k.addSubCommand(new Ia(z,
H,m.current_layer))}}n.removeChild(m.current_layer);if(!g){Qa();Bb();M("changed",[n]);wa(k)}m.current_layer=B;return k}};this.mergeAllLayers=function(){var g=new ta("Merge all Layers"),k=A();for(k.current_layer=k.all_layers[k.getNumLayers()-1][1];$(n).children("g").length>1;)g.addSubCommand(b.mergeLayer(true));Qa();Bb();M("changed",[n]);wa(g)};var Hb=this.leaveContext=function(){var g=ua.length;if(g){for(var k=0;k<g;k++){var m=ua[k],B=fb(m,"orig_opac");B!==1?m.setAttribute("opacity",B):m.removeAttribute("opacity");
m.setAttribute("style","pointer-events: inherit")}ua=[];Qa(true);M("contextset",null)}L=null},Jb=this.setContext=function(g){Hb();if(typeof g==="string")g=qa(g);L=g;$(g).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var k=this.getAttribute("opacity")||1;fb(this,"orig_opac",k);this.setAttribute("opacity",k*0.33);this.setAttribute("style","pointer-events: none");ua.push(this)});Qa();M("contextset",L)};this.clear=function(){Ma.clear();Qa();b.clearSvgContentElement();b.current_drawing_=
new svgedit.draw.Drawing(n);b.createLayer("Layer 1");b.undoMgr.resetUndoStack();Ha.initGroup();sa=Ha.getRubberBandBox();M("cleared")};this.linkControlPoints=Ma.linkControlPoints;this.getContentElem=function(){return n};this.getRootElem=function(){return f};this.getSelectedElems=function(){return J};var Ab=this.getResolution=function(){var g=n.getAttribute("width")/p,k=n.getAttribute("height")/p;return{w:g,h:k,zoom:p}};this.getZoom=function(){return p};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};
this.setUiStrings=function(g){$.extend(Va,g.notification)};this.setConfig=function(g){$.extend(e,g)};this.getTitle=function(g){if(g=g||J[0]){g=$(g).data("gsvg")||$(g).data("symbol")||g;g=g.childNodes;for(var k=0;k<g.length;k++)if(g[k].nodeName=="title")return g[k].textContent;return""}};this.setGroupTitle=function(g){var k=J[0];k=$(k).data("gsvg")||k;var m=$(k).children("title"),B=new ta("Set Label");if(g.length)if(m.length){m=m[0];B.addSubCommand(new Na(m,{"#text":m.textContent}));m.textContent=
g}else{m=h.createElementNS(c,"title");m.textContent=g;$(k).prepend(m);B.addSubCommand(new xa(m))}else{B.addSubCommand(new Ja(m[0],m.nextSibling,k));m.remove()}wa(B)};this.getDocumentTitle=function(){return b.getTitle(n)};this.setDocumentTitle=function(g){for(var k=n.childNodes,m=false,B="",z=new ta("Change Image Title"),H=0;H<k.length;H++)if(k[H].nodeName=="title"){m=k[H];B=m.textContent;break}if(!m){m=h.createElementNS(c,"title");n.insertBefore(m,n.firstChild)}if(g.length)m.textContent=g;else m.parentNode.removeChild(m);
z.addSubCommand(new Na(m,{"#text":B}));wa(z)};this.getEditorNS=function(g){g&&n.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(g,k){var m=Ab(),B=m.w;m=m.h;var z;if(g=="fit"){var H=getStrokedBBox();if(H){z=new ta("Fit Canvas to Content");var C=rb();sb(C);var v=[],F=[];$.each(C,function(){v.push(H.x*-1);F.push(H.y*-1)});C=b.moveSelectedElements(v,F,true);z.addSubCommand(C);Qa();g=Math.round(H.width);k=Math.round(H.height)}else return false}if(g!=
B||k!=m){C=f.suspendRedraw(1E3);z||(z=new ta("Change Image Dimensions"));g=ra("width",g);k=ra("height",k);n.setAttribute("width",g);n.setAttribute("height",k);this.contentW=g;this.contentH=k;z.addSubCommand(new Na(n,{width:B,height:m}));n.setAttribute("viewBox",[0,0,g/p,k/p].join(" "));z.addSubCommand(new Na(n,{viewBox:["0 0",B,m].join(" ")}));wa(z);f.unsuspendRedraw(C);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",
g+2);background.setAttribute("height",k+2)}M("changed",[n])}return[g,k]};this.getOffset=function(){return $(n).attr(["x","y"])};this.setBBoxZoom=function(g,k,m){var B=0.85,z=function(H){if(!H)return false;var C=Math.min(Math.round(k/H.width*100*B)/100,Math.round(m/H.height*100*B)/100);b.setZoom(C);return{zoom:C,bbox:H}};if(typeof g=="object"){g=g;if(g.width==0||g.height==0){b.setZoom(g.zoom?g.zoom:p*g.factor);return{zoom:p,bbox:g}}return z(g)}switch(g){case "selection":if(!J[0])return;g=$.map(J,function(H){if(H)return H});
g=getStrokedBBox(g);break;case "canvas":g=Ab();B=0.95;g={width:g.w,height:g.h,x:0,y:0};break;case "content":g=getStrokedBBox();break;case "layer":g=getStrokedBBox(rb(A().getCurrentLayer()));break;default:return}return z(g)};this.setZoom=function(g){var k=Ab();n.setAttribute("viewBox","0 0 "+k.w/g+" "+k.h/g);p=g;$.each(J,function(m,B){B&&Ha.requestSelector(B).resize()});Ma.zoomChange();lb("zoomChanged",g)};this.getMode=function(){return Ea};this.setMode=function(g){Ma.clear();bb.clear();$("#workarea").attr("class",
g);$a=J[0]&&J[0].nodeName=="text"?Za:N;Ea=g};this.getColor=function(g){return $a[g]};this.setColor=function(g,k,m){N[g]=k;$a[g+"_paint"]={type:"solidColor"};for(var B=[],z=J.length;z--;){var H=J[z];if(H)if(H.tagName=="g")svgedit.utilities.walkTree(H,function(C){C.nodeName!="g"&&B.push(C)});else if(g=="fill")H.tagName!="polyline"&&H.tagName!="line"&&B.push(H);else B.push(H)}if(B.length>0)if(m)Cb(g,k,B);else{jb(g,k,B);M("changed",B)}};var ib=function(){var g=n.getElementsByTagNameNS(c,"defs");if(g.length>
0)g=g[0];else{g=h.createElementNS(c,"defs");n.firstChild?n.insertBefore(g,n.firstChild.nextSibling):n.appendChild(g)}return g},Mb=this.setGradient=function(g){if(!(!$a[g+"_paint"]||$a[g+"_paint"].type=="solidColor")){var k=b[g+"Grad"],m=Ib(k),B=ib();if(m)k=m;else{k=B.appendChild(h.importNode(k,true));k.id=ka()}b.setColor(g,"url(#"+k.id+")");if(g=="canvas")(g=document.getElementById("canvas_background"))&&g.setAttribute("fill","url(#"+k.id+")")}},Ib=function(g){var k=ib();k=$(k).find("linearGradient, radialGradient");
for(var m=k.length,B=["r","cx","cy","fx","fy"];m--;){var z=k[m];if(g.tagName=="linearGradient"){if(g.getAttribute("x1")!=z.getAttribute("x1")||g.getAttribute("y1")!=z.getAttribute("y1")||g.getAttribute("x2")!=z.getAttribute("x2")||g.getAttribute("y2")!=z.getAttribute("y2"))continue}else{var H=$(g).attr(B),C=$(z).attr(B),v=false;$.each(B,function(w,D){if(H[D]!=C[D])v=true});if(v)continue}var F=g.getElementsByTagNameNS(c,"stop"),I=z.getElementsByTagNameNS(c,"stop");if(F.length==I.length){for(var E=
F.length;E--;){var d=F[E],o=I[E];if(d.getAttribute("offset")!=o.getAttribute("offset")||d.getAttribute("stop-opacity")!=o.getAttribute("stop-opacity")||d.getAttribute("stop-color")!=o.getAttribute("stop-color"))break}if(E==-1)return z}}return null};this.setPaint=function(g,k){var m=new $.jGraduate.Paint(k);this.setPaintOpacity(g,m.alpha/100,true);$a[g+"_paint"]=m;switch(m.type){case "solidColor":if(m.solidColor!="none"&&m.solidColor!="#none")this.setColor(g,"#"+m.solidColor);else{this.setColor(g,
"none");document.querySelector(g=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":b[g+"Grad"]=m[m.type];Mb(g)}};this.getStrokeWidth=function(){return $a.stroke_width};this.setStrokeWidth=function(g){if(g==0&&["line","path"].indexOf(Ea)>=0)b.setStrokeWidth(1);else{$a.stroke_width=g;for(var k=[],m=J.length;m--;){var B=J[m];if(B)B.tagName=="g"?svgedit.utilities.walkTree(B,function(z){z.nodeName!="g"&&k.push(z)}):k.push(B)}if(k.length>
0){jb("stroke-width",g,k);M("changed",J)}}};this.setStrokeAttr=function(g,k){N[g.replace("-","_")]=k;for(var m=[],B=J.length;B--;){var z=J[B];if(z)z.tagName=="g"?svgedit.utilities.walkTree(z,function(H){H.nodeName!="g"&&m.push(H)}):m.push(z)}if(m.length>0){jb(g,k,m);M("changed",J)}};this.getStyle=function(){return N};this.getOpacity=function(){return N.opacity};this.setOpacity=function(g){N.opacity=g;jb("opacity",g)};this.getFillOpacity=function(){return N.fill_opacity};this.getStrokeOpacity=function(){return N.stroke_opacity};
this.setPaintOpacity=function(g,k,m){N[g+"_opacity"]=k;m?Cb(g+"-opacity",k):jb(g+"-opacity",k)};this.getBlur=function(g){var k=0;if(g)if(g.getAttribute("filter"))if(g=qa(g.id+"_blur"))k=g.firstChild.getAttribute("stdDeviation");return k};(function(){function g(){var z=b.undoMgr.finishUndoableChange();k.addSubCommand(z);wa(k);m=k=null}var k=null,m=null,B=false;b.setBlurNoUndo=function(z){if(m)if(z===0){Cb("filter","");B=true}else{var H=J[0];B&&Cb("filter","url(#"+H.id+"_blur)");if(svgedit.browser.isWebkit()){H.removeAttribute("filter");
H.setAttribute("filter","url(#"+H.id+"_blur)")}Cb("stdDeviation",z,[m.firstChild]);b.setBlurOffsets(m,z)}else b.setBlur(z)};b.setBlurOffsets=function(z,H){if(H>3)la(z,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100);else if(!svgedit.browser.isWebkit()){z.removeAttribute("x");z.removeAttribute("y");z.removeAttribute("width");z.removeAttribute("height")}};b.setBlur=function(z,H){if(k)g();else{var C=J[0],v=C.id;m=qa(v+"_blur");z-=0;var F=new ta;if(m){if(z===0)m=null}else{var I=P({element:"feGaussianBlur",
attr:{"in":"SourceGraphic",stdDeviation:z}});m=P({element:"filter",attr:{id:v+"_blur"}});m.appendChild(I);ib().appendChild(m);F.addSubCommand(new xa(m))}I={filter:C.getAttribute("filter")};if(z===0){C.removeAttribute("filter");F.addSubCommand(new Na(C,I))}else{jb("filter","url(#"+v+"_blur)");F.addSubCommand(new Na(C,I));b.setBlurOffsets(m,z);k=F;b.undoMgr.beginUndoableChange("stdDeviation",[m?m.firstChild:null]);if(H){b.setBlurNoUndo(z);g()}}}}})();this.getBold=function(){var g=true;J.filter(Boolean).forEach(function(k){if(k.getAttribute("font-weight")!=
"bold")g=false});return g};this.setBold=function(g){var k=J.filter(Boolean);k.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-weight",g?"bold":"normal")});k[0].textContent||bb.setCursor()};this.getItalic=function(){var g=true;J.filter(Boolean).forEach(function(k){if(k.getAttribute("font-style")!="italic")g=false});return g};this.setItalic=function(g){var k=J.filter(Boolean);k.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-style",g?"italic":"normal")});k[0].textContent||bb.setCursor()};
this.getFontFamily=function(){return Za.font_family};this.setFontFamily=function(g){Za.font_family=g;jb("font-family",g);J[0]&&!J[0].textContent&&bb.setCursor()};this.setFontColor=function(g){Za.fill=g;jb("fill",g)};this.getFontSize=function(){return Za.fill};this.getFontSize=function(){return Za.font_size};this.setFontSize=function(g){Za.font_size=g;jb("font-size",g);J[0].textContent||bb.setCursor()};this.getText=function(){var g=J[0];if(g==null)return"";return g.textContent};this.setTextContent=
function(g){jb("#text",g);bb.init(g);bb.setCursor()};this.setImageURL=function(g){var k=J[0];if(k){var m=$(k).attr(["width","height"]);m=!m.width||!m.height;var B=da(k);if(B!==g)m=true;else if(!m)return;var z=new ta("Change Image URL");V(k,g);z.addSubCommand(new Na(k,{"#href":B}));m?$(new Image).load(function(){var H=$(k).attr(["width","height"]);$(k).attr({width:this.width,height:this.height});Ha.requestSelector(k).resize();z.addSubCommand(new Na(k,H));wa(z);M("changed",[k])}).attr("src",g):wa(z)}};
this.setLinkURL=function(g){var k=J[0];if(k){if(k.tagName!=="a"){k=$(k).parents("a");if(k.length)k=k[0];else return}var m=da(k);if(m!==g){var B=new ta("Change Link URL");V(k,g);B.addSubCommand(new Na(k,{"#href":m}));wa(B)}}};this.elementsAreSame=function(g){return!g.length||g[0]==null?null:J.every(function(k){return k&&J[0]?k.nodeName==J[0].nodeName:null})};this.setRectRadius=function(g){b.elementsAreSame(J)&&J[0].tagName=="rect"&&J.forEach(function(k){var m=k.getAttribute("rx");if(m!=g){k.setAttribute("rx",
g);k.setAttribute("ry",g);wa(new Na(k,{rx:m,ry:m},"Radius"));M("changed",[k])}})};this.makeHyperlink=function(g){b.groupSelectedElements("a",g)};this.removeHyperlink=function(){b.ungroupSelectedElement()};this.setSegType=function(g){Ma.setSegType(g)};this.convertToPath=function(g,k){if(g==null)$.each(J,function(Y,S){S&&b.convertToPath(S)});else{if(!k)var m=new ta("Convert element to Path");var B=k?{}:{fill:N.fill,"fill-opacity":N.fill_opacity,stroke:N.stroke,"stroke-width":N.stroke_width,"stroke-dasharray":N.stroke_dasharray,
"stroke-linejoin":N.stroke_linejoin,"stroke-linecap":N.stroke_linecap,"stroke-opacity":N.stroke_opacity,opacity:N.opacity,visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(g.getAttribute(this))B[this]=g.getAttribute(this)});var z=P({element:"path",attr:B}),H=g.getAttribute("transform");H&&z.setAttribute("transform",H);var C=g.id,v=g.parentNode;g.nextSibling?v.insertBefore(z,g):v.appendChild(z);var F="",I=function(Y){$.each(Y,function(S,Z){var ba=
Z[1];F+=Z[0];for(var oa=0;oa<ba.length;oa+=2)F+=ba[oa]+","+ba[oa+1]+" "})},E=1.81;switch(g.tagName){case "ellipse":case "circle":var d=$(g).attr(["rx","ry","cx","cy"]),o=d.cx,w=d.cy,D=d.rx;d=d.ry;if(g.tagName=="circle")D=d=$(g).attr("r");I([["M",[o-D,w]],["C",[o-D,w-d/E,o-D/E,w-d,o,w-d]],["C",[o+D/E,w-d,o+D,w-d/E,o+D,w]],["C",[o+D,w+d/E,o+D/E,w+d,o,w+d]],["C",[o-D/E,w+d,o-D,w+d/E,o-D,w]],["Z",[]]]);break;case "path":F=g.getAttribute("d");break;case "line":d=$(g).attr(["x1","y1","x2","y2"]);F="M"+
d.x1+","+d.y1+"L"+d.x2+","+d.y2;break;case "polyline":case "polygon":F="M"+g.getAttribute("points");break;case "rect":d=$(g).attr(["rx","ry"]);D=d.rx;d=d.ry;var G=g.getBBox();o=G.x;w=G.y;var K=G.width;G=G.height;E=4-E;if(!D&&!d)I([["M",[o,w]],["L",[o+K,w]],["L",[o+K,w+G]],["L",[o,w+G]],["L",[o,w]],["Z",[]]]);else{d||(d=D);I([["M",[o,w+d]],["C",[o,w+d/E,o+D/E,w,o+D,w]],["L",[o+K-D,w]],["C",[o+K-D/E,w,o+K,w+d/E,o+K,w+d]],["L",[o+K,w+G-d]],["C",[o+K,w+G-d/E,o+K-D/E,w+G,o+K-D,w+G]],["L",[o+D,w+G]],["C",
[o+D/E,w+G,o,w+G-d/E,o,w+G-d]],["L",[o,w+d]],["Z",[]]])}break;default:z.parentNode.removeChild(z)}F&&z.setAttribute("d",F);if(k){Ma.resetOrientation(z);m=false;try{m=z.getBBox()}catch(T){}z.parentNode.removeChild(z);return m}else{if(H){H=U(z);pa(H)&&Ma.resetOrientation(z)}m.addSubCommand(new Ja(g,g.nextSibling,v));m.addSubCommand(new xa(z));Qa();g.parentNode.removeChild(g);z.setAttribute("id",C);z.removeAttribute("visibility");sb([z],true);wa(m)}}};var Cb=this.changeSelectedAttributeNoUndo=function(g,
k,m){var B=f.suspendRedraw(1E3);Ea=="pathedit"&&Ma.moveNode(g,k);m=m||J;for(var z=m.length,H=["g","polyline","path"];z--;){var C=m[z];if(C!=null){Ea==="textedit"&&g!=="#text"&&C.textContent.length&&bb.toSelectMode(C);if((g==="x"||g==="y")&&H.indexOf(C.tagName)>=0){var v=getStrokedBBox([C]);b.moveSelectedElements((g==="x"?k-v.x:0)*p,(g==="y"?k-v.y:0)*p,true)}else{v=g==="#text"?C.textContent:C.getAttribute(g);if(v==null)v="";if(v!==String(k)){if(g=="#text"){svgedit.utilities.getBBox(C);C.textContent=
k}else g=="#href"?V(C,k):C.setAttribute(g,k);J.indexOf(C)>=0&&setTimeout(function(){C.parentNode&&Ha.requestSelector(C).resize()},0);v=na(C);if(v!=0&&g!="transform")for(var F=U(C),I=F.numberOfItems;I--;)if(F.getItem(I).type==4){F.removeItem(I);var E=svgedit.utilities.getBBox(C),d=O(E.x+E.width/2,E.y+E.height/2,fa(F).matrix);E=d.x;d=d.y;var o=f.createSVGTransform();o.setRotate(v,E,d);F.insertItemBefore(o,I);break}}}}}f.unsuspendRedraw(B)},jb=this.changeSelectedAttribute=function(g,k,m){m=m||J;b.undoMgr.beginUndoableChange(g,
m);Cb(g,k,m);g=b.undoMgr.finishUndoableChange();g.isEmpty()||wa(g)};this.deleteSelectedElements=function(){for(var g=new ta("Delete Elements"),k=J.length,m=[],B=0;B<k;++B){var z=J[B];if(z==null)break;var H=z.parentNode,C=z;Ha.releaseSelector(C);svgedit.path.removePath_(C.id);if(H.tagName==="a"&&H.childNodes.length===1){C=H;H=H.parentNode}var v=C.nextSibling;C=H.removeChild(C);m.push(z);J[B]=null;g.addSubCommand(new Ja(C,v,H))}g.isEmpty()||wa(g);M("changed",m);Qa()};this.cutSelectedElements=function(){for(var g=
new ta("Cut Elements"),k=J.length,m=[],B=0;B<k;++B){var z=J[B];if(z==null)break;var H=z.parentNode,C=z;Ha.releaseSelector(C);svgedit.path.removePath_(C.id);var v=C.nextSibling;C=H.removeChild(C);m.push(z);J[B]=null;g.addSubCommand(new Ja(C,v,H))}g.isEmpty()||wa(g);M("changed",m);Qa();b.clipBoard=m};this.copySelectedElements=function(){b.clipBoard=$.merge([],J)};this.pasteElements=function(){var g=b.clipBoard,k=g.length;if(k){for(var m=[],B=new ta("Paste elements");k--;){var z=g[k];if(z){var H=ia(z);
if(!qa(z.id))H.id=z.id;m.push(H);(L||A().getCurrentLayer()).appendChild(H);B.addSubCommand(new xa(H))}}svgCanvas.clearSelection();setTimeout(function(){Ra(m)},100);wa(B);M("changed",m)}};this.groupSelectedElements=function(g){g||(g="g");var k="";switch(g){case "a":k="Make hyperlink";var m="";if(arguments.length>1)m=arguments[1];break;default:g="g";k="Group Elements"}k=new ta(k);var B=P({element:g,attr:{id:ka()}});g==="a"&&V(B,m);k.addSubCommand(new xa(B));for(m=J.length;m--;){var z=J[m];if(z!=null){if(z.parentNode.tagName===
"a"&&z.parentNode.childNodes.length===1)z=z.parentNode;var H=z.nextSibling,C=z.parentNode;B.appendChild(z);k.addSubCommand(new Ia(z,H,C))}}k.isEmpty()||wa(k);Ra([B],true)};var Gb=this.pushGroupProperties=function(g,k){var m=g.childNodes,B=m.length,z=g.getAttribute("transform"),H=U(g),C=fa(H).matrix,v=new ta("Push group properties"),F=0,I=na(g),E=$(g).attr(["filter","opacity"]),d,o;for(F=0;F<B;F++){var w=m[F];if(w.nodeType===1){if(E.opacity!==null&&E.opacity!==1){w.getAttribute("opacity");var D=Math.round((w.getAttribute("opacity")||
1)*E.opacity*100)/100;jb("opacity",D,[w])}if(E.filter){var G=D=this.getBlur(w);o||(o=this.getBlur(g));if(D)D=o-0+(D-0);else if(D===0)D=o;if(G)d=R(w.getAttribute("filter"));else if(d){d=ia(d);ib().appendChild(d)}else d=R(E.filter);d.id=w.id+"_"+(d.firstChild.tagName==="feGaussianBlur"?"blur":"filter");jb("filter","url(#"+d.id+")",[w]);if(D){jb("stdDeviation",D,[d.firstChild]);b.setBlurOffsets(d,D)}}D=U(w);if(~w.tagName.indexOf("Gradient"))D=null;if(D)if(w.tagName!=="defs")if(H.numberOfItems){if(I&&
H.numberOfItems==1){var K=H.getItem(0).matrix,T=f.createSVGMatrix();if(G=na(w))T=D.getItem(0).matrix;var Y=svgedit.utilities.getBBox(w),S=fa(D).matrix,Z=O(Y.x+Y.width/2,Y.y+Y.height/2,S);Y=I+G;S=f.createSVGTransform();S.setRotate(Y,Z.x,Z.y);K=ha(K,T,S.matrix.inverse());G&&D.removeItem(0);if(Y)D.numberOfItems?D.insertItemBefore(S,0):D.appendItem(S);if(K.e||K.f){G=f.createSVGTransform();G.setTranslate(K.e,K.f);D.numberOfItems?D.insertItemBefore(G,0):D.appendItem(G)}}else{G=w.getAttribute("transform");
K={};K.transform=G?G:"";G=f.createSVGTransform();K=fa(D).matrix;T=K.inverse();K=ha(T,C,K);G.setMatrix(K);D.appendItem(G)}(w=Ta(w))&&v.addSubCommand(w)}}}if(z){K={};K.transform=z;g.setAttribute("transform","");g.removeAttribute("transform");v.addSubCommand(new Na(g,K))}if(k&&!v.isEmpty())return v};this.ungroupSelectedElement=function(){var g=J[0];if($(g).data("gsvg")||$(g).data("symbol"))Pb(g);else if(g.tagName==="use"){var k=qa(da(g).substr(1));$(g).data("symbol",k).data("ref",k);Pb(g)}else{k=$(g).parents("a");
if(k.length)g=k[0];if(g.tagName==="g"||g.tagName==="a"){k=new ta("Ungroup Elements");var m=Gb(g,true);m&&k.addSubCommand(m);m=g.parentNode;for(var B=g.nextSibling,z=Array(g.childNodes.length),H=0;g.firstChild;){var C=g.firstChild,v=C.nextSibling,F=C.parentNode;if(C.tagName==="title"){k.addSubCommand(new Ja(C,C.nextSibling,F));F.removeChild(C)}else{z[H++]=C=m.insertBefore(C,B);k.addSubCommand(new Ia(C,v,F))}}Qa();B=g.nextSibling;g=m.removeChild(g);k.addSubCommand(new Ja(g,B,m));k.isEmpty()||wa(k);
sb(z)}}};this.moveToTopSelectedElement=function(){var g=J.filter(Boolean).reverse(),k=new ta("Move to top");g.forEach(function(m){m=m;var B=m.parentNode,z=m.nextSibling;m=m.parentNode.appendChild(m);if(z!=m.nextSibling){k.addSubCommand(new Ia(m,z,B,"top"));M("changed",[m])}k.isEmpty()||wa(k)})};this.moveToBottomSelectedElement=function(){var g=J.filter(Boolean).reverse(),k=new ta("Move to top");g.forEach(function(m){m=m;var B=m.parentNode,z=m.nextSibling,H=m.parentNode.firstChild;if(H.tagName=="title")H=
H.nextSibling;if(H.tagName=="defs")H=H.nextSibling;m=m.parentNode.insertBefore(m,H);if(z!=m.nextSibling){k.addSubCommand(new Ia(m,z,B,"bottom"));M("changed",[m])}});k.isEmpty()||wa(k)};this.moveUpDownSelected=function(g){var k=J.filter(Boolean);g=="Down"&&k.reverse();var m=new ta("Move "+g);k.forEach(function(B){kb=[];var z,H,C=$(nb(getStrokedBBox([B]))).toArray();g=="Down"&&C.reverse();$.each(C,function(){if(H){z=this;return false}else if(this==B)H=true});if(z){C=B.parentNode;var v=B.nextSibling;
$(z)[g=="Down"?"before":"after"](B);if(v!=B.nextSibling){m.addSubCommand(new Ia(B,v,C,"Move "+g));M("changed",[B])}}});m.isEmpty()||wa(m)};this.moveSelectedElements=function(g,k,m){if(g.constructor!=Array){g/=p;k/=p}m=m||true;for(var B=new ta("position"),z=J.length;z--;){var H=J[z];if(H!=null){var C=f.createSVGTransform(),v=U(H);g.constructor==Array?C.setTranslate(g[z],k[z]):C.setTranslate(g,k);v.numberOfItems?v.insertItemBefore(C,0):v.appendItem(C);(C=Ta(H))&&B.addSubCommand(C);Ha.requestSelector(H).resize()}}if(!B.isEmpty()){m&&
wa(B);M("changed",J);return B}};this.cloneSelectedElements=function(g,k,m){for(var B=new ta("Clone Elements"),z=J.length,H=0;H<z;++H){var C=J[H];if(C==null)break}z=J.slice(0,H);this.clearSelection(true);H=z.length;for(clones=[];H--;){C=z[H];var v=ia(z[H]),F=L||A().getCurrentLayer();if(m){tlist=U(v);tlist.removeItem(m);Ta(v);F.insertBefore(v,C)}else F.appendChild(v);clones.push(v);B.addSubCommand(new xa(v))}if(!B.isEmpty()){sb(z.reverse());m||this.moveSelectedElements(g,k,false);wa(B)}return clones};
this.alignSelectedElements=function(g,k){var m=[],B=Number.MAX_VALUE,z=Number.MIN_VALUE,H=Number.MAX_VALUE,C=Number.MIN_VALUE,v=Number.MIN_VALUE,F=Number.MIN_VALUE,I=J.length;if(I){for(var E=0;E<I;++E){if(J[E]==null)break;m[E]=getStrokedBBox([J[E]]);switch(k){case "smallest":if((g=="l"||g=="c"||g=="r")&&(v==Number.MIN_VALUE||v>m[E].width)||(g=="t"||g=="m"||g=="b")&&(F==Number.MIN_VALUE||F>m[E].height)){B=m[E].x;H=m[E].y;z=m[E].x+m[E].width;C=m[E].y+m[E].height;v=m[E].width;F=m[E].height}break;case "largest":if((g==
"l"||g=="c"||g=="r")&&(v==Number.MIN_VALUE||v<m[E].width)||(g=="t"||g=="m"||g=="b")&&(F==Number.MIN_VALUE||F<m[E].height)){B=m[E].x;H=m[E].y;z=m[E].x+m[E].width;C=m[E].y+m[E].height;v=m[E].width;F=m[E].height}break;default:if(m[E].x<B)B=m[E].x;if(m[E].y<H)H=m[E].y;if(m[E].x+m[E].width>z)z=m[E].x+m[E].width;if(m[E].y+m[E].height>C)C=m[E].y+m[E].height}}if(k=="page"){H=B=0;z=b.contentW;C=b.contentH}v=Array(I);F=Array(I);for(E=0;E<I;++E){if(J[E]==null)break;var d=m[E];v[E]=0;F[E]=0;switch(g){case "l":v[E]=
B-d.x;break;case "c":v[E]=(B+z)/2-(d.x+d.width/2);break;case "r":v[E]=z-(d.x+d.width);break;case "t":F[E]=H-d.y;break;case "m":F[E]=(H+C)/2-(d.y+d.height/2);break;case "b":F[E]=C-(d.y+d.height)}}this.moveSelectedElements(v,F)}};this.contentW=Ab().w;this.contentH=Ab().h;this.updateCanvas=function(g,k){f.setAttribute("width",g);f.setAttribute("height",k);var m=$("#canvasBackground")[0],B=n.getAttribute("x"),z=n.getAttribute("y"),H=g/2-this.contentW*p/2,C=k/2-this.contentH*p/2;la(n,{width:this.contentW*
p,height:this.contentH*p,x:H,y:C,viewBox:"0 0 "+this.contentW+" "+this.contentH});la(m,{width:n.getAttribute("width"),height:n.getAttribute("height"),x:H,y:C});(m=qa("background_image"))&&la(m,{width:"100%",height:"100%"});Ha.selectorParentGroup.setAttribute("transform","translate("+H+","+C+")");return{x:H,y:C,old_x:B,old_y:z,d_x:H-B,d_y:C-z}};this.setBackground=function(g,k){var m=qa("canvasBackground"),B=$(m).find("rect")[0],z=qa("background_image");B.setAttribute("fill",g);if(k){if(!z){z=h.createElementNS(c,
"image");la(z,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}V(z,k);m.appendChild(z)}else z&&z.parentNode.removeChild(z)};this.cycleElement=function(g){var k=J[0],m=false,B=rb(L||A().getCurrentLayer());if(B.length){if(k==null){g=g?B.length-1:0;m=B[g]}else for(var z=B.length;z--;)if(B[z]==k){g=g?z-1:z+1;if(g>=B.length)g=0;else if(g<0)g=B.length-1;m=B[g];break}Ra([m],true);M("selected",J)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:wa,
setGradient:Mb,addSvgElementFromJson:P,assignAttributes:la,BatchCommand:ta,call:M,ChangeElementCommand:Na,copyElem:ia,ffClone:ea,findDefs:ib,findDuplicateGradient:Ib,getElem:qa,getId:ca,getIntersectionList:nb,getMouseTarget:Fb,getNextId:ka,getPathBBox:X,getUrlFromAttr:ja,hasMatrixTransform:pa,identifyLayers:Bb,InsertElementCommand:xa,isIdentity:svgedit.math.isIdentity,logMatrix:Sa,matrixMultiply:ha,MoveElementCommand:Ia,preventClickDefault:Eb,recalculateAllSelectedDimensions:Fa,recalculateDimensions:Ta,
remapElement:cb,RemoveElementCommand:Ja,removeUnusedDefElems:Ob,round:eb,runExtensions:lb,sanitizeSvg:Ga,SVGEditTransformList:svgedit.transformlist.SVGTransformList,toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:fa,transformPoint:O,walkTree:svgedit.utilities.walkTree}}};(function(){function l(){u=new WebSocket("ws://192.168.2.102:9000","echo-protocol");u.onopen=function(){console.log("socket opened")};u.onerror=function(){console.log("socket open error.");setTimeout(l,3E3)};u.onmessage=function(a){console.log(a.data)}}window.WebSocket=window.WebSocket||window.MozWebSocket;var u;l();document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",
touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function c(s,A){var p=e.setSvgString(s)!==false;A=A||a.noop;p?A(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){A(false)})}var e,q={},b=false;curConfig={canvas_expansion:1,dimensions:[580,400],initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,
gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=q.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",
enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",
featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",
errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var h={},f={};q.curConfig=curConfig;q.tool_scale=1;q.setConfig=function(s){a.extend(true,curConfig,s);if(s.extensions)curConfig.extensions=s.extensions};q.setCustomHandlers=function(s){q.ready(function(){if(s.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();e.open=s.open}if(s.save){q.show_save_warning=false;e.bind("saved",s.save)}s.pngsave&&e.bind("exported",
s.pngsave);f=s})};q.randomizeIds=function(){e.randomizeIds(arguments)};q.init=function(){(function(){var d=window.opener;if(d)try{var o=d.document.createEvent("Event");o.initEvent("methodDrawReady",true,true);d.document.documentElement.dispatchEvent(o)}catch(w){}})();(function(){a("body").toggleClass("touch",svgedit.browser.isTouch());var d=a.deparam.querystring(true);if(!a.isEmptyObject(d)){if(d.dimensions)d.dimensions=d.dimensions.split(",");if(d.extensions)d.extensions=d.extensions.split(",");
if(d.bkgd_color)d.bkgd_color="#"+d.bkgd_color;methodDraw.setConfig(d);var o=d.source,w=a.param.querystring();if(!o)if(w.indexOf("source=data:")>=0)o=w.match(/source=(data:[^&]*)/)[1];if(o)if(o.indexOf("data:")===0){o=o.replace(/ /g,"+");q.loadFromDataURI(o)}else q.loadFromString(o);else if(w.indexOf("paramurl=")!==-1)methodDraw.loadFromURL(w.substr(9));else d.url&&methodDraw.loadFromURL(d.url)}})();a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var s=
function(){a.each(curConfig.extensions,function(){var d=this;a.getScript(curConfig.extPath+d,function(o){if(!o){o=document.createElement("script");o.src=curConfig.extPath+d;document.querySelector("head").appendChild(o)}})})};document.location.protocol==="file:"?setTimeout(s,100):s();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",
rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen",
"#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top",
"#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});
a(".tool_button, .tool_button_current").addClass("loaded");var d=a("#tools_left");if(d.length!=0){d.offset();d.outerHeight()}a(".tools_flyout").each(function(){var o=a("#"+this.id+"_show"),w=o.attr("data-curopt");if(!o.children("svg, img").length){w=a(w).children().clone();if(w.length){w[0].removeAttribute("style");o.append(w)}}});methodDraw.runCallbacks();setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",
function(d){a("#base_unit_container").css({top:d.pageY-10,left:d.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});q.canvas=e=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);q.show_save_warning=false;q.paintBox={fill:null,stroke:null,canvas:null};s=navigator.platform.indexOf("Mac")>=
0;var A=navigator.userAgent.indexOf("AppleWebKit")>=0,p=s?"meta+":"ctrl+",L=e.pathActions,Q=e.undoMgr,N=svgedit.utilities,J=curConfig.imgPath+"placeholder.svg",P=a("#workarea"),U=a("#cmenu_canvas"),O=null,ha=1,pa="toolbars",fa="";s||a(".shortcut").each(function(){var d=a(this).text();a(this).text(d.split("\u2318").join("Ctrl+"))});(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var d=a("#dialog_box"),o=a("#dialog_buttons"),w=function(D,
G,K,T){a("#dialog_content").html("<p>"+G.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",D=="prompt");o.empty();var Y=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(o);D!="alert"&&a('<input type="button" value="'+uiStrings.common.cancel+'">').appendTo(o).on("click touchstart",function(){d.hide();K(false)});if(D=="prompt"){var S=a('<input type="text">').prependTo(o);S.val(T||"");S.bind("keydown","return",function(){Y.trigger("click touchstart")})}D=="process"&&Y.hide();d.show();
Y.on("click touchstart",function(){d.hide();var Z=D=="prompt"?S.val():true;K&&K(Z)}).focus();D=="prompt"&&S.focus()};a.alert=function(D,G){w("alert",D,G)};a.confirm=function(D,G){w("confirm",D,G)};a.process_cancel=function(D,G){w("process",D,G)};a.prompt=function(D,G,K){w("prompt",D,K,G)}})();var aa=function(){var d=a(".tool_button_current");if(d.length&&d[0].id!=="tool_select"){d.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}e.setMode("select")},
W=null,ra=false,ja=false,da="",V=function(d,o){var w=e.getResolution(),D=P;a("#svgcanvas").position();if(D=e.setBBoxZoom(o,D.width()-15,D.height()-15)){var G=D.zoom;D=D.bbox;if(G<0.001)va({value:0.1});else{typeof animatedZoom!="undefined"&&d.cancelAnimationFrame(animatedZoom);var K=Date.now(),T=G-w.zoom;a("#zoom");var Y=w.zoom,S=function(){var Z=(Date.now()-K)/500;Z=Math.pow(Z-1,3)+1;e.setZoom(Y+T*Z);v();if(Z<1&&Z>-0.9)d.animatedZoom=requestAnimationFrame(S);else{a("#zoom").val(parseInt(G*100));a("option",
"#zoom_select").removeAttr("selected");a("option[value="+parseInt(G*100)+"]","#zoom_select").attr("selected","selected")}};S();e.getMode()=="zoom"&&D.width&&aa();Jb()}}};a("#cur_context_panel").delegate("a","click",function(){var d=a(this);d.attr("data-root")?e.leaveContext():e.setContext(d.text());e.clearSelection();return false});var X=function(){q.paintBox.fill.prep();q.paintBox.stroke.prep()},na={},qa=function(d){a.each(d,function(o,w){var D=a(o).children(),G=o+"_show",K=a(G),T=false;D.addClass("tool_button").unbind("click mousedown mouseup").each(function(Z){var ba=
w[Z];na[ba.sel]=ba.fn;if(ba.isDefault)T=Z;Z=function(oa){var Aa=ba;if(oa.type==="keydown"){var ga=a(Aa.parent+"_show").hasClass("tool_button_current"),Ba=a(Aa.parent+"_show").attr("data-curopt");a.each(d[ba.parent],function(za,La){if(La.sel==Ba)Aa=!oa.shiftKey||!ga?La:d[ba.parent][za+1]||d[ba.parent][0]})}if(a(this).hasClass("disabled"))return false;Va(G)&&Aa.fn();var ya=Aa.icon?a.getSvgIcon(Aa.icon,true):a(Aa.sel).children().eq(0).clone();ya[0].setAttribute("width",K.width());ya[0].setAttribute("height",
K.height());K.children(":not(.flyout_arrow_horiz)").remove();K.append(ya).attr("data-curopt",Aa.sel)};a(this).mouseup(Z);ba.key&&a(document).bind("keydown",ba.key[0]+" shift+"+ba.key[0],Z)});if(T)K.attr("data-curopt",w[T].sel);else K.attr("data-curopt")||K.attr("data-curopt",w[0].sel);var Y,S=a(G).position();a(o).css({left:S.left+34,top:S.top+77});K.mousedown(function(Z){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&Va(G,false);if(K.hasClass("disabled"))return false;
var ba=a(o),oa=S.left+34,Aa=ba.width()*-1,ga=ba.data("shown_popop")?200:0;Y=setTimeout(function(){K.data("isLibrary")?ba.css("left",oa).show():ba.css("left",Aa).show().animate({left:oa},50);ba.data("shown_popop",true)},ga);Z.preventDefault()}).mouseup(function(){clearTimeout(Y);var Z=a(this).attr("data-curopt");if(K.data("isLibrary")&&a(G.replace("_show","")).is(":visible"))Va(G,true);else Va(G)&&Z in na&&na[Z]()})});Ca()},la=function(d,o){return a("<div>",{"class":"tools_flyout",id:d}).appendTo("#svg_editor").append(o)},
ma=function(){a(".tools_flyout").each(function(){var d=a("#"+this.id+"_show"),o=d.offset();d=d.outerWidth();a(this).css({left:(o.left+d)*ha,top:o.top})})},Ca=function(){a(".tools_flyout").each(function(){var d=a("#"+this.id+"_show");if(!d.data("isLibrary")){var o=[];a(this).children().each(function(){o.push(this.title)});d[0].title=o.join(" / ")}})},Ga,Ia=function(d,o,w){var D=null;if(d.indexOf("url(#")===0){d=(d=e.getRefElem(d))?d.cloneNode(true):a("#"+w+"_color defs *")[0];D={alpha:o};D[d.tagName]=
d}else D=d.indexOf("#")===0?{alpha:o,solidColor:d.substr(1)}:{alpha:o,solidColor:"none"};return new a.jGraduate.Paint(D)},xa=e.getResolution();if(curConfig.baseUnit!=="px"){xa.w=svgedit.units.convertUnit(xa.w)+curConfig.baseUnit;xa.h=svgedit.units.convertUnit(xa.h)+curConfig.baseUnit}var Ja=function(d){e.createLayer("background");cur_shape=e.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:xa.w+2,height:xa.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:d||"#fff",style:"pointer-events:none"}});
e.setCurrentLayer("Layer 1");e.setCurrentLayerPosition("1")};document.getElementById("canvas_background")||Ja();document.getElementById("canvas_background").getAttribute("fill");var Na=q.setImageURL=function(d){d||(d=J);e.setImageURL(d);a("#image_url").val(d)},ta=function(){var d=W;if(d!=null&&!d.parentNode)d=null;if(ra&&ra[0]!=null&&!ra[0].parentNode)ra=false;var o=e.getCurrentDrawing().getCurrentLayerName(),w=e.getMode(),D=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,G=w=="pathedit";if(G){a(".context_panel").hide();
a("#path_node_panel").show();a("#stroke_panel").hide();o=L.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");a("#tool_node_delete").toggleClass("disabled",!L.canDeleteNodes);Mb("#tool_openclose_path",L.closed_subpath?"open_path":"close_path");if(o){G=a("#seg_type");if(D){o.x=svgedit.units.convertUnit(o.x);o.y=svgedit.units.convertUnit(o.y)}a("#path_node_x").val(Math.round(o.x));a("#path_node_y").val(Math.round(o.y));if(o.type){G.val(o.type).removeAttr("disabled");
a("#seg_type_label").html(o.type==4?"Straight":"Curve")}else G.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var K=a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(ra){ra=ra.filter(Boolean);(d=e.elementsAreSame(ra)?ra[0]:null)&&a("#tools_top").addClass("multiselected")}if(!d&&!ra){a("#tools_top").removeClass("multiselected");
a("#stroke_panel").hide();a("#canvas_panel").show()}if(d!=null){a("#stroke_panel").show();var T=d.nodeName,Y=e.getRotationAngle(d);a("#angle").val(Math.round(Y));Y=e.getBlur(d);a("#blur").val(Y);if(!G&&w!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var S,Z;if(["g","polyline","path"].indexOf(T)>=0)if(w=e.getStrokedBBox([d])){S=w.x;Z=w.y}if(D){S=svgedit.units.convertUnit(S);Z=svgedit.units.convertUnit(Z)}a("#"+T+"_x").val(Math.round(S));a("#"+T+"_y").val(Math.round(Z));
if(T==="polyline"){a("#path_x").val(Math.round(S));a("#path_y").val(Math.round(Z))}["image","text","path","g","use"].indexOf(T)==-1&&a(".action_path_convert_selected").removeClass("disabled");T==="path"&&a(".action_path_selected").removeClass("disabled")}D=null;if(ba==="a"){D=e.getHref(d);a("#g_panel").show()}if(d.parentNode.tagName==="a")if(!a(d).siblings().length){a("#a_panel").show();D=e.getHref(d.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!D);D&&a("#link_url").val(D);D={g:[],a:[],
rect:["rx","width","height","x","y"],image:["width","height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:["x","y"],use:[],path:[]};var ba=d.tagName;a(d).data("gsvg")&&a("#g_panel").show();if(ba=="path"||ba=="polyline")a("#path_panel").show();if(D[ba]){D=D[ba];a("#"+ba+"_panel").show();ba=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(D,function(oa,Aa){var ga=d.getAttribute(Aa);if(curConfig.baseUnit!=="px"&&d[Aa])ga=svgedit.units.convertUnit(d[Aa].baseVal.value);
var Ba=document.getElementById(ba+"_"+Aa);Ba.value=Math.round(ga)||0;Ba.getAttribute("data-cursor")==="true"&&a.fn.dragInput.updateCursor(Ba)});if(ba=="text"){D=d.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",e.getItalic());a("#tool_bold").toggleClass("active",e.getBold());a("#font_family").val(D);a("#font_size").val(d.getAttribute("font-size"));a("#text").val(d.textContent);
a("#preview_font").text(D.split(",")[0].replace(/'/g,"")).css("font-family",D);e.addedNew&&setTimeout(function(){a("#text").focus().select()},100)}else if(ba=="image")Na(e.getHref(d));else if(ba==="g"||ba==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");e.getTitle()}}K[(ba==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");K[(ba==="g"||!ra?"dis":"en")+"ableContextMenuItems"]("#group")}if(ra){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");
K.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}d||K.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");Q.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");Q.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");e.addedNew=false;if(d&&!G||ra){a("#selLayerNames").removeAttr("disabled").val(o);U.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")}}};
a("#text").on("focus",function(){});a("#text").on("blur",function(){});e.bind("selected",function(d,o){var w=e.getMode();w==="select"&&aa();if(w==="pathedit")return ta();W=o.length==1||o[1]==null?o[0]:null;o=o.filter(Boolean);ra=o.length>=2?o:false;if(e.elementsAreSame(ra))W=ra[0];if(W!=null){a("#multiselected_panel").hide();if(W!=null)switch(W.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();
break;case "g":case "a":w=null;for(var D=W.getElementsByTagName("*"),G=0,K=D.length;G<K;G++){var T=D[G].getAttribute("stroke-width");if(G===0)w=T;else if(w!==T)w=null}a("#stroke_width").val(w===null?"0":w);ta();break;default:a("#stroke_width").val(W.getAttribute("stroke-width")||0);w=W.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+w+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);
a.fn.dragInput.updateCursor(a("#blur")[0])}if(W!=null){w=(W.getAttribute("opacity")||1)*100;a("#group_opacity").val(w);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}ra.length&&a("#tools_top").addClass("multiselected")}else if(ra.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}e.runExtensions("selectedChanged",{elems:o,selectedElement:W,
multiselected:ra})});e.bind("transition",function(d,o){var w=e.getMode(),D=o[0];if(D){ra=o.length>=2&&o[1]!=null?o:null;if(!ra)switch(w){case "rotate":w=e.getRotationAngle(D);a("#angle").val(Math.round(w));rotateCursor(w);a("#tool_reorient").toggleClass("disabled",w==0)}e.runExtensions("elementTransition",{elems:o})}});e.bind("changed",function(d,o){var w=e.getMode();w==="select"&&aa();for(var D=0;D<o.length;++D){var G=o[D];if(G&&G.tagName==="svg")v();else if(G&&W&&W.parentNode==null)W=G}q.show_save_warning=
true;ta();if(W&&w==="select"){q.paintBox.fill.update();q.paintBox.stroke.update()}e.runExtensions("elementChanged",{elems:o})});e.bind("saved",function(d,o){q.show_save_warning=false;o='<?xml version="1.0"?>\n'+o;var w=navigator.userAgent;if(~w.indexOf("MSIE"))Ab(0,true);else{var D=d.open("data:image/svg+xml;base64,"+N.encode64(o)),G=a.pref("save_notice_done");if(G!=="all"){var K=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(w.indexOf("Gecko/")!==-1)if(o.indexOf("<defs")!==-1){K+=
"\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done","all");G="all"}else a.pref("save_notice_done","part");else a.pref("save_notice_done","all");G!=="part"&&D.alert(K)}}});e.bind("exported",function(d,o){var w=o.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var D=a("#export_canvas")[0];D.width=e.contentW;D.height=e.contentH;canvg(D,o.svg,{renderCallback:function(){var G=D.toDataURL("image/png");O.location.href=G;if(a.pref("export_notice_done")!==
"all"){G=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(w.length)G+="\n\n"+uiStrings.notification.noteTheseIssues+"\n \u2022 "+w.join("\n \u2022 ");a.pref("export_notice_done","all");O.alert(G)}}})});e.bind("zoomed",V);e.bind("contextset",function(d,o){var w="";if(o){var D="";w='<a href="#" data-root="y">'+e.getCurrentDrawing().getCurrentLayerName()+"</a>";a(o).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){D+=" > "+this.id;w+=this!==o?' > <a href="#">'+this.id+
"</a>":" > "+this.id}});da=D}else da=null;a("#cur_context_panel").toggle(!!o).html(w)});e.bind("extension_added",function(d,o){function w(){if(Ga){clearTimeout(Ga);Ga=null}G||(Ga=setTimeout(function(){G=true;jb(h.iconsize)},50))}var D=false,G=false,K=true,T=function(){if(o.callback&&!D&&K){D=true;o.callback()}},Y=[];o.context_tools&&a.each(o.context_tools,function(Aa,ga){var Ba=ga.container_id?' id="'+ga.container_id+'"':"",ya=a("#"+ga.panel);ya.length||(ya=a("<div>",{id:ga.panel}).appendTo("#tools_top").hide());
switch(ga.type){case "tool_button":var za='<div class="tool_button">'+ga.id+"</div>",La=a(za).appendTo(ya);ga.events&&a.each(ga.events,function(Pa,mb){a(La).bind(Pa,mb)});break;case "select":za="<label"+Ba+'><select id="'+ga.id+'">';a.each(ga.options,function(Pa,mb){za+='<option value="'+Pa+'"'+(Pa==ga.defval?" selected":"")+">"+mb+"</option>"});za+="</select></label>";var ab=a(za).appendTo(ya).find("select");a.each(ga.events,function(Pa,mb){a(ab).bind(Pa,mb)});break;case "button-select":za='<div id="'+
ga.id+'" class="dropdown toolset" title="'+ga.title+'"><div id="cur_'+ga.id+'" class="icon_label"></div><button></button></div>';Ba=a('<ul id="'+ga.id+'_opts"></ul>').appendTo("#option_lists");ga.colnum&&Ba.addClass("optcols"+ga.colnum);a(za).appendTo(ya).children();Y.push({elem:"#"+ga.id,list:"#"+ga.id+"_opts",title:ga.title,callback:ga.events.change,cur:"#cur_"+ga.id});break;case "input":za="<label"+Ba+'><span id="'+ga.id+'_label">'+ga.label+':</span><input id="'+ga.id+'" title="'+ga.title+'" size="'+
(ga.size||"4")+'" value="'+(ga.defval||"")+'" type="text"/></label>';var Xa=a(za).appendTo(ya).find("input");ga.spindata&&Xa.SpinButton(ga.spindata);ga.events&&a.each(ga.events,function(Pa,mb){Xa.bind(Pa,mb)})}});if(o.buttons){var S={},Z={},ba=o.svgicons,oa={};a.each(o.buttons,function(Aa,ga){for(var Ba,ya=ga.id,za=Aa;a("#"+ya).length;)ya=ga.id+"_"+ ++za;if(ba){S[ya]=ga.icon;za=ga.svgicon?ga.svgicon:ga.id;if(ga.type=="app_menu")Z["#"+ya+" > div"]=za;else Z["#"+ya]=za}else Ba=ga.type=="menu"?"":a('<img src="'+
ga.icon+'">');var La,ab;switch(ga.type){case "mode_flyout":case "mode":La="tool_button";if(ga.cls)La+=" "+ga.cls;ab="#tools_left";break;case "context":La="tool_button";ab="#"+ga.panel;a(ab).length||a("<div>",{id:ga.panel}).appendTo("#tools_top");break;case "menu":La="menu_item tool_button";ab="#"+(ga.after||ga.panel);break;case "app_menu":La="";ab=ga.parent||"#main_menu ul";a(ab).length||a("<div>",{id:ga.panel}).appendTo("#tools_top")}var Xa=a(ga.list||ga.type=="app_menu"?"<li/>":"<div/>").attr("id",
ya).attr("title",ga.title).addClass(La);if(!ga.includeWith&&!ga.list){if("position"in ga)a(ab).children().eq(ga.position).before(Xa);else ga.type!="menu"||!ga.after?Xa.appendTo(ab):a(ab).after(Xa);if(ga.type=="mode_flyout"){za=a(Xa);La=za.parent();if(!za.parent().hasClass("tools_flyout")){var Pa=za[0].id.replace("tool_","tools_"),mb=za.clone().attr("id",Pa+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));za.before(mb);La=la(Pa,za);La.data("isLibrary",true);mb.data("isLibrary",true)}Z["#"+
Pa+"_show"]=ga.id;ya=oa["#"+La[0].id]=[{sel:"#"+ya,fn:ga.events.click,icon:ga.id,isDefault:true},yb]}else if(ga.type=="app_menu"||ga.type=="menu")Xa.append(ga.title)}else if(ga.list){Xa.addClass("push_button");a("#"+ga.list+"_opts").append(Xa);if(ga.isDefault){a("#cur_"+ga.list).append(Xa.children().clone());za=ga.svgicon?ga.svgicon:ga.id;Z["#cur_"+ga.list]=za}}else if(ga.includeWith){ab=ga.includeWith;za=a(ab.button);La=za.parent();if(!za.parent().hasClass("tools_flyout")){Pa=za[0].id.replace("tool_",
"tools_");mb=za.clone().attr("id",Pa+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));za.before(mb);La=la(Pa,za)}var yb=H.getButtonData(ab.button);if(ab.isDefault)Z["#"+Pa+"_show"]=ga.id;ya=oa["#"+La[0].id]=[{sel:"#"+ya,fn:ga.events.click,icon:ga.id,key:ga.key,isDefault:ga.includeWith?ga.includeWith.isDefault:0},yb];Pa="position"in ab?ab.position:"last";yb=La.children().length;if(!isNaN(Pa)&&Pa>=0&&Pa<yb)La.children().eq(Pa).before(Xa);else{La.append(Xa);ya.reverse()}}ba||Xa.append(Ba);
ga.list||a.each(ga.events,function(Db,Nb){if(Db=="click")if(ga.type=="mode"){ga.includeWith?Xa.bind(Db,Nb):Xa.bind(Db,function(){Va(Xa)&&Nb()});if(ga.key){a(document).bind("keydown",ga.key,Nb);ga.title&&Xa.attr("title",ga.title+" ["+ga.key+"]")}}else Xa.bind(Db,Nb);else Xa.bind(Db,Nb)});qa(oa)});a.each(Y,function(){Wa(this.elem,this.list,this.callback,{seticon:true})});if(ba)K=false;a.svgIcons(ba,{w:27,h:27,id_match:false,no_img:!A,fallback:S,placement:Z,callback:function(){h.iconsize&&h.iconsize!=
"m"&&w();K=true;T()}})}T()});e.textActions.setInputElem(a("#text")[0]);var wa='<div class="palette_item transparent" data-rgb="none"></div>\t\t\t\t\t\t\t\t<div class="palette_item black" data-rgb="#000000"></div>\t\t\t\t\t\t\t\t<div class="palette_item white" data-rgb="#ffffff"></div>';["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D",
"#6F5C2A","#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB","#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC",
"#FFAAB8","#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(d){wa+='<div class="palette_item" style="background-color: '+d+';" data-rgb="'+d+'"></div>'});a("#palette").append(wa);var Ha=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(d){d="rotate("+d+"deg)";Ha.css({"-webkit-transform":d,"-moz-transform":d,
"-o-transform":d,"-ms-transform":d,transform:d})};var va=function(d){var o=d.value/100;if(o<0.001)d.value=0.1;else{d=e.getZoom();var w=P;V(window,{width:0,height:0,x:(w[0].scrollLeft+w.width()/2)/d,y:(w[0].scrollTop+w.height()/2)/d,zoom:o},true)}};a("#stroke_style").change(function(){e.setStrokeAttr("stroke-dasharray",a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){e.setSegType(a(this).val());
a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){e.setFontFamily(this.value)});a("#text").keyup(function(){e.setTextContent(this.value)});changeAttribute=function(d){var o=d.getAttribute("data-attr"),w=d.getAttribute("data-multiplier")||1;w=parseFloat(w);w=d.value*w;if(!svgedit.units.isValidUnit(o,w,W)){a.alert(uiStrings.notification.invalidAttrValGiven);d.value=W.getAttribute(o);return false}e.changeSelectedAttributeNoUndo(o,
w)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(d){d.preventDefault();if(d.type=="mousedown")picking=true;if(picking){var o=a("#tool_stroke").hasClass("active"),w=o?"stroke":"fill",D=a(this).attr("data-rgb"),G=null,K=true;if(d.type=="mousedown")K=false;if(D==="transparent"||D==="initial"||D==="#none"){D="none";G=new a.jGraduate.Paint}else G=new a.jGraduate.Paint({alpha:100,solidColor:D.substr(1)});
q.paintBox[w].setPaint(G);if(o){e.setColor("stroke",D,K);D!="none"&&e.getStrokeOpacity()!=1&&e.setPaintOpacity("stroke",1)}else{e.setColor("fill",D,K);D!="none"&&e.getFillOpacity()!=1&&e.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(d){d.preventDefault()});a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");k()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");k()});var Va=function(d,o){if(a(d).hasClass("disabled"))return false;
if(a(d).parent().hasClass("tools_flyout"))return true;var w=w||"normal";o||a(".tools_flyout").fadeOut(w);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(d).addClass("tool_button_current").removeClass("tool_button");return true};(function(){var d=null,o=null,w=P[0],D=false,G=false;a("#svgcanvas").on("mousemove mouseup touchend",function(K){if(D!==false){w.scrollLeft-=K.clientX-d;w.scrollTop-=K.clientY-o;d=K.clientX;o=K.clientY;if(K.type===
"mouseup"||K.type==="touchend")D=false;return false}}).on("mousedown touchmove",function(K){if(K.button===1||G===true||K.originalEvent.touches&&K.originalEvent.touches.length>=2){D=true;d=K.clientX;o=K.clientY;return false}});a(window).mouseup(function(){D=false});a(document).bind("keydown","space",function(K){K.preventDefault();e.spaceKey=G=true}).bind("keyup","space",function(K){K.preventDefault();e.spaceKey=G=false}).bind("keydown","alt",function(){e.getMode()==="zoom"&&P.addClass("out")}).bind("keyup",
"alt",function(){e.getMode()==="zoom"&&P.removeClass("out")})})();var ub=a(".menu"),fb=function(d){d.target.style.background="#fff";setTimeout(function(){d.target.style.background="#ddd"},50);setTimeout(function(){d.target.style.background="#fff"},150);setTimeout(function(){d.target.style.background="#ddd"},200);setTimeout(function(){d.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(d){fb(d)});
a("svg, body").on("mousedown  touchstart",function(d){if(!(d.target.nodeName&&d.target.nodeName.toLowerCase()==="input"))if(!a(d.target).hasClass("menu_title")&&!a(d.target).parent().hasClass("menu_title"))!a(d.target).hasClass("disabled")&&a(d.target).hasClass("menu_item")?fb(d):a("#menu_bar").removeClass("active")});a("#workarea").on("mousewheel",function(d,o,w,D){if(d.altKey){d.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+D*10)).change()}});a(".menu_title").on("mousedown",
function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");ub.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){ub.removeClass("open");a(this).parent().addClass("open")});q.addDropDown=function(d,o,w){if(a(d).length!=0){var D=a(d).find("button"),G=a(d).find("ul").attr("id",a(d)[0].id+"-list");w||a("#option_lists").append(G);var K=false;w&&a(d).addClass("dropup");G.find("li").bind("mouseup",o);a(window).mouseup(function(){if(!K){D.removeClass("down");
G.hide()}K=false});D.bind("mousedown",function(){if(D.hasClass("down")){D.removeClass("down");G.hide()}else{D.addClass("down");if(!w){var T=a(d).offset();G.css({top:T.top,left:T.left-110})}G.show();K=true}}).hover(function(){K=true}).mouseout(function(){K=false})}};var Wa=function(d,o,w,D){var G=a(d);o=a(o);var K=false,T=D.dropUp;T&&a(d).addClass("dropup");o.find("li").bind("mouseup",function(){if(D.seticon){Mb("#cur_"+G[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}w.apply(this,
arguments)});a(window).mouseup(function(){if(!K){G.removeClass("down");o.hide();o.css({top:0,left:0})}K=false});o.height();a(d).bind("mousedown",function(){var Y=a(d).offset();if(T){Y.top-=o.height();Y.left+=8}else Y.top+=a(d).height();a(o).offset(Y);if(G.hasClass("down")){G.removeClass("down");o.hide();o.css({top:0,left:0})}else{G.addClass("down");o.show();K=true;return false}}).hover(function(){K=true}).mouseout(function(){K=false});D.multiclick&&o.mousedown(function(){K=true})};a("#font_family_dropdown").change(function(){var d=
this.options[this.selectedIndex].value,o=this.options[this.selectedIndex].text;a("#preview_font").html(o).css("font-family",d);a("#font_family").val(d).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var d=this.id.replace("tool_pos","").charAt(0);e.alignSelectedElements(d,"page")})});(function(){var d,o=function(){a(d).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){d=this;pa="toolbars";P.mousedown(o)}).blur(function(){pa=
"canvas";P.unbind("mousedown",o);e.getMode()=="textedit"&&a("#text").focus()})})();var Ya=function(){Va("#tool_select")&&e.setMode("select")},Da=function(){Va("#tool_fhpath")&&e.setMode("fhpath")},ua=function(){Va("#tool_line")&&e.setMode("line")},db=function(){Va("#tool_rect")&&e.setMode("rect")},Ka=function(){Va("#tool_ellipse")&&e.setMode("ellipse")},Ua=function(){Va("#tool_image")&&e.setMode("image")},Ea=function(){Va("#tool_zoom")&&e.setMode("zoom")},hb=function(){if(Va("#tool_zoom")){zb();aa()}},
qb=function(){Va("#tool_text")&&e.setMode("text")},Za=function(){Va("#tool_path")&&e.setMode("path")},$a=function(){if(W!=null||ra)e.deleteSelectedElements();L.getNodePoint()&&L.deletePathNode()},vb=function(){if(W!=null||ra){Ra(a("#edit_menu"));e.cutSelectedElements()}},sa=function(){if(W!=null||ra){Ra(a("#edit_menu"));e.copySelectedElements()}},kb=function(){Ra(a("#edit_menu"));var d=e.getZoom(),o=(P[0].scrollLeft+P.width()/2)/d-e.contentW;d=(P[0].scrollTop+P.height()/2)/d-e.contentH;e.pasteElements("point",
o,d)},gb=function(){if(W!=null){Ra(a("#object_menu"));e.moveToTopSelectedElement()}},tb=function(){if(W!=null){Ra(a("#object_menu"));e.moveToBottomSelectedElement()}},lb=function(){if(W!=null){Ra(a("#object_menu"));e.moveUpDownSelected("Up")}},eb=function(){if(W!=null){Ra(a("#object_menu"));e.moveUpDownSelected("Down")}},nb=function(d){if(W!=null){Ra(a("#object_menu"));e.moveUpDownSelected(d)}},rb=function(){if(W!=null){e.convertToPath();var d=e.getSelectedElems();e.selectorManager.requestSelector(d[0]).reset(d[0]);
e.selectorManager.requestSelector(d[0]).selectorRect.setAttribute("display","none");e.setMode("pathedit");L.toEditMode(d[0]);e.clearSelection();ta()}},wb=function(){W!=null&&L.reorient()},xb=function(){if(W!=null||ra)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",function(d){d&&e.makeHyperlink(d)})},ia=function(d,o){if(W!=null||ra){if(curConfig.gridSnapping){var w=e.getZoom()*curConfig.snappingStep;d*=w;o*=w}a("input").blur();e.moveSelectedElements(d,o)}},ca=function(){},ka=function(){L.getNodePoint()&&
L.clonePathNode()},M=function(){L.getNodePoint()&&L.deletePathNode()},R=function(){var d=a("#tool_add_subpath"),o=!d.hasClass("push_button_pressed");o?d.addClass("push_button_pressed").removeClass("tool_button"):d.removeClass("push_button_pressed").addClass("tool_button");L.addSubPath(o)},ea=function(){L.opencloseSubPath()},Fa=function(){e.cycleElement(1)},Oa=function(){e.cycleElement(0)},Sa=function(d,o){if(!(W==null||ra)){d||(o*=-1);var w=a("#angle").val()*1+o;e.setRotationAngle(w);ta()}},cb=function(){var d=
curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(o){if(o){aa();e.clear();e.setResolution(d[0],d[1]);v(true);zb();ta();X();e.runExtensions("onNewDocument")}})},pb=function(){e.setBold(!e.getBold());ta()},Ta=function(){e.setItalic(!e.getItalic());ta()},ob=function(){if(!f.pngsave){var d=uiStrings.notification.loadingImage;O=window.open("data:text/html;charset=utf-8,<title>"+d+"</title><h1>"+d+"</h1>")}window.canvg?e.rasterExport():a.getScript("canvg/rgbcolor.js",function(){a.getScript("canvg/canvg.js",
function(){e.rasterExport()})})},Qa=function(){e.open()},sb=function(){},Ra=function(d){var o=d.prev();o.css({background:"white",color:"black"});setTimeout(function(){o.removeAttr("style")},200)},Fb=function(){if(Q.getUndoStackSize()>0){Ra(a("#edit_menu"));Q.undo()}},Eb=function(){if(Q.getRedoStackSize()>0){Ra(a("#edit_menu"));Q.redo()}},bb=function(){if(ra){Ra(a("#object_menu"));e.groupSelectedElements()}else if(W){Ra(a("#object_menu"));e.ungroupSelectedElement()}},Ma=function(){Ra(a("#edit_menu"));
e.cloneSelectedElements(20,20)},Ob=function(){var d=this.id.replace("tool_align","").charAt(0);e.alignSelectedElements(d,a("#align_relative_to").val())},Kb=function(){var d=document.querySelector("#tool_stroke rect");a("#tool_stroke").toggleClass("active");a("#tool_fill").toggleClass("active");var o=document.querySelector("#tool_fill rect"),w=o.getAttribute("fill"),D=d.getAttribute("fill");d=parseFloat(d.getAttribute("stroke-opacity"));if(isNaN(d))d=100;o=parseFloat(o.getAttribute("fill-opacity"));
if(isNaN(o))o=100;D=Ia(D,d,"stroke");w=Ia(w,o,"fill");q.paintBox.fill.setPaint(D,true);q.paintBox.stroke.setPaint(w,true)},zb=function(d){var o=e.getResolution();d=d?o.zoom*d:1;a("#zoom").val(d*100);e.setZoom(d);Jb();v(true)},Lb=function(){Ra(a("#view_menu"));!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");P.toggleClass("wireframe");if(!B){var d=a("#wireframe_rules");d.length?d.empty():
a('<style id="wireframe_rules"></style>').appendTo("head");Jb()}},Pb=function(){Ra(a("#view_menu"));var d=!a("#tool_snap").hasClass("push_button_pressed");d?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");curConfig.gridSnapping=d},Bb=function(){window.self!=window.top&&top.exit_fullscreen()},Hb=function(){Ra(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",
false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},Jb=function(){if(!B){var d="#workarea.wireframe #svgcontent * { stroke-width: "+1/e.getZoom()+"px; }";a("#wireframe_rules").text(P.hasClass("wireframe")?d:"")}},Ab=function(d,o){if(!ja){Ra(a("#view_menu"));ja=true;a("#save_output_btns").toggle(!!o);a("#tool_source_back").toggle(!o);var w=fa=e.getSvgString();
a("#svg_source_textarea").val(w);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},ib=function(){if(ja){if(e.setSvgString(a("#svg_source_textarea").val())){e.clearSelection();g();zb();X()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,function(d){if(!d)return false;e.clearSelection();g();zb();X()});aa()}},Mb=q.setIcon=function(d,o){var w=typeof o==="string"?a.getSvgIcon(o,true):o.clone();w?a(d).find("img").replaceWith(w):console.log("NOTE: Icon image missing: "+
o)},Ib;Ib=function(){var d=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,o=document.getElementsByTagName("script")[0],w;for(w in o.style)if(d.test(w))return w.match(d)[0];if("WebkitOpacity"in o.style)return"Webkit";if("KhtmlOpacity"in o.style)return"Khtml";return""}();var Cb=function(d,o){Ib.toLowerCase();var w=["top","left","bottom","right"];d.each(function(){for(var D=a(this),G=D.outerWidth()*(o-1),K=D.outerHeight()*(o-1),T=0;T<4;T++){var Y=w[T],S=D.data("orig_margin-"+Y);if(S==null){S=parseInt(D.css("margin-"+
Y));D.data("orig_margin-"+Y,S)}S=S*o;if(Y==="right")S+=G;else if(Y==="bottom")S+=K;D.css("margin-"+Y,S)}})},jb=q.setIconSize=function(d,o){if(!(d==h.size&&!o)){var w=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout"),D=1;D=typeof d=="number"?d:{s:0.75,m:1,l:1.25,xl:1.5}[d];q.tool_scale=ha=D;ma();var G=w.parents(":hidden");G.css("visibility","hidden").show();
Cb(w,D);G.css("visibility","visible").hide();w=a("#tool_size_rules");if(w.length)w.empty();else w=a('<style id="tool_size_rules"></style>').appendTo("head");if(d!="m"){var K="";a.each(cssResizeRules,function(T,Y){T="#svg_editor "+T.replace(/,/g,", #svg_editor");K+=T+"{";a.each(Y,function(S,Z){if(typeof Z==="number")var ba=Z*D+"px";else if(Z[d]||Z.all)ba=Z[d]||Z.all;K+=S+":"+ba+";"});K+="}"});G="-"+Ib.toLowerCase()+"-";K+="#tools_top .toolset, #editor_panel > *, #history_panel > *,\t\t\t\t#main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,\t\t\t\t#g_panel > *, #tool_font_size > *, .tools_flyout{"+
G+"transform: scale("+D+");} #svg_editor div.toolset .toolset {"+G+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+G+"transform: scale("+1/D+");}";w.text(K)}ma()}},Gb=function(){a("#dialog_box").hide();if(ja){if(ja)fa!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(d){d&&g()}):g();k()}else da&&e.leaveContext()},g=function(){a("#svg_source_editor").hide();ja=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();
var k=a.noop;a(window).resize(function(){v()});(function(){P.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=P[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=P[0].scrollTop})})();a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var d=e.getHref(W);d=d.indexOf("data:")===0?"":d;a.prompt(uiStrings.notification.enterNewImgURL,d,function(o){o&&Na(o)})});var m=function(d){var o=d[0].id=="stroke_color"?"stroke":
"fill",w=d[0].id=="canvas_color";if(w)o="canvas";var D=q.paintBox[o].paint;d=o=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";w=w?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).removeAttr("style").css(w).jGraduate({paint:D,window:{pickerTitle:d},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(G){D=new a.jGraduate.Paint(G);q.paintBox[o].setPaint(D);
e.setPaint(o,D);a("#color_picker").hide()},function(){a("#color_picker").hide()})};s=function(d,o){var w=document.getElementById("canvas_background"),D={color:"fff",opacity:1};if(o=="stroke")D=curConfig.initStroke;if(o=="fill")D=curConfig.initFill;if(o=="canvas"&&w)if(w=w.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))D={color:("0"+parseInt(w[1],10).toString(16)).slice(-2)+("0"+parseInt(w[2],10).toString(16)).slice(-2)+("0"+parseInt(w[3],10).toString(16)).slice(-2),opacity:1};w=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"\t\t\t\t\tfill="#'+
D.color+'" opacity="'+D.opacity+'"/>\t\t\t\t\t<defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;w=a(d)[0].appendChild(document.importNode(w,true));o==="canvas"?w.setAttribute("width",60.5):w.setAttribute("width","100%");this.rect=w.firstChild;this.defs=w.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:D.color});this.type=o;this.setPaint=function(G,K){this.paint=G;var T="none",Y=G.type,S=G.alpha/100;switch(Y){case "solidColor":T=
G[Y]=="none"||G[Y]=="one"?"none":"#"+G[Y];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(G[Y]);T="url(#"+(this.grad.id="gradbox_"+this.type)+")"}this.rect.setAttribute("fill",T);this.rect.setAttribute("opacity",S);if(this.type=="canvas")if(Y=document.getElementById("canvas_background")){xa=e.getResolution();Y.setAttribute("x",-1);Y.setAttribute("y",-1);Y.setAttribute("width",xa.w+2);Y.setAttribute("height",xa.h+2);T.indexOf("url")==
-1&&Y.setAttribute("fill",T)}else Ja(T);if(K){e.setColor(this.type,T,true);e.setPaintOpacity(this.type,S,true)}};this.update=function(G){if(W){var K=this.type;switch(W.tagName){case "use":case "image":case "foreignObject":return;case "g":case "a":for(var T=null,Y=W.getElementsByTagName("*"),S=0,Z=Y.length;S<Z;S++){var ba=Y[S].getAttribute(K);if(S===0)T=ba;else if(T!==ba){T=null;break}}if(T===null){Y=null;return}Y=T;T=1;break;default:T=parseFloat(W.getAttribute(K+"-opacity"));if(isNaN(T))T=1;Y=K===
"fill"?"black":"none";Y=W.getAttribute(K)||Y}if(G){e.setColor(K,Y,true);e.setPaintOpacity(K,T,true)}T*=100;this.setPaint(Ia(Y,T,K))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var G=new a.jGraduate.Paint({copy:this.paint});e.setPaint(o,G)}}};q.paintBox.fill=new s("#fill_color","fill");q.paintBox.stroke=new s("#stroke_color","stroke");q.paintBox.canvas=new s("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*
100);s=q.paintBox.fill.rect.cloneNode(false);s.setAttribute("style","vector-effect:non-scaling-stroke");var B=s.style.vectorEffect==="non-scaling-stroke";s.removeAttribute("style");s=q.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");typeof s.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(s).remove();setTimeout(function(){e.embedImage("images/placeholder.svg",function(d){if(!d){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);
h.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))m(a("#fill_color"));else{a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))m(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",
function(){m(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");m(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active");m(a("#fill_color"))});a("#zoom_select").on("change",function(){var d=this.options[this.selectedIndex].text;d=d.split("%")[0];a("#zoom").val(d).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||
a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});a(window).bind("load resize",function(){P.css("line-height",P.height()+"px")});var z=function(){var d=a("#canvas_width"),o=a("#canvas_height"),w=d.val(),D=o.val();if(w!="fit"&&!svgedit.units.isValidUnit("width",w)){a.alert(uiStrings.notification.invalidAttrValGiven);
d.parent().addClass("error");return false}d.parent().removeClass("error");if(D!="fit"&&!svgedit.units.isValidUnit("height",D)){a.alert(uiStrings.notification.invalidAttrValGiven);o.parent().addClass("error");return false}o.parent().removeClass("error");if(!e.setResolution(w,D)){a.alert(uiStrings.notification.noContentToFitTo);w=e.getResolution();d.val(w.w);o.val(w.h);return false}v()};a("#resolution").change(function(){var d=a("#canvas_width")[0],o=a("#canvas_height")[0];if(this.selectedIndex)if(this.value==
"content"){d.value="fit";o.value="fit";z();var w=e.getResolution();d.value=w.w;o.value=w.h}else{var D=this.value.split("x");D[0]=parseInt(D[0]);D[1]=parseInt(D[1]);var G=D[0]-d.value,K=D[1]-o.value,T=Date.now(),Y=function(){var S=(Date.now()-T)/1E3;S=Math.pow(S-1,3)+1;d.value=(D[0]-G+S*G).toFixed(0);o.value=(D[1]-K+S*K).toFixed(0);z();if(S>=1){S=e.getResolution();a("#canvas_width").val(S.w.toFixed());a("#canvas_height").val(S.h.toFixed());a("#resolution_label").html("<div class='pull'>"+S.w+"<span>\u00d7</span></br>"+
S.h+"</div>")}else requestAnimationFrame(Y)};Y()}else{a("#resolution_label").html("Custom");d.removeAttribute("readonly");d.focus();d.select();if(d.value=="fit"){d.value=100;o.value=100}}});a("#zoom").change(function(){va(this)});a("input,select").attr("autocomplete","off");var H=function(){var d=[{sel:"#tool_select",fn:Ya,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Da,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:ua,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:db,evt:"click",key:["R",
true],icon:"rect"},{sel:"#tool_ellipse",fn:Ka,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:Za,evt:"click",key:["P",true]},{sel:"#tool_text",fn:qb,evt:"click",key:["T",true]},{sel:"#tool_image",fn:Ua,evt:"mouseup"},{sel:"#tool_zoom",fn:Ea,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:cb,evt:"mouseup",key:[p+"N",true]},{sel:"#tool_save",fn:function(){if(ja)ib();else{Ra(a("#file_menu"));e.save({images:h.img_save,round_digits:6})}},evt:"mouseup",key:[p+"S",true]},{sel:"#tool_reload",
fn:function(){if(ja)ib();else{Ra(a("#file_menu"));var w=e.getSvgString();u.readyState!=WebSocket.OPEN&&l();u.send(w)}},evt:"mouseup",key:[p+"E",true]},{sel:"#tool_export",fn:ob,evt:"mouseup"},{sel:"#tool_open",fn:Qa,evt:"mouseup"},{sel:"#tool_import",fn:sb,evt:"mouseup"},{sel:"#tool_source",fn:Ab,evt:"click",key:[p+"U",true]},{sel:"#tool_wireframe",fn:Lb,evt:"click"},{sel:"#tool_snap",fn:Pb,evt:"click"},{sel:"#tool_rulers",fn:Hb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",
fn:Gb,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:ib,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",fn:$a,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:wb,evt:"click"},{sel:"#tool_node_link",fn:ca,evt:"change"},{sel:"#tool_node_clone",fn:ka,evt:"click"},{sel:"#tool_node_delete",fn:M,evt:"click"},{sel:"#tool_openclose_path",fn:ea,evt:"click"},{sel:"#tool_add_subpath",fn:R,evt:"click"},{sel:"#tool_move_top",fn:gb,evt:"click",key:p+"shift+up"},
{sel:"#tool_move_bottom",fn:tb,evt:"click",key:p+"shift+down"},{sel:"#tool_move_up",fn:lb,evt:"click",key:[p+"up",true]},{sel:"#tool_move_down",fn:eb,evt:"click",key:[p+"down",true]},{sel:"#tool_topath",fn:rb,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:xb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:Ma,evt:"click",key:[p+"D",true]},{sel:"#tool_group",fn:bb,evt:"click",key:[p+"G",true]},{sel:"#tool_ungroup",fn:bb,evt:"click",key:p+"shift+G"},{sel:"#tool_unlink_use",fn:bb,evt:"click"},
{sel:"[id^=tool_align]",fn:Ob,evt:"click"},{sel:"#tool_undo",fn:Fb,evt:"click",key:p+"z"},{sel:"#tool_redo",fn:Eb,evt:"click",key:["y",true]},{sel:"#tool_cut",fn:vb,evt:"click",key:[p+"x",true]},{sel:"#tool_copy",fn:sa,evt:"click",key:p+"c"},{sel:"#tool_paste",fn:kb,evt:"click",key:p+"v"},{sel:"#tool_switch",fn:Kb,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:pb,evt:"mousedown",key:[p+"B",true]},{sel:"#tool_italic",fn:Ta,evt:"mousedown",key:[p+"I",true]},{sel:"#copy_save_done",fn:Gb,evt:"click"},
{key:"ctrl+left",fn:function(){Sa(0,1)}},{key:"ctrl+right",fn:function(){Sa(1,1)}},{key:"ctrl+shift+left",fn:function(){Sa(0,5)}},{key:"ctrl+shift+right",fn:function(){Sa(1,5)}},{key:"shift+O",fn:Oa},{key:"shift+P",fn:Fa},{key:[p+"+",true],fn:function(){zb(2)}},{key:[p+"-",true],fn:function(){zb(0.5)}},{key:["up",true],fn:function(){ia(0,-1)}},{key:["down",true],fn:function(){ia(0,1)}},{key:["left",true],fn:function(){ia(-1,0)}},{key:["right",true],fn:function(){ia(1,0)}},{key:"shift+up",fn:function(){ia(0,
-10)}},{key:"shift+down",fn:function(){ia(0,10)}},{key:"shift+left",fn:function(){ia(-10,0)}},{key:"shift+right",fn:function(){ia(10,0)}},{key:["alt+up",true],fn:function(){e.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){e.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){e.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){e.cloneSelectedElements(1,0)}},{key:["alt+shift+up",true],fn:function(){e.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",
true],fn:function(){e.cloneSelectedElements(0,10)}},{key:["alt+shift+left",true],fn:function(){e.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){e.cloneSelectedElements(10,0)}},{key:p+"A",fn:function(){e.selectAllInCurrentLayer()}},{key:"I",fn:function(){var w=a(".tool_button_current");if(w.length&&w[0].id!=="tool_eyedropper"){w.removeClass("tool_button_current").addClass("tool_button");a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}e.setMode("eyedropper")}},
{key:p+"shift+z",fn:Eb},{key:"esc",fn:Bb}],o={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var w={};a.each(d,function(D,G){if(G.sel){var K=a(G.sel);if(K.length==0)return true;if(G.evt){if(svgedit.browser.isTouch()&&G.evt==="click")G.evt="mousedown";K[G.evt](G.fn)}if(G.parent&&a(G.parent+"_show").length!=0){var T=a(G.parent);T.length||(T=la(G.parent.substr(1)));T.append(K);a.isArray(w[G.parent])||(w[G.parent]=[]);w[G.parent].push(G)}}if(G.key){var Y=G.fn,
S=false;if(a.isArray(G.key)){T=G.key[0];if(G.key.length>1)S=G.key[1]}else T=G.key;T+="";svgedit.browser.isMac&&T.indexOf("+")!=-1&&T.split("+")[0]=="ctrl"&&T.replace("ctrl","cmd");a.each(T.split("/"),function(ba,oa){a(document).bind("keydown",oa,function(Aa){Y();S&&Aa.preventDefault();return false})});if(G.sel&&!G.hidekey&&K.attr("title")){var Z=K.attr("title").split("[")[0]+" ("+T+")";o[T]=G.sel;K.parents("#main_menu").length||K.attr("title",Z)}}});qa(w);a(window).bind("keydown","tab",function(D){if(pa===
"canvas"){D.preventDefault();Fa()}}).bind("keydown","shift+tab",function(D){if(pa==="canvas"){D.preventDefault();Oa()}});a("#tool_zoom").dblclick(hb)},setTitles:function(){a.each(o,function(w,D){var G=a(D).parents("#main_menu").length;a(D).each(function(){var K=G?a(this).text().split(" [")[0]:this.title.split(" [")[0],T="";a.each(w.split("/"),function(Y,S){var Z=S.split("+"),ba="";if(Z.length>1){ba=Z[0]+"+";S=Z[1]}T+=(Y?"/":"")+ba+(uiStrings["key_"+S]||S)});if(G)this.lastChild.textContent=K+" ["+
T+"]";else this.title=K+" ["+T+"]"})})},getButtonData:function(w){var D;a.each(d,function(G,K){if(K.sel===w)D=K});return D}}}();H.setAll();q.ready(function(){var d=curConfig.initTool,o=a("#tools_left, #svg_editor .tools_flyout"),w=o.find("#tool_"+d);d=o.find("#"+d);(w.length?w:d.length?d:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});a("#canvas_height").dragInput({min:10,max:null,
step:10,callback:z,cursor:false,dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:z,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});
a("#ellipse_rx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,max:null,step:1,callback:changeAttribute,
cursor:false});a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_width").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});
a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(d){var o=d.value;if(o==0&&W&&["line","polyline"].indexOf(W.nodeName)>=
0)o=d.value=1;e.setStrokeWidth(o)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(d){e.setRotationAngle(d.value,true);rotateCursor(d.value);a("#tool_reorient").toggleClass("disabled",d.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(d){e.setFontSize(d.value)},cursor:true,stepfunc:function(d,o){var w=d.value-0,D=w+o,G=D>=w;if(o===0)return w;return w>=24?G?Math.round(w*1.1):Math.round(w/
1.1):w<=1?G?w*2:w/2:D},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(d,o){val=d.value;a("#blur").val(val);o?e.setBlur(val,true):e.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(e.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(d){switch(d){case "delete":$a();break;case "cut":vb();break;case "copy":sa();break;case "paste":e.pasteElements();
break;case "paste_in_place":e.pasteElements("in_place");break;case "group":e.groupSelectedElements();break;case "ungroup":e.ungroupSelectedElement();break;case "move_front":gb();break;case "move_up":nb("Up");break;case "move_down":nb("Down");break;case "move_back":tb();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(d)&&svgedit.contextmenu.getCustomHandler(d).call()}});a(".contextMenu li").mousedown(function(d){d.preventDefault()});a("#cmenu_canvas li").disableContextMenu();
U.enableContextMenuItems("#delete,#cut,#copy");window.onbeforeunload=function(){if(Q.getUndoStackSize()===0)q.show_save_warning=false;if(!curConfig.no_save_warning&&q.show_save_warning)return uiStrings.notification.unsavedChanges};q.openPrep=function(d){a("#main_menu").hide();Q.getUndoStackSize()===0?d(true):a.confirm(uiStrings.notification.QwantToOpen,d)};if(window.FileReader){s=function(d){d.stopPropagation();d.preventDefault();a("#workarea").removeAttr("style");a("#main_menu").hide();var o=null;
if(o=d.type=="drop"?d.dataTransfer.files[0]:this.files[0])if(o.type.indexOf("image")!=-1)if(o.type.indexOf("svg")!=-1){d=new FileReader;d.onloadend=function(w){e.importSvgString(w.target.result,true);e.ungroupSelectedElement();e.ungroupSelectedElement();e.groupSelectedElements();e.alignSelectedElements("m","page");e.alignSelectedElements("c","page")};d.readAsText(o)}else{d=new FileReader;d.onloadend=function(w){insertNewImage=function(T,Y){var S=e.addSvgElementFromJson({element:"image",attr:{x:0,
y:0,width:T,height:Y,id:e.getNextId(),style:"pointer-events:inherit"}});e.setHref(S,w.target.result);e.selectOnly([S]);e.alignSelectedElements("m","page");e.alignSelectedElements("c","page");ta()};var D=100,G=100,K=new Image;K.src=w.target.result;document.body.appendChild(K);K.onload=function(){D=K.offsetWidth;G=K.offsetHeight;insertNewImage(D,G);document.body.removeChild(K)}};d.readAsDataURL(o)}};P=a("#workarea");P[0].addEventListener("dragenter",function(d){d.stopPropagation();d.preventDefault();
P.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);P[0].addEventListener("dragover",function(d){d.stopPropagation();d.preventDefault()},false);P[0].addEventListener("dragleave",function(d){P.removeAttr("style");d.stopPropagation();d.preventDefault()},false);P[0].addEventListener("drop",s,false);var C=a('<input type="file">').change(function(){var d=this;q.openPrep(function(o){if(o){e.clear();
if(d.files.length==1){o=new FileReader;o.onloadend=function(w){c(w.target.result);v()};o.readAsText(d.files[0])}}})});a("#tool_open").show().prepend(C);s=a('<input type="file">').change(s);a("#tool_import").show().prepend(s)}var v=q.updateCanvas=function(d,o){var w=P.width(),D=P.height(),G=w,K=D,T=e.getZoom(),Y=P,S=a("#svgcanvas"),Z={x:Y[0].scrollLeft+G/2,y:Y[0].scrollTop+K/2},ba=curConfig.canvas_expansion;w=Math.max(G,e.contentW*T*ba);D=Math.max(K,e.contentH*T*ba);w==G&&D==K?P.css("overflow","hidden"):
P.css("overflow","scroll");ba=S.height()/2;var oa=S.width()/2;S.width(w).height(D);var Aa=D/2,ga=w/2,Ba=e.updateCanvas(w,D),ya=ga/oa;w=w/2-G/2;D=D/2-K/2;if(o){o.x+=Ba.x;o.y+=Ba.y}else o={x:ga+(Z.x-oa)*ya,y:Aa+(Z.y-ba)*ya};if(d)if(e.contentW>Y.width()){P[0].scrollLeft=Ba.x-10;P[0].scrollTop=Ba.y-10}else{Y[0].scrollLeft=w;Y[0].scrollTop=D}else{Y[0].scrollLeft=o.x-G/2;Y[0].scrollTop=o.y-K/2}if(curConfig.showRulers){G=S;T=T;document.getElementById("workarea");document.getElementById("title_show");T||
(T=e.getZoom());G||(G=a("#svgcanvas"));K=e.getContentElem();Y=svgedit.units.getTypeMap()[curConfig.baseUnit];for(S=0;S<2;S++){oa=(Z=S===0)?"x":"y";ya=Z?"width":"height";ba=K.getAttribute(oa)-0;oa=a("#ruler_"+oa+" canvas:first");$hcanv=oa.clone();oa.replaceWith($hcanv);w=$hcanv[0];Aa=oa=G[ya]()*2;w.parentNode.style[ya]=Aa+"px";ga=0;var za;Ba=w.getContext("2d");Ba.fillStyle="rgb(200,0,0)";Ba.fillRect(0,0,w.width,w.height);$hcanv.siblings().remove();if(oa>=3E4){var La=parseInt(oa/3E4)+1;za=Array(La);
za[0]=Ba;for(D=1;D<La;D++){w[ya]=3E4;var ab=w.cloneNode(true);w.parentNode.appendChild(ab);za[D]=ab.getContext("2d")}ab[ya]=oa%3E4;oa=3E4}w[ya]=oa;ya=Y*T;var Xa=50/ya;w=1;for(D=0;D<F.length;D++){w=La=F[D];if(Xa<=La)break}Xa=w*ya;Ba.font="normal 9px 'Lucida Grande', sans-serif";Ba.fillStyle="#777";for(var Pa=ba/ya%w*ya,mb=Pa-Xa;Pa<Aa;Pa+=Xa){mb+=Xa;D=Math.round(Pa)+0.5;if(Z){Ba.moveTo(D,15);Ba.lineTo(D,0)}else{Ba.moveTo(15,D);Ba.lineTo(0,D)}La=(mb-ba)/ya;if(w>=1)D=Math.round(La);else{D=(w+"").split(".")[1].length;
D=La.toFixed(D)-0}if(D!==0&&D!==1E3&&D%1E3===0)D=D/1E3+"K";if(Z){Ba.fillText(D,Pa+2,8);Ba.fillStyle="#777"}else{La=(D+"").split("");for(D=0;D<La.length;D++){Ba.fillText(La[D],1,Pa+9+D*9);Ba.fillStyle="#777"}}La=Xa/10;for(D=1;D<10;D++){var yb=Math.round(Pa+La*D)+0.5;if(za&&yb>oa){ga++;Ba.stroke();if(ga>=za.length){D=10;Pa=Aa;continue}Ba=za[ga];Pa-=3E4;yb=Math.round(Pa+La*D)+0.5}var Db=D%2?12:10;if(Z){Ba.moveTo(yb,15);Ba.lineTo(yb,Db)}else{Ba.moveTo(15,yb);Ba.lineTo(Db,yb)}}}Ba.strokeStyle="#666";Ba.stroke()}P.scroll()}},
F=[];for(s=0.1;s<1E5;s*=10){F.push(1*s);F.push(2*s);F.push(5*s)}v(true);try{var I=function(d){if(window.JSON&&JSON.stringify)return JSON.stringify(d);var o=arguments.callee;if(typeof d=="boolean"||typeof d=="number")return d+"";else if(typeof d=="string")return'"'+d.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(d.length){for(var w=
0;w<d.length;w++)d[w]=o(d[w]);return"["+d.join(",")+"]"}else{w=[];for(var D in d)w.push(o(D)+":"+o(d[D]));return"{"+w.join(",")+"}"}};window.addEventListener("message",function(d){var o=parseInt(d.data.substr(0,d.data.indexOf(";")));try{d.source.postMessage("SVGe"+o+";"+I(eval(d.data)),"*")}catch(w){d.source.postMessage("SVGe"+o+";error:"+w.message,"*")}},false)}catch(E){window.embed_error=E}a(function(){window.svgCanvas=e;e.ready=methodDraw.ready});q.setLang=function(d,o){a.pref("lang",d);a("#lang_select").val(d);
if(o){e.runExtensions("langChanged",d);Ca();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(w,D){a(D).attr("title",a(w)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};var n=[];q.ready=function(s){b?s():n.push(s)};q.runCallbacks=function(){a.each(n,function(){this()});
b=true};q.loadFromString=function(s){q.ready(function(){c(s)})};q.loadFromURL=function(s,A){A||(A={});var p=A.cache,L=A.callback;q.ready(function(){a.ajax({url:s,dataType:"text",cache:!!p,success:function(Q){c(Q,L)},error:function(Q,N,J){Q.status!=404&&Q.responseText?c(Q.responseText,L):a.alert(uiStrings.notification.URLloadFail+": \n"+J+"",L)}})})};q.loadFromDataURI=function(s){q.ready(function(){var A=s.substring(26);c(svgedit.utilities.decode64(A))})};q.addExtension=function(){var s=arguments;
a(function(){e&&e.addExtension.apply(this,s)})};return q}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(l){return this.each(function(){this.repeating=false;this.dragCfg={min:l&&!isNaN(parseFloat(l.min))?Number(l.min):null,max:l&&!isNaN(parseFloat(l.max))?Number(l.max):null,step:l&&Number(l.step)?l.step:1,stepfunc:l&&l.stepfunc?l.stepfunc:false,dragAdjust:l&&l.dragAdjust?l.dragAdjust:1,height:70,cursor:l&&l.cursor?Boolean(l.cursor):false,start:l&&l.start?Number(l.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:l&&l.callback?l.callback:null};this.dragCfg.smallStep=
l&&l.smallStep?l.smallStep:this.dragCfg.step/2;var u=this.dragCfg.dragAdjust,a=$(this).parent(),c=$(this),e=this.dragCfg.height,q=this.dragCfg.min,b=this.dragCfg.max,h=this.dragCfg.step,f=b-q>0?(b-q)/h:200,n=f/e*h,s=0,A=this.getAttribute("data-attr"),p=methodDraw.canvas,L=svgedit.browser.isTouch(),Q=true,N=f&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(a):false;c.attr("readonly","readonly");N&&!isNaN(this.dragCfg.start)&&N.css("top",this.dragCfg.start*-1/n+e);this.adjustValue=
function(J,P){var U;J=parseFloat(J);U=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,J):Number((Number(this.value)+Number(J)).toFixed(5));if(b!==null)U=Math.min(U,b);if(q!==null)U=Math.max(U,q);N&&this.updateCursor(U);this.value=U;a.attr("data-value",U);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,P)};a.toggleClass("draginput",a.is("label"));this.move=function(J,P,U){if(L)J=J.originalEvent.touches[0];if(s===0)s=P;P=(J.pageY-s)*
-1;s=J.pageY;U=P*n*u;this.adjustValue(U.toFixed(h<1?1:0))};this.stop=function(){var J=p.getSelectedElems();$("body").removeClass("dragging");a.removeClass("active");Q=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");s=0;if(J[0]){J=p.undoMgr.finishUndoableChange();J.isEmpty()||p.undoMgr.addCommandToHistory(J)}this.adjustValue(0,Q)};this.updateCursor=function(){var J=parseFloat(this.value)*-1/n+e;N.css("top",J)};this.launch=function(J){var P=p.getSelectedElems();
if(L)J=J.originalEvent.touches[0];var U=J.pageY,O=this.value,ha=this;p.undoMgr.beginUndoableChange(A,P);$("body").addClass("dragging");a.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(pa){ha.move(pa,U,parseFloat(O))});$(window).bind("mouseup.draginput touchend.draginput",function(){ha.stop()})};$(this).attr("readonly","readonly").attr("data-scale",n).attr("data-domain",e).attr("data-cursor",N!=false).bind("mousedown touchstart",function(J){this.blur();this.launch(J)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(J){switch(J.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(J,P,U,O){P=p.getSelectedElems();Q&&p.undoMgr.beginUndoableChange(A,P);Q=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){ha.stop()},200);var ha=
this;if(O>0)this.adjustValue(this.dragCfg.step);else O<0&&this.adjustValue(-this.dragCfg.step);J.preventDefault()})})};$.fn.dragInput.updateCursor=function(l){var u=parseFloat(l.value),a=parseFloat(l.getAttribute("data-scale")),c=parseFloat(l.getAttribute("data-domain"));u=u*-1/a+c+"px";l=l.parentNode.lastChild;if(l.className=="draginput_cursor")l.style.top=u};svgedit=svgedit||{};
(function(){var l=this;if(!svgedit.contextmenu)svgedit.contextmenu={};l.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var u=contextMenuExtensions[menuItem];Object.keys(l.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var a=u.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+u.id+"'>"+u.label+"<span class='shortcut'>"+a+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){l.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(u){if(u&&u.id&&u.label&&u.action&&typeof u.action=="function")if(u.id in l.contextMenuExtensions)console.error('Cannot add extension "'+u.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+u.id+", label:"+u.label+"}");l.contextMenuExtensions[u.id]=u}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(u){return l.contextMenuExtensions[u]&&true};svgedit.contextmenu.getCustomHandler=function(u){return l.contextMenuExtensions[u].action}})();(function(l,u){function a(e){return!l(e).parents().andSelf().filter(function(){return l.curCSS(this,"visibility")==="hidden"||l.expr.filters.hidden(this)}).length}function c(e,q){var b=e.nodeName.toLowerCase();if("area"===b){b=e.parentNode;var h=b.name;if(!e.href||!h||b.nodeName.toLowerCase()!=="map")return false;b=l("img[usemap=#"+h+"]")[0];return!!b&&a(b)}return(/input|select|textarea|button|object/.test(b)?!e.disabled:"a"==b?e.href||q:q)&&a(e)}l.ui=l.ui||{};l.ui.version||(l.extend(l.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),l.fn.extend({propAttr:l.fn.prop||l.fn.attr,_focus:l.fn.focus,focus:function(e,q){return typeof e=="number"?this.each(function(){var b=
this;setTimeout(function(){l(b).focus();q&&q.call(b)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;l.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?e=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(l.curCSS(this,"position",1))&&/(auto|scroll)/.test(l.curCSS(this,"overflow",1)+l.curCSS(this,"overflow-y",1)+l.curCSS(this,"overflow-x",1))}).eq(0):e=this.parents().filter(function(){return/(auto|scroll)/.test(l.curCSS(this,
"overflow",1)+l.curCSS(this,"overflow-y",1)+l.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!e.length?l(document):e},zIndex:function(e){if(e!==u)return this.css("zIndex",e);if(this.length){e=l(this[0]);for(var q;e.length&&e[0]!==document;){q=e.css("position");if(q==="absolute"||q==="relative"||q==="fixed"){q=parseInt(e.css("zIndex"),10);if(!isNaN(q)&&q!==0)return q}e=e.parent()}}return 0},disableSelection:function(){return this.bind((l.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),l.each(["Width","Height"],function(e,q){function b(s,A,p,L){l.each(h,function(){A-=parseFloat(l.curCSS(s,"padding"+this,true))||0;p&&(A-=parseFloat(l.curCSS(s,"border"+this+"Width",true))||0);L&&(A-=parseFloat(l.curCSS(s,"margin"+this,true))||0)});return A}var h=q==="Width"?["Left","Right"]:["Top","Bottom"],f=q.toLowerCase(),n={innerWidth:l.fn.innerWidth,innerHeight:l.fn.innerHeight,
outerWidth:l.fn.outerWidth,outerHeight:l.fn.outerHeight};l.fn["inner"+q]=function(s){if(s===u)return n["inner"+q].call(this);return this.each(function(){l(this).css(f,b(this,s)+"px")})};l.fn["outer"+q]=function(s,A){if(typeof s!="number")return n["outer"+q].call(this,s);return this.each(function(){l(this).css(f,b(this,s,true,A)+"px")})}}),l.extend(l.expr[":"],{data:function(e,q,b){return!!l.data(e,b[3])},focusable:function(e){return c(e,!isNaN(l.attr(e,"tabindex")))},tabbable:function(e){var q=l.attr(e,
"tabindex"),b=isNaN(q);return(b||q>=0)&&c(e,!b)}}),l(function(){var e=document.body,q=e.appendChild(q=document.createElement("div"));l.extend(q.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});l.support.minHeight=q.offsetHeight===100;l.support.selectstart="onselectstart"in q;e.removeChild(q).style.display="none"}),l.extend(l.ui,{plugin:{add:function(e,q,b){e=l.ui[e].prototype;for(var h in b){e.plugins[h]=e.plugins[h]||[];e.plugins[h].push([q,b[h]])}},call:function(e,q,b){if((q=e.plugins[q])&&
e.element[0].parentNode)for(var h=0;h<q.length;h++)e.options[q[h][0]]&&q[h][1].apply(e.element,b)}},contains:function(e,q){return document.compareDocumentPosition?e.compareDocumentPosition(q)&16:e!==q&&e.contains(q)},hasScroll:function(e,q){if(l(e).css("overflow")==="hidden")return false;var b=q&&q==="left"?"scrollLeft":"scrollTop",h=false;if(e[b]>0)return true;e[b]=1;h=e[b]>0;e[b]=0;return h},isOverAxis:function(e,q,b){return e>q&&e<q+b},isOver:function(e,q,b,h,f,n){return l.ui.isOverAxis(e,b,f)&&
l.ui.isOverAxis(q,h,n)}}))})(jQuery);
(function(l,u){if(l.cleanData){var a=l.cleanData;l.cleanData=function(e){for(var q=0,b;(b=e[q])!=null;q++)try{l(b).triggerHandler("remove")}catch(h){}a(e)}}else{var c=l.fn.remove;l.fn.remove=function(e,q){return this.each(function(){q||(!e||l.filter(e,[this]).length)&&l("*",this).add([this]).each(function(){try{l(this).triggerHandler("remove")}catch(b){}});return c.call(l(this),e,q)})}}l.widget=function(e,q,b){var h=e.split(".")[0],f;e=e.split(".")[1];f=h+"-"+e;b||(b=q,q=l.Widget);l.expr[":"][f]=
function(n){return!!l.data(n,e)};l[h]=l[h]||{};l[h][e]=function(n,s){arguments.length&&this._createWidget(n,s)};q=new q;q.options=l.extend(true,{},q.options);l[h][e].prototype=l.extend(true,q,{namespace:h,widgetName:e,widgetEventPrefix:l[h][e].prototype.widgetEventPrefix||e,widgetBaseClass:f},b);l.widget.bridge(e,l[h][e])};l.widget.bridge=function(e,q){l.fn[e]=function(b){var h=typeof b=="string",f=Array.prototype.slice.call(arguments,1),n=this;b=!h&&f.length?l.extend.apply(null,[true,b].concat(f)):
b;if(h&&b.charAt(0)==="_")return n;h?this.each(function(){var s=l.data(this,e),A=s&&l.isFunction(s[b])?s[b].apply(s,f):s;if(A!==s&&A!==u){n=A;return false}}):this.each(function(){var s=l.data(this,e);s?s.option(b||{})._init():l.data(this,e,new q(b,this))});return n}};l.Widget=function(e,q){arguments.length&&this._createWidget(e,q)};l.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(e,q){l.data(q,this.widgetName,this);this.element=l(q);this.options=
l.extend(true,{},this.options,this._getCreateOptions(),e);var b=this;this.element.bind("remove."+this.widgetName,function(){b.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return l.metadata&&l.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(e,q){var b=e;if(arguments.length===0)return l.extend({},this.options);if(typeof e=="string"){if(q===u)return this.options[e];b={};b[e]=q}this._setOptions(b);return this},_setOptions:function(e){var q=this;l.each(e,function(b,h){q._setOption(b,h)});return this},_setOption:function(e,q){this.options[e]=q;e==="disabled"&&this.widget()[q?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
q);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(e,q,b){var h,f=this.options[e];b=b||{};q=l.Event(q);q.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();q.target=this.element[0];if(e=q.originalEvent)for(h in e)h in q||(q[h]=e[h]);this.element.trigger(q,b);return!(l.isFunction(f)&&f.call(this.element[0],q,b)===false||q.isDefaultPrevented())}}})(jQuery);
(function(l){var u=false;l(document).mouseup(function(){u=false});l.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===l.data(c.target,a.widgetName+".preventClickEvent")){l.removeData(c.target,a.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(a){if(!u){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var c=this,e=a.which==1,q=typeof this.options.cancel=="string"&&a.target.nodeName?l(a.target).closest(this.options.cancel).length:false;if(!e||q||!this._mouseCapture(a))return true;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=this._mouseStart(a)!==
false;if(!this._mouseStarted){a.preventDefault();return true}}true===l.data(a.target,this.widgetName+".preventClickEvent")&&l.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(b){return c._mouseMove(b)};this._mouseUpDelegate=function(b){return c._mouseUp(b)};l(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return u=true}},_mouseMove:function(a){if(l.browser.msie&&
!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){l(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&
(this._mouseStarted=false,a.target==this._mouseDownEvent.target&&l.data(a.target,this.widgetName+".preventClickEvent",true),this._mouseStop(a));return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(l){l.widget("ui.draggable",l.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){this.options.helper=="original"&&
!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(u){var a=this.options;
if(this.helper||a.disabled||l(u.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(u);if(!this.handle)return false;a.iframeFix&&l(a.iframeFix===true?"iframe":a.iframeFix).each(function(){l('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(l(this).offset()).appendTo("body")});return true},_mouseStart:function(u){var a=this.options;this.helper=
this._createHelper(u);this._cacheHelperProportions();l.ui.ddmanager&&(l.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};l.extend(this.offset,{click:{left:u.pageX-this.offset.left,top:u.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(u);this.originalPageX=u.pageX;this.originalPageY=u.pageY;a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt);a.containment&&this._setContainment();if(this._trigger("start",u)===false){this._clear();return false}this._cacheHelperProportions();l.ui.ddmanager&&!a.dropBehaviour&&l.ui.ddmanager.prepareOffsets(this,u);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(u,true);l.ui.ddmanager&&l.ui.ddmanager.dragStart(this,u);return true},
_mouseDrag:function(u,a){this.position=this._generatePosition(u);this.positionAbs=this._convertPositionTo("absolute");if(!a){var c=this._uiHash();if(this._trigger("drag",u,c)===false){this._mouseUp({});return false}this.position=c.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";l.ui.ddmanager&&l.ui.ddmanager.drag(this,u);return false},_mouseStop:function(u){var a=
false;l.ui.ddmanager&&!this.options.dropBehaviour&&(a=l.ui.ddmanager.drop(this,u));this.dropped&&(a=this.dropped,this.dropped=false);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!a||this.options.revert=="valid"&&a||this.options.revert===true||l.isFunction(this.options.revert)&&this.options.revert.call(this.element,a)){var c=this;l(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),
function(){c._trigger("stop",u)!==false&&c._clear()})}else this._trigger("stop",u)!==false&&this._clear();return false},_mouseUp:function(u){this.options.iframeFix===true&&l("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});l.ui.ddmanager&&l.ui.ddmanager.dragStop(this,u);return l.ui.mouse.prototype._mouseUp.call(this,u)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(u){var a=!this.options.handle||
!l(this.options.handle,this.element).length?true:false;l(this.options.handle,this.element).find("*").andSelf().each(function(){this==u.target&&(a=true)});return a},_createHelper:function(u){var a=this.options;u=l.isFunction(a.helper)?l(a.helper.apply(this.element[0],[u])):a.helper=="clone"?this.element.clone().removeAttr("id"):this.element;u.parents("body").length||u.appendTo(a.appendTo=="parent"?this.element[0].parentNode:a.appendTo);u[0]!=this.element[0]&&!/(fixed|absolute)/.test(u.css("position"))&&
u.css("position","absolute");return u},_adjustOffsetFromHelper:function(u){typeof u=="string"&&(u=u.split(" "));l.isArray(u)&&(u={left:+u[0],top:+u[1]||0});"left"in u&&(this.offset.click.left=u.left+this.margins.left);"right"in u&&(this.offset.click.left=this.helperProportions.width-u.right+this.margins.left);"top"in u&&(this.offset.click.top=u.top+this.margins.top);"bottom"in u&&(this.offset.click.top=this.helperProportions.height-u.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var u=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&l.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(u.left+=this.scrollParent.scrollLeft(),u.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&l.browser.msie)u={top:0,left:0};return{top:u.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:u.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var u=this.element.position();return{top:u.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:u.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var u=this.options;u.containment=="parent"&&(u.containment=this.helper[0].parentNode);if(u.containment=="document"||u.containment=="window")this.containment=[u.containment=="document"?0:l(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,u.containment=="document"?0:l(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(u.containment=="document"?0:l(window).scrollLeft())+l(u.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(u.containment=="document"?0:l(window).scrollTop())+(l(u.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(u.containment)&&u.containment.constructor!=Array){u=l(u.containment);var a=u[0];if(a){u.offset();var c=l(a).css("overflow")!=
"hidden";this.containment=[(parseInt(l(a).css("borderLeftWidth"),10)||0)+(parseInt(l(a).css("paddingLeft"),10)||0),(parseInt(l(a).css("borderTopWidth"),10)||0)+(parseInt(l(a).css("paddingTop"),10)||0),(c?Math.max(a.scrollWidth,a.offsetWidth):a.offsetWidth)-(parseInt(l(a).css("borderLeftWidth"),10)||0)-(parseInt(l(a).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(a.scrollHeight,a.offsetHeight):a.offsetHeight)-(parseInt(l(a).css("borderTopWidth"),
10)||0)-(parseInt(l(a).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=u}}else u.containment.constructor==Array&&(this.containment=u.containment)},_convertPositionTo:function(u,a){a||(a=this.position);var c=u=="absolute"?1:-1,e=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!l.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,q=/(html|body)/i.test(e[0].tagName);return{top:a.top+
this.offset.relative.top*c+this.offset.parent.top*c-(l.browser.safari&&l.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():q?0:e.scrollTop())*c),left:a.left+this.offset.relative.left*c+this.offset.parent.left*c-(l.browser.safari&&l.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():q?0:e.scrollLeft())*c)}},_generatePosition:function(u){var a=this.options,c=this.cssPosition=="absolute"&&
(this.scrollParent[0]==document||!l.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(c[0].tagName),q=u.pageX,b=u.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){h=this.relative_container.offset();h=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]}else h=this.containment;u.pageX-this.offset.click.left<h[0]&&(q=h[0]+this.offset.click.left);
u.pageY-this.offset.click.top<h[1]&&(b=h[1]+this.offset.click.top);u.pageX-this.offset.click.left>h[2]&&(q=h[2]+this.offset.click.left);u.pageY-this.offset.click.top>h[3]&&(b=h[3]+this.offset.click.top)}if(a.grid){b=a.grid[1]?this.originalPageY+Math.round((b-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY;b=h?b-this.offset.click.top<h[1]||b-this.offset.click.top>h[3]?b-this.offset.click.top<h[1]?b+a.grid[1]:b-a.grid[1]:b:b;q=a.grid[0]?this.originalPageX+Math.round((q-this.originalPageX)/
a.grid[0])*a.grid[0]:this.originalPageX;q=h?q-this.offset.click.left<h[0]||q-this.offset.click.left>h[2]?q-this.offset.click.left<h[0]?q+a.grid[0]:q-a.grid[0]:q:q}}return{top:b-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(l.browser.safari&&l.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:c.scrollTop()),left:q-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(l.browser.safari&&l.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(u,a,c){c=c||this._uiHash();l.ui.plugin.call(this,u,[a,c]);u=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return l.Widget.prototype._trigger.call(this,u,a,
c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});l.extend(l.ui.draggable,{version:"1.8.17"});l.ui.plugin.add("draggable","connectToSortable",{start:function(u,a){var c=l(this).data("draggable"),e=c.options,q=l.extend({},a,{item:c.element});c.sortables=[];l(e.connectToSortable).each(function(){var b=l.data(this,"sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),
b.refreshPositions(),b._trigger("activate",u,q))})},stop:function(u,a){var c=l(this).data("draggable"),e=l.extend({},a,{item:c.element});l.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=true,this.instance.cancelHelperRemoval=false,this.shouldRevert&&(this.instance.options.revert=true),this.instance._mouseStop(u),this.instance.options.helper=this.instance.options._helper,c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):
(this.instance.cancelHelperRemoval=false,this.instance._trigger("deactivate",u,e))})},drag:function(u,a){var c=l(this).data("draggable"),e=this;l.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=l(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
true),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return a.helper[0]},u.target=this.instance.currentItem[0],this.instance._mouseCapture(u,true),this.instance._mouseStart(u,true,true),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,
c._trigger("toSortable",u),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(u)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=true,this.instance.options.revert=false,this.instance._trigger("out",u,this.instance._uiHash(this.instance)),this.instance._mouseStop(u,true),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),c._trigger("fromSortable",u),c.dropped=false)})}});l.ui.plugin.add("draggable","cursor",{start:function(){var u=l("body"),a=l(this).data("draggable").options;u.css("cursor")&&(a._cursor=u.css("cursor"));u.css("cursor",a.cursor)},stop:function(){var u=l(this).data("draggable").options;u._cursor&&l("body").css("cursor",u._cursor)}});l.ui.plugin.add("draggable","opacity",{start:function(u,a){var c=l(a.helper),e=l(this).data("draggable").options;c.css("opacity")&&(e._opacity=
c.css("opacity"));c.css("opacity",e.opacity)},stop:function(u,a){var c=l(this).data("draggable").options;c._opacity&&l(a.helper).css("opacity",c._opacity)}});l.ui.plugin.add("draggable","scroll",{start:function(){var u=l(this).data("draggable");u.scrollParent[0]!=document&&u.scrollParent[0].tagName!="HTML"&&(u.overflowOffset=u.scrollParent.offset())},drag:function(u){var a=l(this).data("draggable"),c=a.options,e=false;if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML"){if(!c.axis||
c.axis!="x")a.overflowOffset.top+a.scrollParent[0].offsetHeight-u.pageY<c.scrollSensitivity?a.scrollParent[0].scrollTop=e=a.scrollParent[0].scrollTop+c.scrollSpeed:u.pageY-a.overflowOffset.top<c.scrollSensitivity&&(a.scrollParent[0].scrollTop=e=a.scrollParent[0].scrollTop-c.scrollSpeed);if(!c.axis||c.axis!="y")a.overflowOffset.left+a.scrollParent[0].offsetWidth-u.pageX<c.scrollSensitivity?a.scrollParent[0].scrollLeft=e=a.scrollParent[0].scrollLeft+c.scrollSpeed:u.pageX-a.overflowOffset.left<c.scrollSensitivity&&
(a.scrollParent[0].scrollLeft=e=a.scrollParent[0].scrollLeft-c.scrollSpeed)}else{if(!c.axis||c.axis!="x")u.pageY-l(document).scrollTop()<c.scrollSensitivity?e=l(document).scrollTop(l(document).scrollTop()-c.scrollSpeed):l(window).height()-(u.pageY-l(document).scrollTop())<c.scrollSensitivity&&(e=l(document).scrollTop(l(document).scrollTop()+c.scrollSpeed));if(!c.axis||c.axis!="y")u.pageX-l(document).scrollLeft()<c.scrollSensitivity?e=l(document).scrollLeft(l(document).scrollLeft()-c.scrollSpeed):
l(window).width()-(u.pageX-l(document).scrollLeft())<c.scrollSensitivity&&(e=l(document).scrollLeft(l(document).scrollLeft()+c.scrollSpeed))}e!==false&&l.ui.ddmanager&&!c.dropBehaviour&&l.ui.ddmanager.prepareOffsets(a,u)}});l.ui.plugin.add("draggable","snap",{start:function(){var u=l(this).data("draggable"),a=u.options;u.snapElements=[];l(a.snap.constructor!=String?a.snap.items||":data(draggable)":a.snap).each(function(){var c=l(this),e=c.offset();this!=u.element[0]&&u.snapElements.push({item:this,
width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(u,a){for(var c=l(this).data("draggable"),e=c.options,q=e.snapTolerance,b=a.offset.left,h=b+c.helperProportions.width,f=a.offset.top,n=f+c.helperProportions.height,s=c.snapElements.length-1;s>=0;s--){var A=c.snapElements[s].left,p=A+c.snapElements[s].width,L=c.snapElements[s].top,Q=L+c.snapElements[s].height;if(A-q<b&&b<p+q&&L-q<f&&f<Q+q||A-q<b&&b<p+q&&L-q<n&&n<Q+q||A-q<h&&h<p+q&&L-q<f&&f<Q+q||A-q<h&&h<p+q&&L-q<n&&
n<Q+q){if(e.snapMode!="inner"){var N=Math.abs(L-n)<=q,J=Math.abs(Q-f)<=q,P=Math.abs(A-h)<=q,U=Math.abs(p-b)<=q;N&&(a.position.top=c._convertPositionTo("relative",{top:L-c.helperProportions.height,left:0}).top-c.margins.top);J&&(a.position.top=c._convertPositionTo("relative",{top:Q,left:0}).top-c.margins.top);P&&(a.position.left=c._convertPositionTo("relative",{top:0,left:A-c.helperProportions.width}).left-c.margins.left);U&&(a.position.left=c._convertPositionTo("relative",{top:0,left:p}).left-c.margins.left)}var O=
N||J||P||U;if(e.snapMode!="outer"){N=Math.abs(L-f)<=q;J=Math.abs(Q-n)<=q;P=Math.abs(A-b)<=q;U=Math.abs(p-h)<=q;N&&(a.position.top=c._convertPositionTo("relative",{top:L,left:0}).top-c.margins.top);J&&(a.position.top=c._convertPositionTo("relative",{top:Q-c.helperProportions.height,left:0}).top-c.margins.top);P&&(a.position.left=c._convertPositionTo("relative",{top:0,left:A}).left-c.margins.left);U&&(a.position.left=c._convertPositionTo("relative",{top:0,left:p-c.helperProportions.width}).left-c.margins.left)}!c.snapElements[s].snapping&&
(N||J||P||U||O)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,u,l.extend(c._uiHash(),{snapItem:c.snapElements[s].item}));c.snapElements[s].snapping=N||J||P||U||O}else{c.snapElements[s].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,u,l.extend(c._uiHash(),{snapItem:c.snapElements[s].item}));c.snapElements[s].snapping=false}}}});l.ui.plugin.add("draggable","stack",{start:function(){var u=l(this).data("draggable").options;u=l.makeArray(l(u.stack)).sort(function(c,
e){return(parseInt(l(c).css("zIndex"),10)||0)-(parseInt(l(e).css("zIndex"),10)||0)});if(u.length){var a=parseInt(u[0].style.zIndex)||0;l(u).each(function(c){this.style.zIndex=a+c});this[0].style.zIndex=a+u.length}}});l.ui.plugin.add("draggable","zIndex",{start:function(u,a){var c=l(a.helper),e=l(this).data("draggable").options;c.css("zIndex")&&(e._zIndex=c.css("zIndex"));c.css("zIndex",e.zIndex)},stop:function(u,a){var c=l(this).data("draggable").options;c._zIndex&&l(a.helper).css("zIndex",c._zIndex)}})})(jQuery);
(function(l){l.widget("ui.slider",l.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var u=this,a=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),e=a.values&&a.values.length||1,q=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(a.disabled?" ui-slider-disabled ui-disabled":""));this.range=l([]);a.range&&(a.range===true&&(a.values||(a.values=[this._valueMin(),this._valueMin()]),a.values.length&&a.values.length!==2&&(a.values=[a.values[0],a.values[0]])),this.range=l("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(a.range==="min"||a.range==="max"?" ui-slider-range-"+a.range:"")));for(var b=c.length;b<e;b+=1)q.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=c.add(l(q.join("")).appendTo(u.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(h){h.preventDefault()}).hover(function(){a.disabled||l(this).addClass("ui-state-hover")},function(){l(this).removeClass("ui-state-hover")}).focus(function(){a.disabled?l(this).blur():(l(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),l(this).addClass("ui-state-focus"))}).blur(function(){l(this).removeClass("ui-state-focus")});this.handles.each(function(h){l(this).data("index.ui-slider-handle",
h)});this.handles.keydown(function(h){var f=true,n=l(this).data("index.ui-slider-handle"),s,A,p;if(!u.options.disabled){switch(h.keyCode){case l.ui.keyCode.HOME:case l.ui.keyCode.END:case l.ui.keyCode.PAGE_UP:case l.ui.keyCode.PAGE_DOWN:case l.ui.keyCode.UP:case l.ui.keyCode.RIGHT:case l.ui.keyCode.DOWN:case l.ui.keyCode.LEFT:f=false;if(!u._keySliding){u._keySliding=true;l(this).addClass("ui-state-active");s=u._start(h,n);if(s===false)return}}s=u.options.step;u.options.values&&u.options.values.length?
A=p=u.values(n):A=p=u.value();switch(h.keyCode){case l.ui.keyCode.HOME:p=u._valueMin();break;case l.ui.keyCode.END:p=u._valueMax();break;case l.ui.keyCode.PAGE_UP:p=u._trimAlignValue(A+(u._valueMax()-u._valueMin())/5);break;case l.ui.keyCode.PAGE_DOWN:p=u._trimAlignValue(A-(u._valueMax()-u._valueMin())/5);break;case l.ui.keyCode.UP:case l.ui.keyCode.RIGHT:if(A===u._valueMax())return;p=u._trimAlignValue(A+s);break;case l.ui.keyCode.DOWN:case l.ui.keyCode.LEFT:if(A===u._valueMin())return;p=u._trimAlignValue(A-
s)}u._slide(h,n,p);return f}}).keyup(function(h){var f=l(this).data("index.ui-slider-handle");u._keySliding&&(u._keySliding=false,u._stop(h,f),u._change(h,f),l(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
return this},_mouseCapture:function(u){var a=this.options,c,e,q,b,h;if(a.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:u.pageX,y:u.pageY});e=this._valueMax()-this._valueMin()+1;b=this;this.handles.each(function(f){var n=Math.abs(c-b.values(f));e>n&&(e=n,q=l(this),h=f)});a.range===true&&this.values(1)===a.min&&(h+=1,q=l(this.handles[h]));if(this._start(u,h)===false)return false;
this._mouseSliding=true;b._handleIndex=h;q.addClass("ui-state-active").focus();a=q.offset();this._clickOffset=!l(u.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:u.pageX-a.left-q.width()/2,top:u.pageY-a.top-q.height()/2-(parseInt(q.css("borderTopWidth"),10)||0)-(parseInt(q.css("borderBottomWidth"),10)||0)+(parseInt(q.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(u,h,c);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(u){var a=
this._normValueFromMouse({x:u.pageX,y:u.pageY});this._slide(u,this._handleIndex,a);return false},_mouseStop:function(u){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(u,this._handleIndex);this._change(u,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(u){var a,c;this.orientation==="horizontal"?
(a=this.elementSize.width,c=u.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(a=this.elementSize.height,c=u.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));u=c/a;u>1&&(u=1);u<0&&(u=0);this.orientation==="vertical"&&(u=1-u);a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+u*a)},_start:function(u,a){var c={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(a),
c.values=this.values());return this._trigger("start",u,c)},_slide:function(u,a,c){var e,q,b;this.options.values&&this.options.values.length?(e=this.values(a?0:1),this.options.values.length===2&&this.options.range===true&&(a===0&&c>e||a===1&&c<e)&&(c=e),c!==this.values(a)&&(q=this.values(),q[a]=c,b=this._trigger("slide",u,{handle:this.handles[a],value:c,values:q}),this.values(a?0:1),b!==false&&this.values(a,c,true))):c!==this.value()&&(b=this._trigger("slide",u,{handle:this.handles[a],value:c}),b!==
false&&this.value(c))},_stop:function(u,a){var c={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(a),c.values=this.values());this._trigger("stop",u,c)},_change:function(u,a){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(a),c.values=this.values());this._trigger("change",u,c)}},value:function(u){if(arguments.length){this.options.value=
this._trimAlignValue(u);this._refreshValue();this._change(null,0)}else return this._value()},values:function(u,a){var c,e,q;if(arguments.length>1){this.options.values[u]=this._trimAlignValue(a);this._refreshValue();this._change(null,u)}else{if(!arguments.length)return this._values();if(!l.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(u):this.value();c=this.options.values;e=arguments[0];for(q=0;q<c.length;q+=1){c[q]=this._trimAlignValue(e[q]);this._change(null,
q)}this._refreshValue()}},_setOption:function(u,a){var c,e=0;l.isArray(this.options.values)&&(e=this.options.values.length);l.Widget.prototype._setOption.apply(this,arguments);switch(u){case "disabled":a?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",true),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",false),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<e;c+=1)this._change(null,c);this._animateOff=false}},_value:function(){var u=this.options.value;return u=this._trimAlignValue(u)},_values:function(u){var a,c;if(arguments.length){a=this.options.values[u];
return a=this._trimAlignValue(a)}a=this.options.values.slice();for(c=0;c<a.length;c+=1)a[c]=this._trimAlignValue(a[c]);return a},_trimAlignValue:function(u){if(u<=this._valueMin())return this._valueMin();if(u>=this._valueMax())return this._valueMax();var a=this.options.step>0?this.options.step:1,c=(u-this._valueMin())%a;u=u-c;Math.abs(c)*2>=a&&(u+=c>0?a:-a);return parseFloat(u.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var u=
this.options.range,a=this.options,c=this,e=this._animateOff?false:a.animate,q,b={},h,f,n,s;this.options.values&&this.options.values.length?this.handles.each(function(A){q=(c.values(A)-c._valueMin())/(c._valueMax()-c._valueMin())*100;b[c.orientation==="horizontal"?"left":"bottom"]=q+"%";l(this).stop(1,1)[e?"animate":"css"](b,a.animate);c.options.range===true&&(c.orientation==="horizontal"?(A===0&&c.range.stop(1,1)[e?"animate":"css"]({left:q+"%"},a.animate),A===1&&c.range[e?"animate":"css"]({width:q-
h+"%"},{queue:false,duration:a.animate})):(A===0&&c.range.stop(1,1)[e?"animate":"css"]({bottom:q+"%"},a.animate),A===1&&c.range[e?"animate":"css"]({height:q-h+"%"},{queue:false,duration:a.animate})));h=q}):(f=this.value(),n=this._valueMin(),s=this._valueMax(),q=s!==n?(f-n)/(s-n)*100:0,b[c.orientation==="horizontal"?"left":"bottom"]=q+"%",this.handle.stop(1,1)[e?"animate":"css"](b,a.animate),u==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[e?"animate":"css"]({width:q+"%"},a.animate),
u==="max"&&this.orientation==="horizontal"&&this.range[e?"animate":"css"]({width:100-q+"%"},{queue:false,duration:a.animate}),u==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[e?"animate":"css"]({height:q+"%"},a.animate),u==="max"&&this.orientation==="vertical"&&this.range[e?"animate":"css"]({height:100-q+"%"},{queue:false,duration:a.animate}))}});l.extend(l.ui.slider,{version:"1.8.17"})})(jQuery);(function(l){Math.precision=function(b,h){if(h===undefined)h=0;return Math.round(b*Math.pow(10,h))/Math.pow(10,h)};var u=function(b,h){var f=this,n=b.find("img:first"),s=0,A=100,p=100,L=0,Q=100,N=100,J=0,P=0,U,O,ha=[],pa=function(V){for(var X=0;X<ha.length;X++)ha[X].call(f,f,V)},fa=function(V){var X=b.offset();U={l:X.left|0,t:X.top|0};clearTimeout(O);O=setTimeout(function(){ra.call(f,V)},0);l(document).bind("mousemove",aa).bind("mouseup",W);V.preventDefault()},aa=function(V){clearTimeout(O);O=setTimeout(function(){ra.call(f,
V)},0);V.stopPropagation();V.preventDefault();return false},W=function(V){l(document).unbind("mouseup",W).unbind("mousemove",aa);V.stopPropagation();V.preventDefault();return false},ra=function(V){var X=V.pageX-U.l;V=V.pageY-U.t;var na=b.w,qa=b.h;if(X<0)X=0;else if(X>na)X=na;if(V<0)V=0;else if(V>qa)V=qa;ja.call(f,"xy",{x:X/na*p+s,y:V/qa*N+L})},ja=function(V,X,na){if(X===undefined){if(V===undefined||V==null)V="xy";switch(V.toLowerCase()){case "x":return J;case "y":return P;default:return{x:J,y:P}}}if(!(na!=
null&&na==f)){var qa=false,la,ma;if(V==null)V="xy";switch(V.toLowerCase()){case "x":la=X&&(X.x&&X.x|0||X|0)||0;break;case "y":ma=X&&(X.y&&X.y|0||X|0)||0;break;default:la=X&&X.x&&X.x|0||0;ma=X&&X.y&&X.y|0||0}if(la!=null){if(la<s)la=s;else if(la>A)la=A;if(J!=la){J=la;qa=true}}if(ma!=null){if(ma<L)ma=L;else if(ma>Q)ma=Q;if(P!=ma){P=ma;qa=true}}qa&&pa.call(f,na||f)}},da=function(V){l.isFunction(V)&&ha.push(V)};l.extend(true,f,{val:ja,range:function(V,X){if(X===undefined){if(V===undefined||V==null)V="all";
switch(V.toLowerCase()){case "minx":return s;case "maxx":return A;case "rangex":return{minX:s,maxX:A,rangeX:p};case "miny":return L;case "maxy":return Q;case "rangey":return{minY:L,maxY:Q,rangeY:N};default:return{minX:s,maxX:A,rangeX:p,minY:L,maxY:Q,rangeY:N}}}var na,qa,la,ma;if(V==null)V="all";switch(V.toLowerCase()){case "minx":na=X&&(X.minX&&X.minX|0||X|0)||0;break;case "maxx":qa=X&&(X.maxX&&X.maxX|0||X|0)||0;break;case "rangex":na=X&&X.minX&&X.minX|0||0;qa=X&&X.maxX&&X.maxX|0||0;break;case "miny":la=
X&&(X.minY&&X.minY|0||X|0)||0;break;case "maxy":ma=X&&(X.maxY&&X.maxY|0||X|0)||0;break;case "rangey":la=X&&X.minY&&X.minY|0||0;ma=X&&X.maxY&&X.maxY|0||0;break;default:na=X&&X.minX&&X.minX|0||0;qa=X&&X.maxX&&X.maxX|0||0;la=X&&X.minY&&X.minY|0||0;ma=X&&X.maxY&&X.maxY|0||0}if(na!=null&&s!=na){s=na;p=A-s}if(qa!=null&&A!=qa){A=qa;p=A-s}if(la!=null&&L!=la){L=la;N=Q-L}if(ma!=null&&Q!=ma){Q=ma;N=Q-L}},bind:da,unbind:function(V){if(l.isFunction(V))for(var X;(X=l.inArray(V,ha))!=-1;)ha.splice(X,1)},destroy:function(){l(document).unbind("mouseup",
W).unbind("mousemove",aa);b.unbind("mousedown",fa);ha=n=b=null}});n.src=h.arrow&&h.arrow.image;n.w=h.arrow&&h.arrow.width||n.width();n.h=h.arrow&&h.arrow.height||n.height();b.w=h.map&&h.map.width||b.width();b.h=h.map&&h.map.height||b.height();b.bind("mousedown",fa);da.call(f,function(){var V=0,X=0,na=b.w,qa=b.h,la=n.w,ma=n.h;setTimeout(function(){if(p>0)V=J==A?na:J/p*na|0;if(N>0)X=P==Q?qa:P/N*qa|0;if(la>=na)V=(na>>1)-(la>>1);else V-=la>>1;if(ma>=qa)X=(qa>>1)-(ma>>1);else X-=ma>>1;n.css({left:V+"px",
top:X+"px"})},0)})},a=function(b,h,f,n){var s=this;b=b.find("td.Text input");var A=b.eq(3),p=b.eq(4),L=b.eq(5),Q=b.length>7?b.eq(6):null,N=b.eq(0),J=b.eq(1),P=b.eq(2),U=b.eq(b.length>7?7:6),O=b.length>7?b.eq(8):null,ha=function(ja){if(!(ja.target.value==""&&ja.target!=U.get(0)&&(f!=null&&ja.target!=f.get(0)||f==null))){if(!aa(ja))return ja;switch(ja.target){case A.get(0):switch(ja.keyCode){case 38:A.val(W.call(s,(A.val()<<0)+1,0,255));h.val("r",A.val(),ja.target);return false;case 40:A.val(W.call(s,
(A.val()<<0)-1,0,255));h.val("r",A.val(),ja.target);return false}break;case p.get(0):switch(ja.keyCode){case 38:p.val(W.call(s,(p.val()<<0)+1,0,255));h.val("g",p.val(),ja.target);return false;case 40:p.val(W.call(s,(p.val()<<0)-1,0,255));h.val("g",p.val(),ja.target);return false}break;case L.get(0):switch(ja.keyCode){case 38:L.val(W.call(s,(L.val()<<0)+1,0,255));h.val("b",L.val(),ja.target);return false;case 40:L.val(W.call(s,(L.val()<<0)-1,0,255));h.val("b",L.val(),ja.target);return false}break;
case Q&&Q.get(0):switch(ja.keyCode){case 38:Q.val(W.call(s,parseFloat(Q.val())+1,0,100));h.val("a",Math.precision(Q.val()*255/100,n),ja.target);return false;case 40:Q.val(W.call(s,parseFloat(Q.val())-1,0,100));h.val("a",Math.precision(Q.val()*255/100,n),ja.target);return false}break;case N.get(0):switch(ja.keyCode){case 38:N.val(W.call(s,(N.val()<<0)+1,0,360));h.val("h",N.val(),ja.target);return false;case 40:N.val(W.call(s,(N.val()<<0)-1,0,360));h.val("h",N.val(),ja.target);return false}break;case J.get(0):switch(ja.keyCode){case 38:J.val(W.call(s,
(J.val()<<0)+1,0,100));h.val("s",J.val(),ja.target);return false;case 40:J.val(W.call(s,(J.val()<<0)-1,0,100));h.val("s",J.val(),ja.target);return false}break;case P.get(0):switch(ja.keyCode){case 38:P.val(W.call(s,(P.val()<<0)+1,0,100));h.val("v",P.val(),ja.target);return false;case 40:P.val(W.call(s,(P.val()<<0)-1,0,100));h.val("v",P.val(),ja.target);return false}}}},pa=function(ja){if(!(ja.target.value==""&&ja.target!=U.get(0)&&(f!=null&&ja.target!=f.get(0)||f==null))){if(!aa(ja))return ja;switch(ja.target){case A.get(0):A.val(W.call(s,
A.val(),0,255));h.val("r",A.val(),ja.target);break;case p.get(0):p.val(W.call(s,p.val(),0,255));h.val("g",p.val(),ja.target);break;case L.get(0):L.val(W.call(s,L.val(),0,255));h.val("b",L.val(),ja.target);break;case Q&&Q.get(0):Q.val(W.call(s,Q.val(),0,100));h.val("a",Math.precision(Q.val()*255/100,n),ja.target);break;case N.get(0):N.val(W.call(s,N.val(),0,360));h.val("h",N.val(),ja.target);break;case J.get(0):J.val(W.call(s,J.val(),0,100));h.val("s",J.val(),ja.target);break;case P.get(0):P.val(W.call(s,
P.val(),0,100));h.val("v",P.val(),ja.target);break;case U.get(0):U.val(U.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));f&&f.val(U.val());h.val("hex",U.val()!=""?U.val():null,ja.target);break;case f&&f.get(0):f.val(f.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));U.val(f.val());h.val("hex",f.val()!=""?f.val():null,ja.target);break;case O&&O.get(0):O.val(O.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2));h.val("a",O.val()!=null?parseInt(O.val(),16):
null,ja.target)}}},fa=function(ja){if(h.val()!=null)switch(ja.target){case A.get(0):A.val(h.val("r"));break;case p.get(0):p.val(h.val("g"));break;case L.get(0):L.val(h.val("b"));break;case Q&&Q.get(0):Q.val(Math.precision(h.val("a")*100/255,n));break;case N.get(0):N.val(h.val("h"));break;case J.get(0):J.val(h.val("s"));break;case P.get(0):P.val(h.val("v"));break;case U.get(0):case f&&f.get(0):U.val(h.val("hex"));f&&f.val(h.val("hex"));break;case O&&O.get(0):O.val(h.val("ahex").substring(6))}},aa=
function(ja){switch(ja.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(ja.ctrlKey)return false}return true},W=function(ja,da,V){if(ja==""||isNaN(ja))return da;if(ja>V)return V;if(ja<da)return da;return ja},ra=function(ja,da){var V=ja.val("all");if(da!=A.get(0))A.val(V!=null?V.r:"");if(da!=p.get(0))p.val(V!=null?V.g:"");if(da!=L.get(0))L.val(V!=null?V.b:"");if(Q&&da!=Q.get(0))Q.val(V!=null?Math.precision(V.a*100/255,n):"");if(da!=N.get(0))N.val(V!=
null?V.h:"");if(da!=J.get(0))J.val(V!=null?V.s:"");if(da!=P.get(0))P.val(V!=null?V.v:"");if(da!=U.get(0)&&(f&&da!=f.get(0)||!f))U.val(V!=null?V.hex:"");if(f&&da!=f.get(0)&&da!=U.get(0))f.val(V!=null?V.hex:"");if(O&&da!=O.get(0))O.val(V!=null?V.ahex.substring(6):"")};l.extend(true,s,{destroy:function(){A.add(p).add(L).add(Q).add(N).add(J).add(P).add(U).add(f).add(O).unbind("keyup",pa).unbind("blur",fa);A.add(p).add(L).add(Q).add(N).add(J).add(P).unbind("keydown",ha);h.unbind(ra);O=U=P=J=N=Q=L=p=A=
null}});A.add(p).add(L).add(Q).add(N).add(J).add(P).add(U).add(f).add(O).bind("keyup",pa).bind("blur",fa);A.add(p).add(L).add(Q).add(N).add(J).add(P).bind("keydown",ha);h.bind(ra)};l.jPicker={List:[],Color:function(b){var h=this,f,n,s,A,p,L,Q,N=[],J=function(U){for(var O=0;O<N.length;O++)N[O].call(h,h,U)},P=function(U,O,ha){if(O===undefined){if(U===undefined||U==null||U=="")U="all";if(f==null)return null;switch(U.toLowerCase()){case "ahex":return q.rgbaToHex({r:f,g:n,b:s,a:A});case "hex":return P("ahex").substring(0,
6);case "all":return{r:f,g:n,b:s,a:A,h:p,s:L,v:Q,hex:P.call(h,"hex"),ahex:P.call(h,"ahex")};default:O={};for(var pa=0;pa<U.length;pa++)switch(U.charAt(pa)){case "r":if(U.length==1)O=f;else O.r=f;break;case "g":if(U.length==1)O=n;else O.g=n;break;case "b":if(U.length==1)O=s;else O.b=s;break;case "a":if(U.length==1)O=A;else O.a=A;break;case "h":if(U.length==1)O=p;else O.h=p;break;case "s":if(U.length==1)O=L;else O.s=L;break;case "v":if(U.length==1)O=Q;else O.v=Q}return O=={}?P.call(h,"all"):O}}if(!(ha!=
null&&ha==h)){var fa=false;if(U==null)U="";if(O==null){if(f!=null){f=null;fa=true}if(n!=null){n=null;fa=true}if(s!=null){s=null;fa=true}if(A!=null){A=null;fa=true}if(p!=null){p=null;fa=true}if(L!=null){L=null;fa=true}if(Q!=null){Q=null;fa=true}fa&&J.call(h,ha||h)}else switch(U.toLowerCase()){case "ahex":case "hex":O=q.hexToRgba(O&&(O.ahex||O.hex)||O||"00000000");P.call(h,"rgba",{r:O.r,g:O.g,b:O.b,a:U=="ahex"?O.a:A!=null?A:255},ha);break;default:if(O&&(O.ahex!=null||O.hex!=null)){P.call(h,"ahex",O.ahex||
O.hex||"00000000",ha);break}var aa={},W=false,ra=false;if(O.r!==undefined&&!U.indexOf("r")==-1)U+="r";if(O.g!==undefined&&!U.indexOf("g")==-1)U+="g";if(O.b!==undefined&&!U.indexOf("b")==-1)U+="b";if(O.a!==undefined&&!U.indexOf("a")==-1)U+="a";if(O.h!==undefined&&!U.indexOf("h")==-1)U+="h";if(O.s!==undefined&&!U.indexOf("s")==-1)U+="s";if(O.v!==undefined&&!U.indexOf("v")==-1)U+="v";for(pa=0;pa<U.length;pa++)switch(U.charAt(pa)){case "r":if(ra)continue;W=true;aa.r=O&&O.r&&O.r|0||O&&O|0||0;if(aa.r<0)aa.r=
0;else if(aa.r>255)aa.r=255;if(f!=aa.r){f=aa.r;fa=true}break;case "g":if(ra)continue;W=true;aa.g=O&&O.g&&O.g|0||O&&O|0||0;if(aa.g<0)aa.g=0;else if(aa.g>255)aa.g=255;if(n!=aa.g){n=aa.g;fa=true}break;case "b":if(ra)continue;W=true;aa.b=O&&O.b&&O.b|0||O&&O|0||0;if(aa.b<0)aa.b=0;else if(aa.b>255)aa.b=255;if(s!=aa.b){s=aa.b;fa=true}break;case "a":aa.a=O&&O.a!=null?O.a|0:O!=null?O|0:255;if(aa.a<0)aa.a=0;else if(aa.a>255)aa.a=255;if(A!=aa.a){A=aa.a;fa=true}break;case "h":if(W)continue;ra=true;aa.h=O&&O.h&&
O.h|0||O&&O|0||0;if(aa.h<0)aa.h=0;else if(aa.h>360)aa.h=360;if(p!=aa.h){p=aa.h;fa=true}break;case "s":if(W)continue;ra=true;aa.s=O&&O.s!=null?O.s|0:O!=null?O|0:100;if(aa.s<0)aa.s=0;else if(aa.s>100)aa.s=100;if(L!=aa.s){L=aa.s;fa=true}break;case "v":if(W)continue;ra=true;aa.v=O&&O.v!=null?O.v|0:O!=null?O|0:100;if(aa.v<0)aa.v=0;else if(aa.v>100)aa.v=100;if(Q!=aa.v){Q=aa.v;fa=true}}if(fa){if(W){f=f||0;n=n||0;s=s||0;O=q.rgbToHsv({r:f,g:n,b:s});p=O.h;L=O.s;Q=O.v}else if(ra){p=p||0;L=L!=null?L:100;Q=Q!=
null?Q:100;O=q.hsvToRgb({h:p,s:L,v:Q});f=O.r;n=O.g;s=O.b}A=A!=null?A:255;J.call(h,ha||h)}}}};l.extend(true,h,{val:P,bind:function(U){l.isFunction(U)&&N.push(U)},unbind:function(U){if(l.isFunction(U))for(var O;(O=l.inArray(U,N))!=-1;)N.splice(O,1)},destroy:function(){N=null}});if(b)if(b.ahex!=null)P("ahex",b);else if(b.hex!=null)P((b.a!=null?"a":"")+"hex",b.a!=null?{ahex:b.hex+q.intToHex(b.a)}:b);else if(b.r!=null&&b.g!=null&&b.b!=null)P("rgb"+(b.a!=null?"a":""),b);else if(b.h!=null&&b.s!=null&&b.v!=
null)P("hsv"+(b.a!=null?"a":""),b)},ColorMethods:{hexToRgba:function(b){b=this.validateHex(b);if(b=="")return{r:null,g:null,b:null,a:null};var h="00",f="00",n="00",s="255";if(b.length==6)b+="ff";if(b.length>6){h=b.substring(0,2);f=b.substring(2,4);n=b.substring(4,6);s=b.substring(6,b.length)}else{if(b.length>4){h=b.substring(4,b.length);b=b.substring(0,4)}if(b.length>2){f=b.substring(2,b.length);b=b.substring(0,2)}if(b.length>0)n=b.substring(0,b.length)}return{r:this.hexToInt(h),g:this.hexToInt(f),
b:this.hexToInt(n),a:this.hexToInt(s)}},validateHex:function(b){if(typeof b=="object")return"";b=b.toLowerCase().replace(/[^a-f0-9]/g,"");if(b.length>8)b=b.substring(0,8);return b},rgbaToHex:function(b){return this.intToHex(b.r)+this.intToHex(b.g)+this.intToHex(b.b)+this.intToHex(b.a)},intToHex:function(b){b=(b|0).toString(16);if(b.length==1)b="0"+b;return b.toLowerCase()},hexToInt:function(b){return parseInt(b,16)},rgbToHsv:function(b){var h=b.r/255,f=b.g/255;b=b.b/255;var n={h:0,s:0,v:0},s=0,A=
0;if(h>=f&&h>=b){A=h;s=f>b?b:f}else if(f>=b&&f>=h){A=f;s=h>b?b:h}else{A=b;s=f>h?h:f}n.v=A;n.s=A?(A-s)/A:0;if(n.s){s=A-s;n.h=h==A?(f-b)/s:f==A?2+(b-h)/s:4+(h-f)/s;n.h=parseInt(n.h*60);if(n.h<0)n.h+=360}else n.h=0;n.s=n.s*100|0;n.v=n.v*100|0;return n},hsvToRgb:function(b){var h={r:0,g:0,b:0,a:100},f=b.h,n=b.s;b=b.v;if(n==0)h.r=b==0?h.g=h.b=0:h.g=h.b=b*255/100|0;else{if(f==360)f=0;f/=60;n/=100;b/=100;var s=f|0,A=f-s;f=b*(1-n);var p=b*(1-n*A);n=b*(1-n*(1-A));switch(s){case 0:h.r=b;h.g=n;h.b=f;break;case 1:h.r=
p;h.g=b;h.b=f;break;case 2:h.r=f;h.g=b;h.b=n;break;case 3:h.r=f;h.g=p;h.b=b;break;case 4:h.r=n;h.g=f;h.b=b;break;case 5:h.r=b;h.g=f;h.b=p}h.r=h.r*255|0;h.g=h.g*255|0;h.b=h.b*255|0}return h}}};var c=l.jPicker.Color,e=l.jPicker.List,q=l.jPicker.ColorMethods;l.fn.jPicker=function(b){var h=arguments;return this.each(function(){var f=this,n=l.extend(true,{},l.fn.jPicker.defaults,b);if(l(f).get(0).nodeName.toLowerCase()=="input"){l.extend(true,n,{window:{bindToInput:true,expandable:true,input:l(f)}});if(l(f).val()==
""){n.color.active=new c({hex:null});n.color.current=new c({hex:null})}else if(q.validateHex(l(f).val())){n.color.active=new c({hex:l(f).val(),a:n.color.active.val("a")});n.color.current=new c({hex:l(f).val(),a:n.color.active.val("a")})}}if(n.window.expandable)l(f).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else n.window.liveUpdate=false;var s=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,A=null,p=null,L=null,Q=null,N=null,J=null,P=null,U=null,O=null,ha=null,pa=null,fa=null,aa=null,W=null,ra=null,ja=null,da=null,V=null,X=null,na=null,qa=null,la=null,ma=null,Ca=null,Ga=null,Ia=null,xa=null,Ja=null,Na=function(M){var R=ka.active,ea=R.val("hex"),Fa,Oa;n.color.mode=M;switch(M){case "h":setTimeout(function(){Wa.call(f,p,"transparent");Da.call(f,Q,0);ua.call(f,Q,100);Da.call(f,
N,260);ua.call(f,N,100);Wa.call(f,L,"transparent");Da.call(f,P,0);ua.call(f,P,100);Da.call(f,U,260);ua.call(f,U,100);Da.call(f,O,260);ua.call(f,O,100);Da.call(f,ha,260);ua.call(f,ha,100);Da.call(f,fa,260);ua.call(f,fa,100)},0);aa.range("all",{minX:0,maxX:100,minY:0,maxY:100});W.range("rangeY",{minY:0,maxY:360});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("s"),y:100-R.val("v")},aa);W.val("y",360-R.val("h"),W);break;case "s":setTimeout(function(){Wa.call(f,p,"transparent");Da.call(f,Q,-260);Da.call(f,
N,-520);Da.call(f,P,-260);Da.call(f,U,-520);Da.call(f,fa,260);ua.call(f,fa,100)},0);aa.range("all",{minX:0,maxX:360,minY:0,maxY:100});W.range("rangeY",{minY:0,maxY:100});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("h"),y:100-R.val("v")},aa);W.val("y",100-R.val("s"),W);break;case "v":setTimeout(function(){Wa.call(f,p,"000000");Da.call(f,Q,-780);Da.call(f,N,260);Wa.call(f,L,ea);Da.call(f,P,-520);Da.call(f,U,260);ua.call(f,U,100);Da.call(f,fa,260);ua.call(f,fa,100)},0);aa.range("all",{minX:0,maxX:360,
minY:0,maxY:100});W.range("rangeY",{minY:0,maxY:100});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("h"),y:100-R.val("s")},aa);W.val("y",100-R.val("v"),W);break;case "r":Fa=-1040;Oa=-780;aa.range("all",{minX:0,maxX:255,minY:0,maxY:255});W.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("b"),y:255-R.val("g")},aa);W.val("y",255-R.val("r"),W);break;case "g":Fa=-1560;Oa=-1820;aa.range("all",{minX:0,maxX:255,minY:0,maxY:255});W.range("rangeY",{minY:0,maxY:255});
if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("b"),y:255-R.val("r")},aa);W.val("y",255-R.val("g"),W);break;case "b":Fa=-2080;Oa=-2860;aa.range("all",{minX:0,maxX:255,minY:0,maxY:255});W.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("r"),y:255-R.val("g")},aa);W.val("y",255-R.val("b"),W);break;case "a":setTimeout(function(){Wa.call(f,p,"transparent");Da.call(f,Q,-260);Da.call(f,N,-520);Da.call(f,P,260);Da.call(f,U,260);ua.call(f,U,100);Da.call(f,fa,0);ua.call(f,
fa,100)},0);aa.range("all",{minX:0,maxX:360,minY:0,maxY:100});W.range("rangeY",{minY:0,maxY:255});if(R.val("ahex")==null)break;aa.val("xy",{x:R.val("h"),y:100-R.val("v")},aa);W.val("y",255-R.val("a"),W);break;default:throw"Invalid Mode";}switch(M){case "s":case "v":case "a":setTimeout(function(){ua.call(f,Q,100);ua.call(f,P,100);Da.call(f,O,260);ua.call(f,O,100);Da.call(f,ha,260);ua.call(f,ha,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Wa.call(f,p,"transparent");Wa.call(f,L,"transparent");
ua.call(f,P,100);ua.call(f,Q,100);Da.call(f,Q,Fa);Da.call(f,N,Fa-260);Da.call(f,P,Oa-780);Da.call(f,U,Oa-520);Da.call(f,O,Oa);Da.call(f,ha,Oa-260);Da.call(f,fa,260);ua.call(f,fa,100)},0)}R.val("ahex")!=null&&ta.call(f,R)},ta=function(M,R){if(R==null||R!=W&&R!=aa)va.call(f,M,R);setTimeout(function(){Va.call(f,M);ub.call(f,M);fb.call(f,M)},0)},wa=function(M,R){var ea=ka.active;if(!(R!=aa&&ea.val()==null)){var Fa=M.val("all");switch(n.color.mode){case "h":ea.val("sv",{s:Fa.x,v:100-Fa.y},R);break;case "s":case "a":ea.val("hv",
{h:Fa.x,v:100-Fa.y},R);break;case "v":ea.val("hs",{h:Fa.x,s:100-Fa.y},R);break;case "r":ea.val("gb",{g:255-Fa.y,b:Fa.x},R);break;case "g":ea.val("rb",{r:255-Fa.y,b:Fa.x},R);break;case "b":ea.val("rg",{r:Fa.x,g:255-Fa.y},R)}}},Ha=function(M,R){var ea=ka.active;if(!(R!=W&&ea.val()==null))switch(n.color.mode){case "h":ea.val("h",{h:360-M.val("y")},R);break;case "s":ea.val("s",{s:100-M.val("y")},R);break;case "v":ea.val("v",{v:100-M.val("y")},R);break;case "r":ea.val("r",{r:255-M.val("y")},R);break;case "g":ea.val("g",
{g:255-M.val("y")},R);break;case "b":ea.val("b",{b:255-M.val("y")},R);break;case "a":ea.val("a",255-M.val("y"),R)}},va=function(M,R){if(R!=aa)switch(n.color.mode){case "h":var ea=M.val("sv");aa.val("xy",{x:ea!=null?ea.s:100,y:100-(ea!=null?ea.v:100)},R);break;case "s":case "a":ea=M.val("hv");aa.val("xy",{x:ea&&ea.h||0,y:100-(ea!=null?ea.v:100)},R);break;case "v":ea=M.val("hs");aa.val("xy",{x:ea&&ea.h||0,y:100-(ea!=null?ea.s:100)},R);break;case "r":ea=M.val("bg");aa.val("xy",{x:ea&&ea.b||0,y:255-(ea&&
ea.g||0)},R);break;case "g":ea=M.val("br");aa.val("xy",{x:ea&&ea.b||0,y:255-(ea&&ea.r||0)},R);break;case "b":ea=M.val("rg");aa.val("xy",{x:ea&&ea.r||0,y:255-(ea&&ea.g||0)},R)}if(R!=W)switch(n.color.mode){case "h":W.val("y",360-(M.val("h")||0),R);break;case "s":ea=M.val("s");W.val("y",100-(ea!=null?ea:100),R);break;case "v":ea=M.val("v");W.val("y",100-(ea!=null?ea:100),R);break;case "r":W.val("y",255-(M.val("r")||0),R);break;case "g":W.val("y",255-(M.val("g")||0),R);break;case "b":W.val("y",255-(M.val("b")||
0),R);break;case "a":ea=M.val("a");W.val("y",255-(ea!=null?ea:255),R)}},Va=function(M){try{var R=M.val("all");na.css({backgroundColor:R&&"#"+R.hex||"transparent"});ua.call(f,na,R&&Math.precision(R.a*100/255,4)||0)}catch(ea){}},ub=function(M){switch(n.color.mode){case "h":Wa.call(f,p,(new c({h:M.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var R=M.val("s");ua.call(f,N,100-(R!=null?R:100));break;case "v":R=M.val("v");ua.call(f,Q,R!=null?R:100);break;case "r":ua.call(f,N,Math.precision((M.val("r")||
0)/255*100,4));break;case "g":ua.call(f,N,Math.precision((M.val("g")||0)/255*100,4));break;case "b":ua.call(f,N,Math.precision((M.val("b")||0)/255*100))}M=M.val("a");ua.call(f,J,Math.precision((255-(M||0))*100/255,4))},fb=function(M){switch(n.color.mode){case "h":var R=M.val("a");ua.call(f,pa,Math.precision((255-(R||0))*100/255,4));break;case "s":R=M.val("hva");var ea=new c({h:R&&R.h||0,s:100,v:R!=null?R.v:100});Wa.call(f,L,ea.val("hex"));ua.call(f,U,100-(R!=null?R.v:100));ua.call(f,pa,Math.precision((255-
(R&&R.a||0))*100/255,4));break;case "v":R=M.val("hsa");ea=new c({h:R&&R.h||0,s:R!=null?R.s:100,v:100});Wa.call(f,L,ea.val("hex"));ua.call(f,pa,Math.precision((255-(R&&R.a||0))*100/255,4));break;case "r":case "g":case "b":ea=R=0;M=M.val("rgba");if(n.color.mode=="r"){R=M&&M.b||0;ea=M&&M.g||0}else if(n.color.mode=="g"){R=M&&M.b||0;ea=M&&M.r||0}else if(n.color.mode=="b"){R=M&&M.r||0;ea=M&&M.g||0}var Fa=ea>R?R:ea;ua.call(f,U,R>ea?Math.precision((R-ea)/(255-ea)*100,4):0);ua.call(f,O,ea>R?Math.precision((ea-
R)/(255-R)*100,4):0);ua.call(f,ha,Math.precision(Fa/255*100,4));ua.call(f,pa,Math.precision((255-(M&&M.a||0))*100/255,4));break;case "a":R=M.val("a");Wa.call(f,L,M.val("hex")||"000000");ua.call(f,pa,R!=null?0:100);ua.call(f,fa,R!=null?100:0)}},Wa=function(M,R){M.css({backgroundColor:R&&R.length==6&&"#"+R||"transparent"})},Ya=function(M,R){if(s&&(R.indexOf("AlphaBar.png")!=-1||R.indexOf("Bars.png")!=-1||R.indexOf("Maps.png")!=-1)){M.attr("pngSrc",R);M.css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
R+"', sizingMethod='scale')"})}else M.css({backgroundImage:"url('"+R+"')"})},Da=function(M,R){M.css({top:R+"px"})},ua=function(M,R){M.css({visibility:R>0?"visible":"hidden"});if(R>0&&R<100)if(s){var ea=M.attr("pngSrc");ea!=null&&(ea.indexOf("AlphaBar.png")!=-1||ea.indexOf("Bars.png")!=-1||ea.indexOf("Maps.png")!=-1)?M.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ea+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+R+")"}):M.css({opacity:Math.precision(R/
100,4)})}else M.css({opacity:Math.precision(R/100,4)});else if(R==0||R==100)if(s){ea=M.attr("pngSrc");ea!=null&&(ea.indexOf("AlphaBar.png")!=-1||ea.indexOf("Bars.png")!=-1||ea.indexOf("Maps.png")!=-1)?M.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ea+"', sizingMethod='scale')"}):M.css({opacity:""})}else M.css({opacity:""})},db=function(){ka.active.val("ahex",ka.current.val("ahex"))},Ka=function(){ka.current.val("ahex",ka.active.val("ahex"))},Ua=function(M){l(this).parents("tbody:first").find('input:radio[value!="'+
M.target.value+'"]').removeAttr("checked");Na.call(f,M.target.value)},Ea=function(){db.call(f)},hb=function(){db.call(f);n.window.expandable&&wb.call(f);l.isFunction(nb)&&nb.call(f,ka.active,ma)},qb=function(){Ka.call(f);n.window.expandable&&wb.call(f);l.isFunction(lb)&&lb.call(f,ka.active,la)},Za=function(){rb.call(f)},$a=function(M){var R=M.val("hex");qa.css({backgroundColor:R&&"#"+R||"transparent"});ua.call(f,qa,Math.precision((M.val("a")||0)*100/255,4))},vb=function(M){var R=M.val("hex");M=M.val("va");
Ga.css({backgroundColor:R&&"#"+R||"transparent"});ua.call(f,Ia,Math.precision((255-(M&&M.a||0))*100/255,4));if(n.window.bindToInput&&n.window.updateInputColor)n.window.input.css({backgroundColor:R&&"#"+R||"transparent",color:M==null||M.v>75?"#000000":"#ffffff"})},sa=function(M){ja=parseInt(A.css("left"));da=parseInt(A.css("top"));V=M.pageX;X=M.pageY;l(document).bind("mousemove",kb).bind("mouseup",gb);M.preventDefault()},kb=function(M){A.css({left:ja-(V-M.pageX)+"px",top:da-(X-M.pageY)+"px"});n.window.expandable&&
!l.support.boxModel&&A.prev().css({left:A.css("left"),top:A.css("top")});M.stopPropagation();M.preventDefault();return false},gb=function(M){l(document).unbind("mousemove",kb).unbind("mouseup",gb);M.stopPropagation();M.preventDefault();return false},tb=function(M){M.preventDefault();M.stopPropagation();ka.active.val("ahex",l(this).attr("title")||null,M.target);return false},lb=l.isFunction(h[1])&&h[1]||null,eb=l.isFunction(h[2])&&h[2]||null,nb=l.isFunction(h[3])&&h[3]||null,rb=function(){ka.current.val("ahex",
ka.active.val("ahex"));var M=function(){if(!(!n.window.expandable||l.support.boxModel)){var R=A.find("table:first");A.before("<iframe/>");A.prev().css({width:R.width(),height:A.height(),opacity:0,position:"absolute",left:A.css("left"),top:A.css("top")})}};if(n.window.expandable){l(document.body).children("div.jPicker.Container").css({zIndex:10});A.css({zIndex:20})}switch(n.window.effects.type){case "fade":A.fadeIn(n.window.effects.speed.show,M);break;case "slide":A.slideDown(n.window.effects.speed.show,
M);break;default:A.show(n.window.effects.speed.show,M)}},wb=function(){var M=function(){n.window.expandable&&A.css({zIndex:10});!n.window.expandable||l.support.boxModel||A.prev().remove()};switch(n.window.effects.type){case "fade":A.fadeOut(n.window.effects.speed.hide,M);break;case "slide":A.slideUp(n.window.effects.speed.hide,M);break;default:A.hide(n.window.effects.speed.hide,M)}},xb=function(){var M=n.window,R=M.expandable?l(f).next().find(".Container:first"):null;A=M.expandable?l("<div/>"):l(f);
A.addClass("jPicker Container");M.expandable&&A.hide();A.get(0).onselectstart=function(Qa){if(Qa.target.nodeName.toLowerCase()!=="input")return false};var ea=ka.active.val("all");if(M.alphaPrecision<0)M.alphaPrecision=0;else if(M.alphaPrecision>2)M.alphaPrecision=2;var Fa='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(M.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(M.title||ca.text.title)+'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+
ia.clientPath+ia.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ia.clientPath+ia.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+ca.text.newColor+'<div class="color_preview"><span class="Active" title="'+ca.tooltips.colors.newColor+
'">&nbsp;</span><span class="Current" title="'+ca.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+ca.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+ca.text.ok+'" title="'+ca.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+ca.text.cancel+'" title="'+ca.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+ca.tooltips.hue.radio+'"><input type="radio" value="h"'+
(n.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ea!=null?ea.h:"")+'" title="'+ca.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+ca.tooltips.saturation.radio+'"><input type="radio" value="s"'+(n.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ea!=null?ea.s:"")+'" title="'+ca.tooltips.saturation.textbox+
'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+ca.tooltips.value.radio+'"><input type="radio" value="v"'+(n.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ea!=null?ea.v:"")+'" title="'+ca.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+ca.tooltips.red.radio+'"><input type="radio" value="r"'+(n.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+
(ea!=null?ea.r:"")+'" title="'+ca.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+ca.tooltips.green.radio+'"><input type="radio" value="g"'+(n.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ea!=null?ea.g:"")+'" title="'+ca.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+ca.tooltips.blue.radio+'"><input type="radio" value="b"'+(n.color.mode=="b"?' checked="checked"':
"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(ea!=null?ea.b:"")+'" title="'+ca.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(M.alphaSupport?'<label title="'+ca.tooltips.alpha.radio+'"><input type="radio" value="a"'+(n.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(M.alphaSupport?'<input type="text" maxlength="'+(3+M.alphaPrecision)+'" value="'+(ea!=null?Math.precision(ea.a*100/255,M.alphaPrecision):
"")+'" title="'+ca.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+ca.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(ea!=null?ea.hex:"")+'"/></label>'+(M.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(ea!=null?ea.ahex.substring(6):"")+'" title="'+ca.tooltips.hex.alpha+'"/></td>':"&nbsp;")+"</tr></tbody></table>";if(M.expandable){A.html(Fa);l(document.body).children("div.jPicker.Container").length==
0?l(document.body).prepend(A):l(document.body).children("div.jPicker.Container:last").after(A);A.mousedown(function(){l(document.body).children("div.jPicker.Container").css({zIndex:10});A.css({zIndex:20})});A.css({left:M.position.x=="left"?R.offset().left-530-(M.position.y=="center"?25:0)+"px":M.position.x=="center"?R.offset().left-260+"px":M.position.x=="right"?R.offset().left-10+(M.position.y=="center"?25:0)+"px":M.position.x=="screenCenter"?(l(document).width()>>1)-260+"px":R.offset().left+parseInt(M.position.x)+
"px",position:"absolute",top:M.position.y=="top"?R.offset().top-312+"px":M.position.y=="center"?R.offset().top-156+"px":M.position.y=="bottom"?R.offset().top+25+"px":R.offset().top+parseInt(M.position.y)+"px"})}else{A=l(f);A.html(Fa)}Fa=A.find("tbody:first");p=Fa.find("div.Map:first");L=Fa.find("div.Bar:first");var Oa=p.find("span"),Sa=L.find("span");Q=Oa.filter(".Map1:first");N=Oa.filter(".Map2:first");J=Oa.filter(".Map3:first");P=Sa.filter(".Map1:first");U=Sa.filter(".Map2:first");O=Sa.filter(".Map3:first");
ha=Sa.filter(".Map4:first");pa=Sa.filter(".Map5:first");fa=Sa.filter(".Map6:first");aa=new u(p,{map:{width:ia.colorMap.width,height:ia.colorMap.height},arrow:{image:ia.clientPath+ia.colorMap.arrow.file,width:ia.colorMap.arrow.width,height:ia.colorMap.arrow.height}});aa.bind(wa);W=new u(L,{map:{width:ia.colorBar.width,height:ia.colorBar.height},arrow:{image:ia.clientPath+ia.colorBar.arrow.file,width:ia.colorBar.arrow.width,height:ia.colorBar.arrow.height}});W.bind(Ha);ra=new a(Fa,ka.active,M.expandable&&
M.bindToInput?M.input:null,M.alphaPrecision);Oa=ea!=null?ea.hex:null;var cb=Fa.find(".Preview");Sa=Fa.find(".Button");na=cb.find(".Active:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"});qa=cb.find(".Current:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"}).bind("click",Ea);ua.call(f,qa,Math.precision(ka.current.val("a")*100)/255,4);la=Sa.find(".Ok:first").bind("click touchstart",qb);ma=Sa.find(".Cancel:first").bind("click touchstart",hb);Ca=Sa.find(".Grid:first");setTimeout(function(){Ya.call(f,
Q,ia.clientPath+"Maps.png");Ya.call(f,N,ia.clientPath+"Maps.png");Ya.call(f,J,ia.clientPath+"map-opacity.png");Ya.call(f,P,ia.clientPath+"Bars.png");Ya.call(f,U,ia.clientPath+"Bars.png");Ya.call(f,O,ia.clientPath+"Bars.png");Ya.call(f,ha,ia.clientPath+"Bars.png");Ya.call(f,pa,ia.clientPath+"bar-opacity.png");Ya.call(f,fa,ia.clientPath+"AlphaBar.png");Ya.call(f,cb.find("div:last"),ia.clientPath+"preview-opacity.png")},0);Fa.find("td.Radio input").bind("click  touchstart",Ua);if(ka.quickList&&ka.quickList.length>
0){Sa="";for(i=0;i<ka.quickList.length;i++){if((typeof ka.quickList[i]).toString().toLowerCase()=="string")ka.quickList[i]=new c({hex:ka.quickList[i]});var pb=ka.quickList[i].val("a"),Ta=ka.quickList[i].val("ahex");if(!M.alphaSupport&&Ta)Ta=Ta.substring(0,6)+"ff";var ob=ka.quickList[i].val("hex");Sa+='<span class="QuickColor"'+(Ta&&' title="#'+Ta+'"'||"")+' style="background-color:'+(ob&&"#"+ob||"")+";"+(ob?"":"background-image:url("+ia.clientPath+"NoColor.png)")+(M.alphaSupport&&pb&&pb<255?";opacity:"+
Math.precision(pb/255,4)+";filter:Alpha(opacity="+Math.precision(pb/2.55,4)+")":"")+'">&nbsp;</span>'}Ya.call(f,Ca,ia.clientPath+"bar-opacity.png");Ca.html(Sa);Ca.find(".QuickColor").click(tb)}Na.call(f,n.color.mode);ka.active.bind(ta);l.isFunction(eb)&&ka.active.bind(eb);ka.current.bind($a);if(M.expandable){f.icon=R.parents(".Icon:first");Ga=f.icon.find(".Color:first").css({backgroundColor:Oa&&"#"+Oa||"transparent"});Ia=f.icon.find(".Alpha:first");Ya.call(f,Ia,ia.clientPath+"bar-opacity.png");ua.call(f,
Ia,Math.precision((255-(ea!=null?ea.a:0))*100/255,4));xa=f.icon.find(".Image:first").css({backgroundImage:"url('"+ia.clientPath+ia.picker.file+"')"}).bind("click",Za);if(M.bindToInput&&M.updateInputColor)M.input.css({backgroundColor:Oa&&"#"+Oa||"transparent",color:ea==null||ea.v>75?"#000000":"#ffffff"});Ja=Fa.find(".Move:first").bind("mousedown",sa);ka.active.bind(vb)}else rb.call(f)},ia=n.images,ca=n.localization,ka={active:(typeof n.color.active).toString().toLowerCase()=="string"?new c({ahex:!n.window.alphaSupport&&
n.color.active?n.color.active.substring(0,6)+"ff":n.color.active}):new c({ahex:!n.window.alphaSupport&&n.color.active.val("ahex")?n.color.active.val("ahex").substring(0,6)+"ff":n.color.active.val("ahex")}),current:(typeof n.color.active).toString().toLowerCase()=="string"?new c({ahex:!n.window.alphaSupport&&n.color.active?n.color.active.substring(0,6)+"ff":n.color.active}):new c({ahex:!n.window.alphaSupport&&n.color.active.val("ahex")?n.color.active.val("ahex").substring(0,6)+"ff":n.color.active.val("ahex")}),
quickList:n.color.quickList};l.extend(true,f,{commitCallback:lb,liveCallback:eb,cancelCallback:nb,color:ka,show:rb,hide:wb,destroy:function(){A.find("td.Radio input  touchstart").unbind("click",Ua);qa.unbind("click  touchstart",Ea);ma.unbind("click  touchstart",hb);la.unbind("click  touchstart",qb);if(n.window.expandable){xa.unbind("click",Za);Ja.unbind("mousedown",sa);f.icon=null}A.find(".QuickColor").unbind("click",tb);fa=pa=ha=O=U=P=J=N=Q=L=p=null;aa.destroy();aa=null;W.destroy();W=null;ra.destroy();
eb=nb=lb=Ca=ma=la=qa=na=ra=null;A.html("");for(i=0;i<e.length;i++)e[i]==f&&e.splice(i,1)}});e.push(f);setTimeout(function(){xb.call(f)},0)})};l.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},color:{mode:"h",active:new c({ahex:"#ffcc00ff"}),quickList:[new c({h:360,s:33,v:100}),new c({h:360,s:66,v:100}),new c({h:360,s:100,v:100}),
new c({h:360,s:100,v:75}),new c({h:360,s:100,v:50}),new c({h:180,s:0,v:100}),new c({h:30,s:33,v:100}),new c({h:30,s:66,v:100}),new c({h:30,s:100,v:100}),new c({h:30,s:100,v:75}),new c({h:30,s:100,v:50}),new c({h:180,s:0,v:90}),new c({h:60,s:33,v:100}),new c({h:60,s:66,v:100}),new c({h:60,s:100,v:100}),new c({h:60,s:100,v:75}),new c({h:60,s:100,v:50}),new c({h:180,s:0,v:80}),new c({h:90,s:33,v:100}),new c({h:90,s:66,v:100}),new c({h:90,s:100,v:100}),new c({h:90,s:100,v:75}),new c({h:90,s:100,v:50}),
new c({h:180,s:0,v:70}),new c({h:120,s:33,v:100}),new c({h:120,s:66,v:100}),new c({h:120,s:100,v:100}),new c({h:120,s:100,v:75}),new c({h:120,s:100,v:50}),new c({h:180,s:0,v:60}),new c({h:150,s:33,v:100}),new c({h:150,s:66,v:100}),new c({h:150,s:100,v:100}),new c({h:150,s:100,v:75}),new c({h:150,s:100,v:50}),new c({h:180,s:0,v:50}),new c({h:180,s:33,v:100}),new c({h:180,s:66,v:100}),new c({h:180,s:100,v:100}),new c({h:180,s:100,v:75}),new c({h:180,s:100,v:50}),new c({h:180,s:0,v:40}),new c({h:210,
s:33,v:100}),new c({h:210,s:66,v:100}),new c({h:210,s:100,v:100}),new c({h:210,s:100,v:75}),new c({h:210,s:100,v:50}),new c({h:180,s:0,v:30}),new c({h:240,s:33,v:100}),new c({h:240,s:66,v:100}),new c({h:240,s:100,v:100}),new c({h:240,s:100,v:75}),new c({h:240,s:100,v:50}),new c({h:180,s:0,v:20}),new c({h:270,s:33,v:100}),new c({h:270,s:66,v:100}),new c({h:270,s:100,v:100}),new c({h:270,s:100,v:75}),new c({h:270,s:100,v:50}),new c({h:180,s:0,v:10}),new c({h:300,s:33,v:100}),new c({h:300,s:66,v:100}),
new c({h:300,s:100,v:100}),new c({h:300,s:100,v:75}),new c({h:300,s:100,v:50}),new c({h:180,s:0,v:0}),new c({h:330,s:33,v:100}),new c({h:330,s:66,v:100}),new c({h:330,s:100,v:100}),new c({h:330,s:100,v:75}),new c({h:330,s:100,v:50}),new c]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",
newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},
value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},
hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(l){function u(e){var q=e||window.event,b=[].slice.call(arguments,1),h=0,f=0,n=0;e=l.event.fix(q);e.type="mousewheel";if(q.wheelDelta)h=q.wheelDelta/120;if(q.detail)h=-q.detail/3;n=h;if(q.axis!==undefined&&q.axis===q.HORIZONTAL_AXIS){n=0;f=-1*h}if(q.wheelDeltaY!==undefined)n=q.wheelDeltaY/120;if(q.wheelDeltaX!==undefined)f=-1*q.wheelDeltaX/120;b.unshift(e,h,f,n);return(l.event.dispatch||l.event.handle).apply(this,b)}var a=["DOMMouseScroll","mousewheel"];if(l.event.fixHooks)for(var c=a.length;c;)l.event.fixHooks[a[--c]]=
l.event.mouseHooks;l.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=a.length;e;)this.addEventListener(a[--e],u,false);else this.onmousewheel=u},teardown:function(){if(this.removeEventListener)for(var e=a.length;e;)this.removeEventListener(a[--e],u,false);else this.onmousewheel=null}};l.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);methodDraw.addExtension("eyedropper",function(l){var u=methodDraw.canvas,a=svgedit.history.ChangeElementCommand,c={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"},e=function(q,b,h){var f=null;if(q.indexOf("url(#")===0){q=(q=u.getRefElem(q))?q.cloneNode(true):$("#"+h+"_color defs *")[0];f={alpha:b};f[q.tagName]=q}else f=q.indexOf("#")===0?{alpha:b,solidColor:q.substr(1)}:{alpha:b,solidColor:"none"};
return new $.jGraduate.Paint(f)};return{name:"eyedropper",svgicons:"extensions/eyedropper-icon.xml",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",position:8,key:"I",icon:"extensions/eyedropper.png",events:{click:function(){u.setMode("eyedropper")}}}],mouseDown:function(q){var b=u.getMode(),h=q.event;h=h.target.id==="svgroot"?document.getElementById("canvas_background"):h.target;if(b=="eyedropper"&&h){c.fillPaint=h.getAttribute("fill")||"white";c.fillOpacity=h.getAttribute("fill-opacity")||
1;c.strokePaint=h.getAttribute("stroke")||"none";c.strokeOpacity=h.getAttribute("stroke-opacity")||1;c.strokeWidth=h.getAttribute("stroke-width");c.strokeDashArray=h.getAttribute("stroke-dasharray");c.strokeLinecap=h.getAttribute("stroke-linecap");c.strokeLinejoin=h.getAttribute("stroke-linejoin");c.opacity=h.getAttribute("opacity")||1;q.selectedElements=q.selectedElements.filter(Boolean);if(q.selectedElements.length){if($.inArray(q.selectedElements.nodeName,["g","use"])==-1){var f={},n=function(A,
p,L){f[p]=A.getAttribute(p);A.setAttribute(p,L)},s=new l.BatchCommand;q.selectedElements.forEach(function(A){c.fillPaint&&n(A,"fill",c.fillPaint);c.fillOpacity&&n(A,"fill-opacity",c.fillOpacity);c.strokePaint&&n(A,"stroke",c.strokePaint);c.strokeOpacity&&n(A,"stroke-opacity",c.strokeOpacity);c.strokeWidth&&n(A,"stroke-width",c.strokeWidth);c.strokeDashArray&&n(A,"stroke-dasharray",c.strokeDashArray);c.opacity&&n(A,"opacity",c.opacity);c.strokeLinecap&&n(A,"stroke-linecap",c.strokeLinecap);c.strokeLinejoin&&
n(A,"stroke-linejoin",c.strokeLinejoin);s.addSubCommand(new a(A,f));f={}});q=e(c.fillPaint,c.fillOpacity*100,"fill");b=e(c.strokePaint,c.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.update(true);methodDraw.paintBox.stroke.update(true);u.undoMgr.addCommandToHistory(s)}}else{q=e(c.fillPaint,c.fillOpacity*100,"fill");b=e(c.strokePaint,c.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.setPaint(q);methodDraw.paintBox.stroke.setPaint(b)}}}}});methodDraw.addExtension("view_grid",function(l){function u(n){h.attr("width");h.attr("height");var s=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],A=[0.01,0.1,1,10,100,1E3];c.getContentElem().getAttribute("x");var p=q;s=s*n;var L=100/s,Q=1;for(n=0;n<A.length;n++){var N=A[n];Q=N;if(L<=N)break}A=Q*s;p.width=A;p.height=A;s=p.getContext("2d");L=A/10;s.globalAlpha=0.2;s.strokeStyle="#000";for(n=1;n<10;n++){Q=Math.round(L*n)+0.5;s.moveTo(Q,A);s.lineTo(Q,0);s.moveTo(A,Q);s.lineTo(0,Q)}s.stroke();
s.beginPath();s.globalAlpha=0.5;s.moveTo(0.5,A);s.lineTo(0.5,0);s.moveTo(A,0.5);s.lineTo(0,0.5);s.stroke();p=p.toDataURL("image/png");f.setAttribute("width",A);f.setAttribute("height",A);f.parentNode.setAttribute("width",A);f.parentNode.setAttribute("height",A);c.setHref(f,p)}if(!document.getElementById("canvasGrid")){var a=document.getElementById("svgcanvas").ownerDocument,c=methodDraw.canvas,e=false;l=l.assignAttributes;var q=document.createElement("canvas");$(q).hide().appendTo("body");var b=a.createElementNS("http://www.w3.org/2000/svg",
"g");l(b,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var h=$("#canvas_background");h.after(b);b=a.createElementNS("http://www.w3.org/2000/svg","pattern");l(b,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var f=a.createElementNS("http://www.w3.org/2000/svg","image");l(f,{x:0,y:0,width:100,height:100});b.appendChild(f);$("#svgroot defs").append(b);a=a.createElementNS("http://www.w3.org/2000/svg","rect");l(a,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(a)}return{name:"view_grid",zoomChanged:function(n){e&&u(n)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=e=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
e=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");u(c.getZoom())}}}}]}});methodDraw.addExtension("shapes",function(){function l(){$("#shape_buttons").empty();$("#shape_buttons").append(L.buttons)}function u(N){var J=p[N];if(J){L=J;J.buttons.length||a(N,J);l()}else{$("#shape_buttons").html("Loading...");$.getJSON("extensions/shapelib/"+N+".json",function(P){L=p[N]={data:P.data,size:P.size,fill:P.fill};a(N,P);l()})}}function a(N,J){var P=L.size||300,U=L.fill||false,O=P*0.05;O=[-O,-O,P+O*2,P+O*2].join(" ");P=U?0:P/30;P=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><svg viewBox="'+
O+'"><path fill="#333" stroke="transparent" stroke-width="'+P+'" /></svg></svg>',"text/xml");P.documentElement.setAttribute("width",40);P.documentElement.setAttribute("height",40);P=$(document.importNode(P.documentElement,true));U=J.data;L.buttons=[];for(var ha in U){O=U[ha];var pa=P.clone();pa.find("path").attr("d",O);O=pa.wrap('<div class="tool_button">').parent().attr({id:Q+"_"+ha,title:ha});L.buttons.push(O[0])}}var c,e,q=methodDraw.canvas,b,h,f,n=q.getRootElem(),s={},A={basic:"Basic",object:"Objects",
symbol:"Symbols",arrow:"Arrows",flowchart:"Flowchart",nature:"Nature",game:"Cards & Chess",dialog_balloon:"Dialog balloons",music:"Music",weather:"Weather &amp; Time",ui:"User Interface",social:"Social Web"},p={basic:{data:{star_points_5:"m1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z",donut:"m1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z",
triangle:"m1,280.375l149,-260.75l149,260.75z",right_triangle:"m1,299l0,-298l298,298z",diamond:"m1,150l149,-149l149,149l-149,149l-149,-149z",pentagon:"m1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z",hexagon:"m1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z",septagon1:"m0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z",
heptagon:"m1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z",decagon:"m1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z",dodecagon:"m1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z",
trapezoid:"m1,299l55.875,-298l186.25001,0l55.87498,298z",dialog_balloon_1:"m0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z",heart:"m150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z",
cylinder:"m299.0007,83.77844c0,18.28676 -66.70958,33.11111 -149.00002,33.11111m149.00002,-33.11111l0,0c0,18.28676 -66.70958,33.11111 -149.00002,33.11111c-82.29041,0 -148.99997,-14.82432 -148.99997,-33.11111m0,0l0,0c0,-18.28674 66.70956,-33.1111 148.99997,-33.1111c82.29044,0 149.00002,14.82436 149.00002,33.1111l0,132.44449c0,18.28674 -66.70958,33.11105 -149.00002,33.11105c-82.29041,0 -148.99997,-14.82431 -148.99997,-33.11105z",arrow_up:"m1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z",
arrow_u_turn:"m1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z",arrow_left_up:"m0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z",
plaque:"m-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z",page:"m249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234",cross:"m0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z",
divide:"m150,0.99785l0,0c25.17819,0 45.58916,20.41097 45.58916,45.58916c0,25.17821 -20.41096,45.58916 -45.58916,45.58916c-25.17822,0 -45.58916,-20.41093 -45.58916,-45.58916c0,-25.1782 20.41093,-45.58916 45.58916,-45.58916zm0,296.25203c-25.17822,0 -45.58916,-20.41095 -45.58916,-45.58917c0,-25.17819 20.41093,-45.58916 45.58916,-45.58916c25.17819,0 45.58916,20.41096 45.58916,45.58916c0,25.17822 -20.41096,45.58917 -45.58916,45.58917zm-134.06754,-193.71518l268.13507,0l0,91.17833l-268.13507,0z",minus:"m0.99887,102.39503l297.49445,0l0,95.2112l-297.49445,0z",
times:"m1.00089,73.36786l72.36697,-72.36697l76.87431,76.87368l76.87431,-76.87368l72.36765,72.36697l-76.87433,76.87431l76.87433,76.87431l-72.36765,72.36765l-76.87431,-76.87433l-76.87431,76.87433l-72.36697,-72.36765l76.87368,-76.87431l-76.87368,-76.87431z"},buttons:[]}},L=p.basic,Q="shapelib";return{svgicons:"extensions/ext-shapes.xml",buttons:[{id:"tool_shapelib",type:"mode_flyout",position:6,title:"Shape library",icon:"extensions/ext-shapes.png",events:{click:function(){q.setMode(Q)}}}],callback:function(){var N=
$('<div id="shape_buttons">');$("#tools_shapelib > *").wrapAll(N);var J=$("#tools_shapelib_show");u("basic");$("#shape_buttons").mouseup(function(U){U=$(U.target).closest("div.tool_button");if(U.length){var O=U.children().clone().attr({width:24,height:24});J.children(":not(.flyout_arrow_horiz)").remove();J.append(O).attr("data-curopt","#"+U[0].id).mouseup();q.setMode(Q);e=U[0].id.substr((Q+"_").length);c=L.data[e];$(".tools_flyout").fadeOut()}});N=$('<div id="shape_cats">');var P="";$.each(A,function(U,
O){P+="<div data-cat="+U+">"+O+"</div>"});N.html(P).children().bind("mouseup",function(){var U=$(this);U.siblings().removeClass("current");U.addClass("current");u(U.attr("data-cat"));return false});N.children().eq(0).addClass("current");$("#tools_shapelib").prepend(N);J.mouseup(function(){q.setMode(c?Q:"select")});$("#tool_shapelib").remove();N=$("#tools_shapelib").height();$("#tools_shapelib").css({"margin-top":-(N/2),"margin-left":3})},mouseDown:function(N){if(q.getMode()===Q){var J=h=N.start_x;
N=f=N.start_y;var P=q.getStyle();b=q.addSvgElementFromJson({element:"path",curStyles:true,attr:{d:c,id:q.getNextId(),opacity:P.opacity/2,style:"pointer-events:none"}});b.setAttribute("d",c);if(/[a-z]/.test(c)){c=L.data[e]=q.pathActions.convertPath(b);b.setAttribute("d",c);q.pathActions.fixEnd(b)}b.setAttribute("transform","translate("+J+","+N+") scale(0.005) translate("+-J+","+-N+")");q.recalculateDimensions(b);q.getTransformList(b);s=b.getBBox();totalScale={sx:1,sy:1};return{started:true}}},mouseMove:function(N){if(q.getMode()===
Q){var J=q.getZoom(),P=N.event,U=N.mouse_x/J,O=N.mouse_y/J;N=q.getTransformList(b);var ha=b.getBBox();J=ha.x;var pa=ha.y,fa=ha.width,aa=ha.height,W=U-h,ra=O-f,ja={x:Math.min(h,U),y:Math.min(f,O),width:Math.abs(U-h),height:Math.abs(O-f)},da=ha=0;aa=aa?(aa+ra)/aa:1;fa=fa?(fa+W)/fa:1;fa=ja.width/s.width;aa=ja.height/s.height;fa=fa||1;aa=aa||1;if(U<h)ha=s.width;if(O<f)da=s.height;U=n.createSVGTransform();O=n.createSVGTransform();ja=n.createSVGTransform();U.setTranslate(-(J+ha),-(pa+da));if(P.shiftKey){replaced=
true;P=Math.min(Math.abs(fa),Math.abs(aa));fa=P*(fa<0?-1:1);aa=P*(aa<0?-1:1);if(totalScale.sx!=totalScale.sy){P=totalScale.sx>totalScale.sy?1:totalScale.sx/totalScale.sy;fa*=totalScale.sy>totalScale.sx?1:totalScale.sy/totalScale.sx;aa*=P}}totalScale.sx*=fa;totalScale.sy*=aa;O.setScale(fa,aa);ja.setTranslate(J+ha,pa+da);N.appendItem(ja);N.appendItem(O);N.appendItem(U);q.recalculateDimensions(b);s=b.getBBox()}},mouseUp:function(N){if(q.getMode()===Q){if(N.mouse_x==h&&N.mouse_y==f)return{keep:false,
element:b,started:false};q.setMode("select");return{keep:true,element:b,started:false}}}}});(function(){for(var l=0,u=["ms","moz","webkit","o"],a=0;a<u.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[u[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[u[a]+"CancelAnimationFrame"]||window[u[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(c){var e=(new Date).getTime(),q=Math.max(0,16-(e-l)),b=window.setTimeout(function(){c(e+q)},q);l=e+q;return b};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(c){clearTimeout(c)}})();(function(l){function u(p){var L=p.originalEvent;if(!L.touches||L.targetTouches.length===1&&L.touches.length===1){b.call(this,p);p=l(this);p.bind(s,a);p.bind(n,c)}else{clearTimeout(A);q.call(this)}}function a(p){if(A!=null){var L=p.originalEvent;p=L.changedTouches?L.changedTouches[0].pageX:L.pageX;L=L.changedTouches?L.changedTouches[0].pageY:L.pageY;var Q=l(this).data("taphold.point");p=p-Q.x;L=L-Q.y;if(Math.sqrt(p*p+L*L)>f){clearTimeout(A);q.call(this)}}}function c(){clearTimeout(A);q.call(this)}
function e(p){q.call(this);l(this).data("taphold.handler").call(this,p)}function q(){A=null;l(this).unbind(s,a);l(this).unbind(n,c)}function b(p){if(A==null){var L=this;A=setTimeout(function(){e.call(L,p)},h);var Q=p.originalEvent,N={};N.x=Q.changedTouches?Q.changedTouches[0].pageX:Q.pageX;N.y=Q.changedTouches?Q.changedTouches[0].pageY:Q.pageY;l(this).data("taphold.point",N)}}var h=1E3,f=5,n="touchend",s="touchmove",A=null;l.event.special.taphold={setup:function(){},add:function(p){l(this).data("taphold.handler",
p.handler);p.data?l(this).bind("touchstart",p.data,u):l(this).bind("touchstart",u)},remove:function(p){clearTimeout(A);q.call(this);p.data?l(this).unbind("touchstart",p.data,u):l(this).unbind("touchstart",u)},teardown:function(){}}})(jQuery);
